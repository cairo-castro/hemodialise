System.register(["./vendor-legacy-CXQ1o16N.js","./ionic-legacy-CQzVRdmB.js","./_plugin-vue_export-helper-legacy-Du2wO1NW.js","./main-legacy-f6lX_bvQ.js"],function(a,t){"use strict";var e,i,n,o,s,c,l,r,d,u,p,f,g,v,m,h,x,b,w,k,y,_,z,C,$,S,j,E,I,D,A,P,L,q,T,B,M,U,N,O,R,F,H,G,J,K,Y,Q,V,W,X,Z,aa,ta,ea;return{setters:[a=>{e=a.d,i=a.c,n=a.n,o=a.q,s=a.t,c=a.v,l=a.G,r=a.x,d=a.H,u=a.y,p=a.I,f=a.J,g=a.A,v=a.K,m=a.r,h=a.o,x=a.B,b=a.F,w=a.L},a=>{k=a.j,y=a.g,_=a.k,z=a.l,C=a.e,$=a.t,S=a.m,j=a.n,E=a.o,I=a.p,D=a.q,A=a.r,P=a.s,L=a.u,q=a.i,T=a.v,B=a.w},a=>{M=a.p,U=a.t,N=a.d,O=a.f,R=a.i,F=a._,H=a.g,G=a.h,J=a.j,K=a.k,Y=a.n,Q=a.o,V=a.m,W=a.q,X=a.r,Z=a.u,aa=a.v,ta=a.w},a=>{ea=a.C}],execute:function(){var t=document.createElement("style");t.textContent=".checklist-card[data-v-afd1addd]{background:#fff;border-radius:16px;padding:20px;margin-bottom:16px;box-shadow:0 4px 12px rgba(0,0,0,.1);border-left:5px solid #007bff;position:relative;transition:all .3s ease}.checklist-card[data-v-afd1addd]:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.15)}.checklist-card.paused[data-v-afd1addd]{opacity:.8;border-left-color:#ffc107}.checklist-card.pre-dialysis[data-v-afd1addd]{border-left-color:#007bff}.checklist-card.during-session[data-v-afd1addd]{border-left-color:#ffc107}.checklist-card.post-dialysis[data-v-afd1addd]{border-left-color:#6f42c1}.card-header[data-v-afd1addd]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}.machine-info h3[data-v-afd1addd]{margin:0 0 4px;font-size:18px;font-weight:600;color:#2c3e50}.machine-id[data-v-afd1addd]{margin:0;font-size:14px;color:#6c757d;font-family:Courier New,monospace}.phase-badge[data-v-afd1addd]{font-size:12px;padding:6px 12px;border-radius:20px;font-weight:600}.patient-info[data-v-afd1addd]{display:flex;align-items:center;gap:8px;margin-bottom:16px;padding:8px 12px;background:#f8f9fa;border-radius:8px}.patient-icon[data-v-afd1addd]{font-size:16px;color:#6c757d}.patient-name[data-v-afd1addd]{font-size:14px;font-weight:500;color:#495057}.progress-section[data-v-afd1addd]{margin-bottom:16px}.progress-bar[data-v-afd1addd]{width:100%;height:8px;background:#e9ecef;border-radius:4px;overflow:hidden;margin-bottom:4px}.progress-fill[data-v-afd1addd]{height:100%;background:linear-gradient(90deg,#28a745,#20c997);border-radius:4px;transition:width .3s ease}.progress-text[data-v-afd1addd]{font-size:12px;color:#6c757d;font-weight:500}.time-info[data-v-afd1addd]{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}.time-item[data-v-afd1addd]{display:flex;align-items:center;gap:6px;font-size:12px}.time-icon[data-v-afd1addd]{font-size:14px;color:#6c757d}.time-icon.paused[data-v-afd1addd]{color:#ffc107}.time-label[data-v-afd1addd]{color:#6c757d;min-width:70px}.time-value[data-v-afd1addd]{font-weight:600;color:#495057}.actions[data-v-afd1addd]{display:flex;gap:8px;flex-wrap:wrap}.action-button[data-v-afd1addd]{--padding-start: 12px;--padding-end: 12px;height:32px;font-size:12px;font-weight:600}.action-button.continue[data-v-afd1addd]{--color: #007bff;--border-color: #007bff}.action-button.resume[data-v-afd1addd],.action-button.pause[data-v-afd1addd]{flex:1}.action-button.details[data-v-afd1addd]{--color: #6c757d;min-width:32px}.status-indicator[data-v-afd1addd]{position:absolute;top:16px;right:16px;width:12px;height:12px;border-radius:50%;background:#28a745;box-shadow:0 0 0 2px #fff,0 0 6px rgba(40,167,69,.3)}.status-indicator.paused[data-v-afd1addd]{background:#ffc107;box-shadow:0 0 0 2px #fff,0 0 6px rgba(255,193,7,.3)}@media (max-width: 480px){.checklist-card[data-v-afd1addd]{padding:16px}.card-header[data-v-afd1addd]{margin-bottom:12px}.machine-info h3[data-v-afd1addd]{font-size:16px}.actions[data-v-afd1addd]{gap:6px}.action-button[data-v-afd1addd]{font-size:11px;height:28px}}.dashboard-content[data-v-a2798274]{--background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%)}.dashboard-container[data-v-a2798274]{max-width:600px;margin:0 auto;padding-bottom:24px}.welcome-section[data-v-a2798274]{background:#fff;padding:20px;margin:16px 16px 0;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.08)}.welcome-header[data-v-a2798274]{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}.welcome-text[data-v-a2798274]{flex:1}.welcome-section h1[data-v-a2798274]{font-size:1.5rem;font-weight:700;color:#1f2937;margin:0 0 4px}.unit-name[data-v-a2798274]{font-size:.9rem;color:#6b7280;margin:0;font-weight:500}.user-badge[data-v-a2798274]{flex-shrink:0}.unit-display[data-v-a2798274]{margin-top:16px;padding-top:16px;border-top:1px solid rgba(0,0,0,.06)}.unit-info-static[data-v-a2798274]{display:flex;align-items:center;padding:10px 12px;background:#f8fafc;border-radius:10px;border:1px solid #e2e8f0}.unit-icon-static[data-v-a2798274]{font-size:1.2rem;color:#64748b;margin-right:10px;flex-shrink:0}.unit-text-static[data-v-a2798274]{flex:1;min-width:0;display:flex;flex-direction:column}.unit-label-static[data-v-a2798274]{font-size:.65rem;color:#94a3b8;font-weight:500;text-transform:uppercase;letter-spacing:.3px;margin-bottom:2px}.unit-name-static[data-v-a2798274]{font-size:.85rem;color:#475569;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.unit-info[data-v-a2798274]{display:flex;align-items:center;padding:12px;background:linear-gradient(135deg,#f0f9ff,#e0f2fe);border-radius:12px;border:1px solid #bae6fd}.unit-icon[data-v-a2798274]{font-size:1.5rem;color:#0284c7;margin-right:12px;flex-shrink:0}.unit-text[data-v-a2798274]{flex:1;min-width:0;display:flex;flex-direction:column}.unit-label[data-v-a2798274]{font-size:.7rem;color:#64748b;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-bottom:2px}.unit-name[data-v-a2798274]{font-size:.9rem;color:#0f172a;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.unit-change-btn[data-v-a2798274]{--padding-start: 8px;--padding-end: 8px;margin:0;flex-shrink:0}.unit-change-btn ion-icon[data-v-a2798274]{font-size:1.3rem;color:#0284c7}.role-tag[data-v-a2798274]{display:inline-block;background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-primary-shade) 100%);color:#fff;padding:6px 12px;border-radius:20px;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.quick-stats[data-v-a2798274]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:16px;background:linear-gradient(180deg,#f8f9fa,#e9ecef)}.stat-card[data-v-a2798274]{display:flex;align-items:center;gap:12px;background:#fff;border-left:4px solid transparent;padding:16px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.08);cursor:pointer;transition:all .2s ease}.stat-card[data-v-a2798274]:active{transform:scale(.97)}.stat-card.available[data-v-a2798274]{border-left-color:#10b981}.stat-card.active[data-v-a2798274]{border-left-color:#f59e0b}.stat-card.total[data-v-a2798274]{border-left-color:#6b7280}.stat-icon[data-v-a2798274]{flex-shrink:0}.stat-icon ion-icon[data-v-a2798274]{font-size:2rem}.stat-card.available .stat-icon ion-icon[data-v-a2798274]{color:#10b981}.stat-card.active .stat-icon ion-icon[data-v-a2798274]{color:#f59e0b}.stat-card.total .stat-icon ion-icon[data-v-a2798274]{color:#6b7280}.stat-content[data-v-a2798274]{flex:1;min-width:0}.stat-number[data-v-a2798274]{font-size:1.5rem;font-weight:700;color:#1f2937;line-height:1}.stat-label[data-v-a2798274]{font-size:.7rem;color:#6b7280;text-transform:uppercase;letter-spacing:.5px;margin-top:2px;font-weight:600}.primary-action[data-v-a2798274]{padding:0 16px;margin-top:16px}.primary-btn[data-v-a2798274]{width:100%;display:flex;align-items:center;gap:16px;background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-primary-shade) 100%);color:#fff;border:none;border-radius:16px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.15);cursor:pointer;transition:all .2s ease;position:relative}.primary-btn[data-v-a2798274]:active{transform:scale(.98)}.primary-btn ion-icon[data-v-a2798274]{font-size:2.5rem;flex-shrink:0}.btn-text[data-v-a2798274]{display:flex;flex-direction:column;gap:4px;flex:1;text-align:left}.btn-title[data-v-a2798274]{font-size:1.2rem;font-weight:700}.btn-subtitle[data-v-a2798274]{font-size:.85rem;opacity:.9}.primary-btn ion-badge[data-v-a2798274]{position:absolute;top:12px;right:12px;font-size:.85rem;font-weight:700}.section[data-v-a2798274]{padding:0 16px;margin-top:24px}.section-title[data-v-a2798274]{font-size:1.1rem;font-weight:700;color:#1f2937;margin:0 0 12px}.quick-actions[data-v-a2798274]{display:flex;flex-direction:column;gap:8px}.action-btn[data-v-a2798274]{display:flex;align-items:center;gap:12px;background:#fff;border:2px solid #e5e7eb;border-radius:12px;padding:16px;cursor:pointer;transition:all .2s ease}.action-btn[data-v-a2798274]:active{transform:scale(.98);border-color:var(--ion-color-primary)}.action-icon[data-v-a2798274]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.action-icon ion-icon[data-v-a2798274]{font-size:1.8rem;color:#fff}.action-icon.primary[data-v-a2798274]{background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-primary-shade) 100%)}.action-icon.warning[data-v-a2798274]{background:linear-gradient(135deg,#f59e0b,#d97706)}.action-icon.tertiary[data-v-a2798274]{background:linear-gradient(135deg,#8b5cf6,#7c3aed)}.action-icon.cleaning[data-v-a2798274]{background:linear-gradient(135deg,#06b6d4,#0891b2)}.action-content[data-v-a2798274]{display:flex;flex-direction:column;gap:4px;flex:1}.action-title[data-v-a2798274]{font-size:1rem;font-weight:600;color:#1f2937}.action-subtitle[data-v-a2798274]{font-size:.85rem;color:#6b7280}.chevron[data-v-a2798274]{font-size:1.2rem;color:#9ca3af;flex-shrink:0}.checklists-list[data-v-a2798274]{display:flex;flex-direction:column;gap:12px}.connection-status[data-v-a2798274]{padding:16px;text-align:center}.status-chip[data-v-a2798274]{font-size:.85rem;font-weight:600}@media (max-width: 480px){.quick-stats[data-v-a2798274]{gap:8px;padding:12px}.stat-card[data-v-a2798274]{flex-direction:column;text-align:center;gap:8px;padding:12px}.stat-icon ion-icon[data-v-a2798274]{font-size:1.8rem}.stat-number[data-v-a2798274]{font-size:1.3rem}.stat-label[data-v-a2798274]{font-size:.65rem}.primary-btn[data-v-a2798274]{padding:16px}.primary-btn ion-icon[data-v-a2798274]{font-size:2rem}.btn-title[data-v-a2798274]{font-size:1.1rem}.btn-subtitle[data-v-a2798274]{font-size:.8rem}}[data-v-a2798274] .custom-toast{--background: #10b981;--color: white;font-weight:600}[data-v-a2798274] .unit-selector-action-sheet{--background: #ffffff}[data-v-a2798274] .unit-selector-action-sheet .action-sheet-title{font-size:1.1rem;font-weight:700;color:#0f172a;padding:20px 16px 8px}[data-v-a2798274] .unit-selector-action-sheet .action-sheet-sub-title{font-size:.85rem;color:#64748b;padding:0 16px 12px}[data-v-a2798274] .unit-selector-action-sheet .action-sheet-button{font-size:.95rem;padding:16px}[data-v-a2798274] .unit-selector-action-sheet .unit-selected{font-weight:700;color:#0284c7}[data-v-a2798274] .unit-selector-action-sheet .action-sheet-button ion-icon{font-size:1.3rem;margin-right:12px}\n",document.head.appendChild(t);const ia={class:"card-header"},na={class:"machine-info"},oa={class:"machine-id"},sa={class:"patient-info"},ca={class:"patient-name"},la={class:"progress-section"},ra={class:"progress-bar"},da={class:"progress-text"},ua={class:"time-info"},pa={class:"time-item"},fa={class:"time-value"},ga={key:0,class:"time-item"},va={class:"time-value"},ma={class:"actions"},ha=F(e({__name:"ActiveChecklistCard",props:{checklist:{}},emits:["continue","pause","resume"],setup(a,{emit:t}){const e=a,m=i(()=>({pre_dialysis:"Pré-Diálise",during_session:"Durante Sessão",post_dialysis:"Pós-Diálise",completed:"Concluído",interrupted:"Interrompido"}[e.checklist.current_phase]||e.checklist.current_phase)),h=i(()=>({pre_dialysis:"primary",during_session:"warning",post_dialysis:"secondary",completed:"success",interrupted:"danger"}[e.checklist.current_phase]||"medium")),x=i(()=>e.checklist.current_phase.replace("_","-")),b=i(()=>void 0!==e.checklist.phase_completion?Math.round(e.checklist.phase_completion):{pre_dialysis:25,during_session:50,post_dialysis:75,completed:100,interrupted:0}[e.checklist.current_phase]||0),w=i(()=>{const a=new Date(e.checklist.created_at),t=(new Date).getTime()-a.getTime(),i=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4);return i>0?`${i}h ${n}m`:`${n}m`}),C=i(()=>{if(!e.checklist.paused_at)return"";const a=new Date(e.checklist.paused_at),t=(new Date).getTime()-a.getTime(),i=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4);return i>0?`${i}h ${n}m`:`${n}m`}),$=async()=>{const a=await z.create({header:"Detalhes do Checklist",subHeader:`${e.checklist.machine.name} - ${e.checklist.patient.name}`,message:`\n      <strong>Fase:</strong> ${m.value}<br>\n      <strong>Progresso:</strong> ${b.value}%<br>\n      <strong>Iniciado:</strong> ${new Date(e.checklist.created_at).toLocaleString("pt-BR")}<br>\n      ${e.checklist.paused_at?`<strong>Pausado:</strong> ${new Date(e.checklist.paused_at).toLocaleString("pt-BR")}<br>`:""}\n    `,buttons:["Fechar"]});await a.present()};return(a,t)=>(o(),n("div",{class:v(["checklist-card",[x.value,{paused:a.checklist.paused_at}]])},[s("div",ia,[s("div",na,[s("h3",null,l(a.checklist.machine.name),1),s("p",oa,l(a.checklist.machine.identifier),1)]),c(u(k),{color:h.value,class:"phase-badge"},{default:r(()=>[d(l(m.value),1)]),_:1},8,["color"])]),s("div",sa,[c(u(y),{icon:u(M),class:"patient-icon"},null,8,["icon"]),s("span",ca,l(a.checklist.patient.name),1)]),s("div",la,[s("div",ra,[s("div",{class:"progress-fill",style:p({width:b.value+"%"})},null,4)]),s("span",da,l(b.value)+"% completo",1)]),s("div",ua,[s("div",pa,[c(u(y),{icon:u(U),class:"time-icon"},null,8,["icon"]),t[3]||(t[3]=s("span",{class:"time-label"},"Iniciado há",-1)),s("span",fa,l(w.value),1)]),a.checklist.paused_at?(o(),n("div",ga,[c(u(y),{icon:u(N),class:"time-icon paused"},null,8,["icon"]),t[4]||(t[4]=s("span",{class:"time-label"},"Pausado há",-1)),s("span",va,l(C.value),1)])):f("",!0)]),s("div",ma,[a.checklist.paused_at?f("",!0):(o(),g(u(_),{key:0,fill:"outline",size:"small",onClick:t[0]||(t[0]=t=>a.$emit("continue",a.checklist)),class:"action-button continue"},{default:r(()=>[c(u(y),{icon:u(O),slot:"start"},null,8,["icon"]),t[5]||(t[5]=d(" Continuar ",-1))]),_:1})),a.checklist.paused_at?(o(),g(u(_),{key:1,fill:"solid",size:"small",onClick:t[1]||(t[1]=t=>a.$emit("resume",a.checklist)),class:"action-button resume",color:"success"},{default:r(()=>[c(u(y),{icon:u(O),slot:"start"},null,8,["icon"]),t[6]||(t[6]=d(" Retomar ",-1))]),_:1})):f("",!0),a.checklist.paused_at?f("",!0):(o(),g(u(_),{key:2,fill:"outline",size:"small",onClick:t[2]||(t[2]=t=>a.$emit("pause",a.checklist)),class:"action-button pause",color:"warning"},{default:r(()=>[c(u(y),{icon:u(N),slot:"start"},null,8,["icon"]),t[7]||(t[7]=d(" Pausar ",-1))]),_:1})),c(u(_),{fill:"clear",size:"small",onClick:$,class:"action-button details"},{default:r(()=>[c(u(y),{icon:u(R),slot:"icon-only"},null,8,["icon"])]),_:1})]),s("div",{class:v(["status-indicator",x.value])},null,2)],2))}}),[["__scopeId","data-v-afd1addd"]]),xa={class:"dashboard-container"},ba={key:0,class:"welcome-section"},wa={class:"welcome-header"},ka={class:"welcome-text"},ya={class:"unit-display"},_a={key:0,class:"unit-info-static"},za={class:"unit-text-static"},Ca={class:"unit-name-static"},$a={key:1,class:"unit-info"},Sa={class:"unit-text"},ja={class:"unit-name"},Ea={key:1,class:"quick-stats"},Ia={class:"stat-icon"},Da={class:"stat-content"},Aa={class:"stat-number"},Pa={class:"stat-icon"},La={class:"stat-content"},qa={class:"stat-number"},Ta={class:"stat-card total"},Ba={class:"stat-icon"},Ma={class:"stat-content"},Ua={class:"stat-number"},Na={class:"primary-action"},Oa={class:"section"},Ra={class:"quick-actions"},Fa={class:"action-icon warning"},Ha={class:"action-content"},Ga={class:"action-subtitle"},Ja={class:"action-icon tertiary"},Ka={class:"action-icon cleaning"},Ya={class:"action-icon primary"},Qa={key:2,class:"section"},Va={class:"checklists-list"},Wa={class:"connection-status"};a("default",F(e({__name:"DashboardPage",setup(a){const t=x(),e=ea.getInstance(),p=e.getCurrentUserUseCase(),v=e.getLogoutUseCase(),M=m(null),N=m(navigator.onLine),O=m(!1),R=m(0),F=m(3),ia=m(!1),na=m(!1),oa=m([]),sa=m([]),ca=m([]),la=m([]),ra=m(null),da=m(null);i(()=>M.value&&{tecnico:"Técnico",admin:"Admin",gestor:"Gestor",coordenador:"Coordenador",supervisor:"Supervisor"}[M.value.role]||"Usuário");const ua=i(()=>oa.value.filter(a=>!a.paused_at).length);i(()=>oa.value.filter(a=>a.paused_at).length);const pa=i(()=>sa.value.length),fa=async()=>{try{M.value=await p.execute(),console.log("User loaded:",M.value),await ga()}catch(a){console.error("Error loading user:",a);const e=await $.create({message:"Erro ao carregar dados do usuário",duration:3e3,color:"danger",position:"top"});await e.present(),setTimeout(()=>{t.replace("/login")},2e3)}},ga=async()=>{try{const a=await fetch("/api/user-units",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),t=await a.json();if(t.success){la.value=t.units||[];const a=t.current_unit_id;a?(ra.value=t.units.find(t=>t.id===a),da.value=a):t.units.length>0&&(ra.value=t.units[0],da.value=t.units[0].id),console.log("Unidades carregadas (mobile):",{total:la.value.length,current:ra.value?.name,currentId:da.value})}}catch(a){console.error("Error loading available units:",a),M.value?.unit&&(ra.value=M.value.unit,da.value=M.value.unit.id,la.value=M.value.units||[M.value.unit])}},va=async()=>{const a=la.value.map(a=>({text:a.name,icon:a.id===da.value?"checkmark-circle-outline":"location-outline",cssClass:a.id===da.value?"unit-selected":"",handler:()=>{a.id!==da.value&&ma(a.id)}}));a.push({text:"Cancelar",icon:"close-outline",handler:()=>{}});const t=await T.create({header:"Selecionar Unidade",subHeader:"Escolha a unidade para visualizar",buttons:a,cssClass:"unit-selector-action-sheet"});await t.present()},ma=async a=>{try{const t=await B.create({message:"Alternando unidade...",spinner:"crescent",duration:1e4});await t.present();const e=await fetch("/api/user-units/switch",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"Content-Type":"application/json"},body:JSON.stringify({unit_id:a})}),i=await e.json();if(await t.dismiss(),i.success){ra.value=i.current_unit,da.value=a;const t=await $.create({message:`📍 Unidade alterada para ${i.current_unit.name}`,duration:2e3,color:"success",position:"top",cssClass:"custom-toast"});await t.present(),await Xa()}}catch(t){console.error("Error switching unit:",t),da.value=ra.value?.id;const a=await $.create({message:"Erro ao trocar de unidade",duration:3e3,color:"danger",position:"top"});await a.present()}},Xa=async()=>{try{await Promise.all([Za(),at(),tt()]),R.value=oa.value.length,F.value=ca.value.length,O.value=!0,console.log("Stats loaded")}catch(a){console.error("Error loading stats:",a),O.value=!0}},Za=async()=>{try{const a=await fetch("/api/checklists/active",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),t=await a.json();t.success&&(oa.value=t.checklists)}catch(a){console.error("Erro ao carregar checklists ativos:",a)}},at=async()=>{try{const a=await fetch("/api/machines/available",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),t=await a.json();t.success&&(sa.value=t.machines)}catch(a){console.error("Erro ao carregar máquinas disponíveis:",a)}},tt=async()=>{try{const a=await fetch("/api/machines",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"Content-Type":"application/json",Accept:"application/json"}});if(!a.ok)return console.warn(`Failed to load machines: ${a.status}`),void(ca.value=[]);const t=await a.json();t.success&&t.machines?ca.value=t.machines:ca.value=[]}catch(a){console.error("Erro ao carregar máquinas:",a),ca.value=[]}},et=async a=>{try{await Promise.all([fa(),Xa()]);const a=await $.create({message:"Dados atualizados",duration:1500,color:"success",position:"top"});await a.present()}catch(t){console.error("Error refreshing:",t)}finally{a.target.complete()}},it=async()=>{const a=await z.create({header:"Confirmar Saída",message:"Deseja realmente sair do aplicativo?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Sair",role:"confirm",handler:async()=>{try{await v.execute();const a=await $.create({message:"Logout realizado com sucesso",duration:2e3,color:"success",position:"top"});await a.present(),t.replace("/login")}catch(a){console.error("Logout error:",a),t.replace("/login")}}}]});await a.present()},nt=()=>{console.log("Navigating to new checklist..."),t.push("/checklist/new")},ot=()=>{console.log("Navigating to patients..."),t.push("/patients")},st=()=>{console.log("Navigating to active checklists..."),t.push("/checklists")},ct=()=>{t.push("/machines")},lt=()=>{console.log("Navigating to cleaning controls..."),t.push("/cleaning-controls")},rt=a=>{t.push(`/checklist/${a.id}`)},dt=async a=>{const t=await z.create({header:"Pausar Checklist",message:`Deseja pausar o checklist da máquina ${a.machine.name}?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Pausar",handler:async()=>{try{const t=await fetch(`/api/checklists/${a.id}/pause`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),e=await t.json();if(!e.success)throw new Error(e.message);{const a=await $.create({message:"Checklist pausado com sucesso.",duration:3e3,color:"success"});await a.present(),await Xa()}}catch(t){const a=await $.create({message:"Erro ao pausar checklist.",duration:3e3,color:"danger"});await a.present()}}}]});await t.present()},ut=async a=>{try{const t=await fetch(`/api/checklists/${a.id}/resume`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),e=await t.json();if(!e.success)throw new Error(e.message);{const a=await $.create({message:"Checklist retomado com sucesso.",duration:3e3,color:"success"});await a.present(),await Xa()}}catch(t){const a=await $.create({message:"Erro ao retomar checklist.",duration:3e3,color:"danger"});await a.present()}},pt=()=>{na.value?document.body.classList.add("dark"):document.body.classList.remove("dark")},ft=async()=>{na.value=!na.value,localStorage.setItem("dark-mode",na.value.toString()),pt();const a=await $.create({message:`Modo ${na.value?"escuro":"claro"} ativado`,duration:1500,color:"medium",position:"bottom"});await a.present(),console.log("Dark mode toggled:",na.value)},gt=()=>{N.value=navigator.onLine};return h(async()=>{console.log("Dashboard mounted, loading data..."),(()=>{const a=localStorage.getItem("dark-mode");na.value=null!==a?"true"===a:window.matchMedia("(prefers-color-scheme: dark)").matches,pt()})(),ia.value=!0;try{await fa(),Xa(),window.addEventListener("online",gt),window.addEventListener("offline",gt)}catch(a){console.error("Dashboard initialization error:",a)}finally{ia.value=!1}}),(a,t)=>(o(),g(u(C),null,{default:r(()=>[c(u(I),null,{default:r(()=>[c(u(S),{color:"primary"},{default:r(()=>[c(u(j),null,{default:r(()=>[...t[0]||(t[0]=[d("Hemodiálise Mobile",-1)])]),_:1}),c(u(E),{slot:"end"},{default:r(()=>[c(u(_),{onClick:ft,fill:"clear",class:"theme-toggle-btn"},{default:r(()=>[c(u(y),{icon:na.value?u(H):u(G),slot:"icon-only"},null,8,["icon"])]),_:1}),c(u(_),{onClick:it,fill:"clear"},{default:r(()=>[c(u(y),{icon:u(J),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),c(u(q),{fullscreen:!0,class:"dashboard-content"},{default:r(()=>[c(u(D),{slot:"fixed",onIonRefresh:et},{default:r(()=>[c(u(A))]),_:1}),s("div",xa,[M.value?(o(),n("div",ba,[s("div",wa,[s("div",ka,[s("h1",null,"Olá, "+l(M.value.name.split(" ")[0])+"! 👋",1)])]),s("div",ya,[la.value.length<=1?(o(),n("div",_a,[c(u(y),{icon:u(K),class:"unit-icon-static"},null,8,["icon"]),s("div",za,[t[1]||(t[1]=s("span",{class:"unit-label-static"},"Unidade",-1)),s("span",Ca,l(ra.value?.name||M.value.unit?.name||"Carregando..."),1)])])):(o(),n("div",$a,[c(u(y),{icon:u(K),class:"unit-icon"},null,8,["icon"]),s("div",Sa,[t[2]||(t[2]=s("span",{class:"unit-label"},"Unidade Atual",-1)),s("span",ja,l(ra.value?.name||M.value.unit?.name||"Carregando..."),1)]),c(u(_),{fill:"clear",size:"small",onClick:va,class:"unit-change-btn"},{default:r(()=>[c(u(y),{slot:"icon-only",icon:u(Y)},null,8,["icon"])]),_:1})]))])])):f("",!0),O.value?(o(),n("div",Ea,[s("div",{class:"stat-card available",onClick:ct},[s("div",Ia,[c(u(y),{icon:u(Q)},null,8,["icon"])]),s("div",Da,[s("div",Aa,l(pa.value),1),t[3]||(t[3]=s("div",{class:"stat-label"},"Disponíveis",-1))])]),s("div",{class:"stat-card active",onClick:st},[s("div",Pa,[c(u(y),{icon:u(U)},null,8,["icon"])]),s("div",La,[s("div",qa,l(ua.value),1),t[4]||(t[4]=s("div",{class:"stat-label"},"Em Andamento",-1))])]),s("div",Ta,[s("div",Ba,[c(u(y),{icon:u(V)},null,8,["icon"])]),s("div",Ma,[s("div",Ua,l(F.value),1),t[5]||(t[5]=s("div",{class:"stat-label"},"Total Máquinas",-1))])])])):f("",!0),s("div",Na,[s("button",{class:"primary-btn",onClick:nt},[c(u(y),{icon:u(W)},null,8,["icon"]),t[6]||(t[6]=s("div",{class:"btn-text"},[s("span",{class:"btn-title"},"Novo Checklist"),s("span",{class:"btn-subtitle"},"Iniciar verificação de segurança")],-1)),pa.value>0?(o(),g(u(k),{key:0,color:"success"},{default:r(()=>[d(l(pa.value),1)]),_:1})):f("",!0)])]),s("div",Oa,[t[11]||(t[11]=s("h2",{class:"section-title"},"Acesso Rápido",-1)),s("div",Ra,[ua.value>0?(o(),n("div",{key:0,class:"action-btn",onClick:st},[s("div",Fa,[c(u(y),{icon:u(U)},null,8,["icon"])]),s("div",Ha,[t[7]||(t[7]=s("span",{class:"action-title"},"Checklists Ativos",-1)),s("span",Ga,l(ua.value)+" em andamento",1)]),c(u(y),{icon:u(X),class:"chevron"},null,8,["icon"])])):f("",!0),s("div",{class:"action-btn",onClick:ct},[s("div",Ja,[c(u(y),{icon:u(Q)},null,8,["icon"])]),t[8]||(t[8]=s("div",{class:"action-content"},[s("span",{class:"action-title"},"Máquinas"),s("span",{class:"action-subtitle"},"Status e controle")],-1)),c(u(y),{icon:u(X),class:"chevron"},null,8,["icon"])]),s("div",{class:"action-btn",onClick:lt},[s("div",Ka,[c(u(y),{icon:u(Z)},null,8,["icon"])]),t[9]||(t[9]=s("div",{class:"action-content"},[s("span",{class:"action-title"},"Controle de Limpeza"),s("span",{class:"action-subtitle"},"Limpeza e desinfecção")],-1)),c(u(y),{icon:u(X),class:"chevron"},null,8,["icon"])]),s("div",{class:"action-btn",onClick:ot},[s("div",Ya,[c(u(y),{icon:u(aa)},null,8,["icon"])]),t[10]||(t[10]=s("div",{class:"action-content"},[s("span",{class:"action-title"},"Pacientes"),s("span",{class:"action-subtitle"},"Buscar e gerenciar")],-1)),c(u(y),{icon:u(X),class:"chevron"},null,8,["icon"])])])]),oa.value.length>0?(o(),n("div",Qa,[t[12]||(t[12]=s("h2",{class:"section-title"},"Em Andamento",-1)),s("div",Va,[(o(!0),n(b,null,w(oa.value,a=>(o(),g(ha,{key:a.id,checklist:a,onContinue:rt,onPause:dt,onResume:ut},null,8,["checklist"]))),128))])])):f("",!0),s("div",Wa,[c(u(P),{color:N.value?"success":"danger",class:"status-chip"},{default:r(()=>[c(u(y),{icon:u(ta)},null,8,["icon"]),c(u(L),null,{default:r(()=>[d(l(N.value?"Online":"Offline"),1)]),_:1})]),_:1},8,["color"])])])]),_:1})]),_:1}))}}),[["__scopeId","data-v-a2798274"]]))}}});
