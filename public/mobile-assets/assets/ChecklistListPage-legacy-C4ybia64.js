System.register(["./vendor-legacy-X-yEH-Kx.js","./ionic-legacy-Bcx0Tl_t.js","./_plugin-vue_export-helper-legacy-Du2wO1NW.js","./main-legacy-D_Q0KGQH.js","./useStatsAutoRefresh-legacy-BClxVbJl.js"],function(e,a){"use strict";var t,i,n,s,c,o,d,l,r,p,u,g,h,f,m,x,v,b,y,w,k,_,z,C,j,$,I,S,A,D,P,E,T,U,M,R,q,B,O,N,L,F,H,Y,G,J,K,Q;return{setters:[e=>{t=e.d,i=e.r,n=e.c,s=e.o,c=e.B,o=e.q,d=e.x,l=e.y,r=e.v,p=e.H,u=e.t,g=e.n,h=e.J,f=e.G,m=e.K,x=e.F,v=e.L,b=e.z,y=e.C},e=>{w=e.e,k=e.m,_=e.o,z=e.x,C=e.n,j=e.k,$=e.g,I=e.p,S=e.q,A=e.r,D=e.f,P=e.y,E=e.z,T=e.i,U=e.l,M=e.w,R=e.t},e=>{q=e.x,B=e.y,O=e.t,N=e.q,L=e.z,F=e.m,H=e.p,Y=e.d,G=e.A,J=e._},e=>{K=e.C},e=>{Q=e.u}],execute:function(){var a=document.createElement("style");a.textContent='.header-gradient[data-v-31b73dec]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:24px 20px;position:relative;overflow:hidden}.header-gradient[data-v-31b73dec]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="2" fill="white" opacity="0.05"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>\');pointer-events:none}.header-content[data-v-31b73dec]{position:relative;z-index:2}.unit-info h2[data-v-31b73dec]{margin:0 0 8px;font-size:24px;font-weight:600}.unit-info p[data-v-31b73dec]{margin:0;font-size:16px;opacity:.9}.status-indicators[data-v-31b73dec]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-top:16px}.status-item[data-v-31b73dec]{display:flex;align-items:center;gap:1rem;padding:1.25rem;background:#fff;border-radius:16px;box-shadow:0 2px 12px rgba(0,0,0,.08);transition:transform .2s ease,box-shadow .2s ease;border-left:4px solid transparent}.status-item[data-v-31b73dec]:active{transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.12)}.status-item ion-icon[data-v-31b73dec]{font-size:2.5rem;flex-shrink:0}.status-item span[data-v-31b73dec]{color:#1f2937;font-size:.75rem;line-height:1.2;font-weight:500;flex:1}.status-item.available[data-v-31b73dec]{border-left-color:#10b981}.status-item.available ion-icon[data-v-31b73dec]{color:#10b981}.status-item.occupied[data-v-31b73dec]{border-left-color:#f59e0b}.status-item.occupied ion-icon[data-v-31b73dec]{color:#f59e0b}.status-item.updating[data-v-31b73dec]{animation:pulse-31b73dec 1.5s ease-in-out infinite}@keyframes pulse-31b73dec{0%,to{opacity:1;transform:scale(1)}50%{opacity:.8;transform:scale(.98)}}.content-container[data-v-31b73dec]{padding:0 16px 100px}.checklists-section[data-v-31b73dec]{margin-top:16px}.checklist-card[data-v-31b73dec]{background:#fff;border-radius:16px;margin-bottom:16px;box-shadow:0 4px 12px rgba(0,0,0,.1);overflow:hidden;cursor:pointer;transition:all .3s ease;position:relative}.checklist-card[data-v-31b73dec]:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.15)}.card-content[data-v-31b73dec]{padding:20px;display:flex;justify-content:space-between;align-items:center}.checklist-info[data-v-31b73dec]{flex:1;display:flex;flex-direction:column;gap:16px}.machine-section[data-v-31b73dec]{display:flex;align-items:center;gap:12px}.machine-icon[data-v-31b73dec]{width:40px;height:40px;background:#e3f2fd;border-radius:12px;display:flex;align-items:center;justify-content:center}.machine-icon ion-icon[data-v-31b73dec]{font-size:20px;color:#1976d2}.machine-details h3[data-v-31b73dec]{margin:0 0 4px;font-size:18px;font-weight:600;color:#2c3e50}.machine-id[data-v-31b73dec]{margin:0;font-size:14px;color:#6c757d;font-family:Courier New,monospace}.patient-section[data-v-31b73dec]{display:flex;align-items:center;gap:12px}.patient-icon[data-v-31b73dec]{width:32px;height:32px;background:#f3e5f5;border-radius:10px;display:flex;align-items:center;justify-content:center}.patient-icon ion-icon[data-v-31b73dec]{font-size:16px;color:#7b1fa2}.patient-details h4[data-v-31b73dec]{margin:0 0 4px;font-size:16px;font-weight:500;color:#2c3e50}.phase-info[data-v-31b73dec]{margin:0;font-size:12px;color:#6c757d;text-transform:uppercase;letter-spacing:.5px}.checklist-actions[data-v-31b73dec]{display:flex;flex-direction:column;align-items:center;gap:12px;min-width:100px}.status-section[data-v-31b73dec]{display:flex;flex-direction:column;align-items:center;gap:8px}.progress-circle[data-v-31b73dec]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:12px;color:#fff;box-shadow:0 2px 8px rgba(0,0,0,.15)}.progress-circle.pre-dialysis[data-v-31b73dec]{background:linear-gradient(135deg,#1976d2,#1565c0)}.progress-circle.during-session[data-v-31b73dec]{background:linear-gradient(135deg,#f57c00,#ef6c00)}.progress-circle.post-dialysis[data-v-31b73dec]{background:linear-gradient(135deg,#7b1fa2,#6a1b9a)}.progress-text[data-v-31b73dec]{font-size:11px;font-weight:600}.time-info[data-v-31b73dec]{text-align:center}.time-label[data-v-31b73dec]{font-size:12px;color:#6c757d;font-weight:500}.action-button[data-v-31b73dec]{--padding-start: 16px;--padding-end: 16px;--height: 32px;font-size:12px;font-weight:600;letter-spacing:.5px;min-width:80px}.pause-btn[data-v-31b73dec]{--padding-start: 8px;--padding-end: 8px;--height: 32px;min-width:32px}.paused-indicator[data-v-31b73dec]{background:#fff3e0;border-top:1px solid #ffe0b2;padding:8px 20px;display:flex;align-items:center;gap:8px;font-size:12px;color:#ef6c00}.paused-indicator ion-icon[data-v-31b73dec]{font-size:14px}.empty-state[data-v-31b73dec]{display:flex;align-items:center;justify-content:center;min-height:400px;padding:40px 20px}.empty-content[data-v-31b73dec]{text-align:center;max-width:280px}.empty-icon[data-v-31b73dec]{font-size:64px;color:#dee2e6;margin-bottom:16px}.empty-content h3[data-v-31b73dec]{margin:0 0 8px;font-size:20px;color:#495057}.empty-content p[data-v-31b73dec]{margin:0 0 24px;font-size:16px;color:#6c757d;line-height:1.5}.start-button[data-v-31b73dec]{--border-radius: 12px;height:48px;font-weight:600}.loading-state[data-v-31b73dec]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#6c757d}.loading-state p[data-v-31b73dec]{margin-top:16px;font-size:14px}.add-fab[data-v-31b73dec]{--box-shadow: 0 8px 24px rgba(0, 123, 255, .3)}@media (max-width: 480px){.header-gradient[data-v-31b73dec]{padding:20px 16px}.status-indicators[data-v-31b73dec]{flex-direction:column;gap:12px}.card-content[data-v-31b73dec]{padding:16px;flex-direction:column;align-items:stretch;gap:16px}.checklist-actions[data-v-31b73dec]{flex-direction:row;justify-content:space-between;align-items:center;min-width:auto}.status-section[data-v-31b73dec]{flex-direction:row;gap:12px}.progress-circle[data-v-31b73dec]{width:40px;height:40px;font-size:10px}}\n',document.head.appendChild(a);const V={class:"header-gradient"},W={class:"header-content"},X={key:0,class:"unit-info"},Z={class:"status-indicators"},ee={class:"content-container"},ae={key:0,class:"checklists-section"},te=["onClick"],ie={class:"card-content"},ne={class:"checklist-info"},se={class:"machine-section"},ce={class:"machine-icon"},oe={class:"machine-details"},de={class:"machine-id"},le={class:"patient-section"},re={class:"patient-icon"},pe={class:"patient-details"},ue={class:"phase-info"},ge={class:"checklist-actions"},he={class:"status-section"},fe={class:"progress-text"},me={class:"time-info"},xe={class:"time-label"},ve={key:0,class:"paused-indicator"},be={key:1,class:"empty-state"},ye={class:"empty-content"},we={key:2,class:"loading-state"};e("default",J(t({__name:"ChecklistListPage",setup(e){const a=b(),t=K.getInstance().getCurrentUserUseCase(),J=i(!1),ke=i(null),_e=i([]),ze=i([]),Ce=n(()=>ze.value.filter(e=>"available"===e.status).length),je=n(()=>ze.value.filter(e=>"occupied"===e.status).length),$e=async()=>{try{const e=await fetch("/api/checklists/active",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),a=await e.json();a.success&&(_e.value=a.checklists)}catch(e){console.error("Erro ao carregar checklists ativos:",e)}},Ie=async()=>{try{const e=await fetch("/api/machines",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"Content-Type":"application/json",Accept:"application/json"}});if(!e.ok)return console.warn(`Failed to load machines: ${e.status}`),void(ze.value=[]);const a=await e.json();a.success&&a.machines?ze.value=a.machines:ze.value=[]}catch(e){console.error("Erro ao carregar máquinas:",e),ze.value=[]}},Se=async()=>{J.value=!0;try{await Promise.all([$e(),Ie()])}finally{J.value=!1}},{isRefreshing:Ae,forceRefresh:De}=Q(Se,{loadOnMount:!1,interval:15e3,onStatsUpdated:()=>{console.log("[ChecklistList] Stats atualizados automaticamente")}}),Pe=async e=>{await De(),e.target.complete()},Ee=e=>{a.push(`/checklist/${e.id}`)},Te=()=>{a.push("/checklist/new")},Ue=e=>({pre_dialysis:"primary",during_session:"warning",post_dialysis:"secondary",completed:"success",interrupted:"danger"}[e]||"medium"),Me=e=>e.replace("_","-"),Re=e=>void 0!==e.phase_completion?Math.round(e.phase_completion):{pre_dialysis:25,during_session:50,post_dialysis:75,completed:100,interrupted:0}[e.current_phase]||0,qe=e=>{const a=new Date(e),t=(new Date).getTime()-a.getTime(),i=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4);return i>0?`${i}h ${n}m`:`${n}m`},Be=e=>{const a=new Date(e),t=(new Date).getTime()-a.getTime(),i=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4);return i>0?`${i}h ${n}m`:`${n}m`};return s(async()=>{await(async()=>{try{ke.value=await t.execute()}catch(e){console.error("Error loading user:",e)}})(),await Se()}),(e,a)=>(o(),c(l(w),null,{default:d(()=>[r(l(I),null,{default:d(()=>[r(l(k),{color:"primary"},{default:d(()=>[r(l(_),{slot:"start"},{default:d(()=>[r(l(z),{"default-href":"/dashboard"})]),_:1}),r(l(C),null,{default:d(()=>[...a[0]||(a[0]=[p("Checklists Ativos",-1)])]),_:1}),r(l(_),{slot:"end"},{default:d(()=>[r(l(j),{onClick:Se,disabled:J.value},{default:d(()=>[r(l($),{icon:l(q)},null,8,["icon"])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),r(l(T),{fullscreen:!0},{default:d(()=>[r(l(S),{slot:"fixed",onIonRefresh:Pe},{default:d(()=>[r(l(A))]),_:1}),u("div",V,[u("div",W,[ke.value?(o(),g("div",X,[u("h2",null,f(ke.value.unit?.name||"Unidade de Hemodiálise"),1),u("p",null,f(_e.value.length)+" checklist"+f(1!==_e.value.length?"s":"")+" "+f(1===_e.value.length?"ativo":"ativos"),1)])):h("",!0),u("div",Z,[u("div",{class:m(["status-item available",{updating:l(Ae)}])},[r(l($),{icon:l(B)},null,8,["icon"]),u("span",null,f(Ce.value)+" Disponível"+f(1!==Ce.value?"is":""),1)],2),u("div",{class:m(["status-item occupied",{updating:l(Ae)}])},[r(l($),{icon:l(O)},null,8,["icon"]),u("span",null,f(je.value)+" Em Uso",1)],2)])])]),u("div",ee,[_e.value.length>0?(o(),g("div",ae,[(o(!0),g(x,null,v(_e.value,e=>{return o(),g("div",{key:e.id,class:"checklist-card",onClick:a=>Ee(e)},[u("div",ie,[u("div",ne,[u("div",se,[u("div",ce,[r(l($),{icon:l(F)},null,8,["icon"])]),u("div",oe,[u("h3",null,f(e.machine.name),1),u("p",de,f(e.machine.identifier),1)])]),u("div",le,[u("div",re,[r(l($),{icon:l(H)},null,8,["icon"])]),u("div",pe,[u("h4",null,f(e.patient.name),1),u("p",ue,f((a=e.current_phase,{pre_dialysis:"Pré-Diálise",during_session:"Durante Sessão",post_dialysis:"Pós-Diálise",completed:"Concluído",interrupted:"Interrompido"}[a]||a)),1)])])]),u("div",ge,[u("div",he,[u("div",{class:m(["progress-circle",Me(e.current_phase)])},[u("span",fe,f(Re(e))+"%",1)],2),u("div",me,[u("span",xe,f(qe(e.created_at)),1)])]),r(l(j),{color:Ue(e.current_phase),size:"small",class:"action-button",onClick:y(a=>Ee(e),["stop"])},{default:d(()=>[p(f(e.paused_at?"RETOMAR":"CONTINUAR"),1)]),_:2},1032,["color","onClick"]),e.paused_at?h("",!0):(o(),c(l(j),{key:0,fill:"clear",size:"small",color:"medium",onClick:y(a=>(async e=>{const a=await U.create({header:"Pausar Checklist",message:`Deseja pausar o checklist da máquina ${e.machine.name}?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Pausar",handler:async()=>{const a=await M.create({message:"Pausando checklist..."});await a.present();try{const a=await fetch(`/api/checklists/${e.id}/pause`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),t=await a.json();if(!t.success)throw new Error(t.message);{const e=await R.create({message:"Checklist pausado com sucesso.",duration:3e3,color:"success"});await e.present(),await Se()}}catch(t){const e=await R.create({message:"Erro ao pausar checklist.",duration:3e3,color:"danger"});await e.present()}finally{await a.dismiss()}}}]});await a.present()})(e),["stop"]),class:"pause-btn"},{default:d(()=>[r(l($),{icon:l(Y),slot:"icon-only"},null,8,["icon"])]),_:1},8,["onClick"]))])]),e.paused_at?(o(),g("div",ve,[r(l($),{icon:l(G)},null,8,["icon"]),u("span",null,"Pausado há "+f(Be(e.paused_at)),1)])):h("",!0)],8,te);var a}),128))])):h("",!0),0!==_e.value.length||J.value?h("",!0):(o(),g("div",be,[u("div",ye,[r(l($),{icon:l(N),class:"empty-icon"},null,8,["icon"]),a[2]||(a[2]=u("h3",null,"Nenhum checklist ativo",-1)),a[3]||(a[3]=u("p",null,"Inicie um novo checklist de segurança para começar.",-1)),r(l(j),{color:"primary",onClick:Te,class:"start-button"},{default:d(()=>[r(l($),{icon:l(L),slot:"start"},null,8,["icon"]),a[1]||(a[1]=p(" Iniciar Checklist ",-1))]),_:1})])])),J.value?(o(),g("div",we,[r(l(D),{name:"crescent"}),a[4]||(a[4]=u("p",null,"Carregando checklists...",-1))])):h("",!0)]),r(l(P),{vertical:"bottom",horizontal:"end",slot:"fixed"},{default:d(()=>[r(l(E),{color:"primary",onClick:Te,class:"add-fab"},{default:d(()=>[r(l($),{icon:l(L)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}))}}),[["__scopeId","data-v-31b73dec"]]))}}});
