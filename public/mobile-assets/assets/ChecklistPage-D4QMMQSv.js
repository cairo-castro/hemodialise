import{d as Ue,n as h,q as r,t as s,J as g,G as d,K as b,v as n,y as a,B as k,H as _,r as f,c as ve,b as _a,o as ga,M as ba,e as ya,x as c,u as ka,w as Ee,D as Te,F as Z,L as ee,z as Ca}from"./vendor-DcQkTNkg.js";import{g as l,A as wa,e as Ia,t as w,o as Ne,q as $e,x as Pa,p as Ve,r as qe,B as L,C as j,k as V,f as Sa,v as Re,w as Me,D as Da,E as Oa,i as Fe,F as Aa,G as Ea,n as ae,l as me}from"./ionic-GHA3wq_y.js";import{r as $,D as U,E as _e,F as xe,G as se,_ as He,H as Ta,t as Be,I as he,J as Na,K as fe,L as ze,m as $a,h as Va,M as qa,j as Ra,N as Ma,g as Fa,O as Le,P as xa,f as Ba,Q as je,R as za,S as La,w as ja}from"./_plugin-vue_export-helper-Dt2dLz-X.js";import{C as Ua,A as N}from"./main-CWXnJFLT.js";const Ha={class:"item-card-header"},Ja={class:"header-content"},Ka={class:"item-card-title"},Wa={key:0,class:"item-card-description"},Ga={key:0,class:"header-badge"},Qa={class:"status-actions"},Xa={class:"action-status-icon success"},Ya={class:"action-status-icon danger"},Za={class:"action-status-icon neutral"},es={key:0,class:"observation-card"},as={class:"observation-label"},ss=["value"],ts=Ue({__name:"ChecklistItem",props:{title:{},description:{default:""},value:{default:null},observation:{default:""},required:{type:Boolean,default:!1}},emits:["update:value","update:observation"],setup(ge,{emit:M}){const H=ge,I=M,F=p=>{H.value===p?(I("update:value",null),I("update:observation","")):(I("update:value",p),p!=="NC"&&I("update:observation",""))},q=p=>{I("update:observation",p)},J=p=>{switch(p){case"C":return $;case"NC":return _e;case"NA":return xe;default:return $}};return(p,v)=>(r(),h("div",{class:b(["checklist-item-card",{"has-value":p.value!==null,"is-conforme":p.value==="C","is-nao-conforme":p.value==="NC","is-nao-aplica":p.value==="NA"}])},[s("div",Ha,[s("div",Ja,[s("h3",Ka,d(p.title),1),p.description?(r(),h("p",Wa,d(p.description),1)):g("",!0)]),p.value?(r(),h("div",Ga,[s("div",{class:b(["status-badge",p.value.toLowerCase()])},[n(a(l),{icon:J(p.value)},null,8,["icon"])],2)])):g("",!0)]),s("div",Qa,[s("button",{class:b(["action-status-btn conforme",{selected:p.value==="C"}]),onClick:v[0]||(v[0]=A=>F("C")),type:"button"},[s("div",Xa,[n(a(l),{icon:a($)},null,8,["icon"])]),v[4]||(v[4]=s("div",{class:"action-status-content"},[s("span",{class:"action-status-label"},"Conforme"),s("span",{class:"action-status-hint"},"Tudo OK")],-1)),p.value==="C"?(r(),k(a(l),{key:0,icon:a(U),class:"selected-check"},null,8,["icon"])):g("",!0)],2),s("button",{class:b(["action-status-btn nao-conforme",{selected:p.value==="NC"}]),onClick:v[1]||(v[1]=A=>F("NC")),type:"button"},[s("div",Ya,[n(a(l),{icon:a(_e)},null,8,["icon"])]),v[5]||(v[5]=s("div",{class:"action-status-content"},[s("span",{class:"action-status-label"},"N√£o Conforme"),s("span",{class:"action-status-hint"},"Problema")],-1)),p.value==="NC"?(r(),k(a(l),{key:0,icon:a(U),class:"selected-check"},null,8,["icon"])):g("",!0)],2),s("button",{class:b(["action-status-btn nao-aplica",{selected:p.value==="NA"}]),onClick:v[2]||(v[2]=A=>F("NA")),type:"button"},[s("div",Za,[n(a(l),{icon:a(xe)},null,8,["icon"])]),v[6]||(v[6]=s("div",{class:"action-status-content"},[s("span",{class:"action-status-label"},"N√£o Aplica"),s("span",{class:"action-status-hint"},"N/A")],-1)),p.value==="NA"?(r(),k(a(l),{key:0,icon:a(U),class:"selected-check"},null,8,["icon"])):g("",!0)],2)]),p.value==="NC"?(r(),h("div",es,[s("label",as,[n(a(l),{icon:a(se)},null,8,["icon"]),v[7]||(v[7]=_(" Descreva o Problema * ",-1))]),s("textarea",{value:p.observation,onInput:v[3]||(v[3]=A=>q(A.target.value)),class:"observation-textarea",rows:"3",placeholder:"Ex: Equipamento apresentando ru√≠do anormal...",required:""},null,40,ss)])):g("",!0)],2))}}),os=He(ts,[["__scopeId","data-v-224039b4"]]),ns={class:"checklist-container"},is={class:"time-display"},ls={class:"current-date"},rs={class:"current-time"},cs={key:0,class:"section"},us={class:"section-title"},ds={class:"search-card"},ps={class:"search-input-wrapper"},vs={key:0,class:"patient-selected"},ms={class:"action-btn selected"},hs={class:"action-icon success"},fs={class:"action-content"},_s={class:"action-title"},gs={class:"action-subtitle"},bs={key:1,class:"search-results"},ys=["onClick"],ks={class:"action-icon primary"},Cs={class:"action-content"},ws={class:"action-title"},Is={class:"action-subtitle"},Ps={key:2,class:"no-results"},Ss={key:3,class:"search-loading"},Ds={key:1,class:"section"},Os={class:"section-title"},As={class:"selection-card"},Es={class:"availability-icon"},Ts={class:"availability-info"},Ns={class:"availability-label"},$s={class:"availability-count"},Vs={class:"form-group"},qs={class:"input-label"},Rs={class:"machine-grid"},Ms=["onClick"],Fs={class:"machine-icon"},xs={class:"machine-info"},Bs={class:"machine-name"},zs={key:0,class:"machine-check"},Ls={class:"form-group"},js={class:"input-label"},Us={class:"shift-selector"},Hs={class:"primary-action"},Js=["disabled"],Ks={key:2},Ws={class:"phase-header"},Gs={class:"phase-time"},Qs={class:"phase-progress"},Xs={class:"progress-steps"},Ys={class:"step-circle"},Zs={key:2},et={class:"step-label"},at={class:"phase-completion"},st={class:"patient-summary"},tt={class:"patient-details"},ot={class:"session-time"},nt={key:2,class:"phase-section"},it={class:"phase-header-card"},lt={class:"phase-header-icon"},rt={class:"phase-header-content"},ct={class:"phase-header-badge"},ut={class:"checklist-items-grid"},dt={class:"observations-card"},pt={class:"card-label"},vt=["disabled"],mt={class:"btn-text"},ht={class:"btn-title"},ft={class:"btn-subtitle"},_t={class:"dashboard-actions"},gt={class:"action-card-icon warning"},bt={class:"action-card-icon danger"},yt={key:3,class:"interrupted-section"},kt={class:"interrupted-content"},Ct={class:"interruption-reason"},wt={key:4,class:"completed-section"},It={class:"completed-content"},Pt={class:"interrupt-modal-content"},St={class:"warning-section"},Dt={class:"form-group"},Ot={class:"modal-buttons"},At=Ue({__name:"ChecklistPage",setup(ge){const M=Ca(),H=ka(),I=Ua.getInstance();I.getSearchPatientUseCase();const F=I.getMachineRepository(),q=f(),J=f(""),p=f(""),v=f(!1),A=f(""),R=f(0),x=f("machine-patient"),C=f(""),P=f([]),B=f(!1),y=f(null);let te;const oe=f(null),ne=f([]),ie=f(null),be=f(!1),i=f(null),S=f(null),ye=f(!1),m=f({machine_id:0,shift:"matutino",observations:"",machine_disinfected:!1,capillary_lines_identified:!1,reagent_test_performed:!1,pressure_sensors_verified:!1,air_bubble_detector_verified:!1,patient_identification_confirmed:!1,vascular_access_evaluated:!1,av_fistula_arm_washed:!1,patient_weighed:!1,vital_signs_checked:!1,medications_reviewed:!1,dialyzer_membrane_checked:!1,equipment_functioning_verified:!1,dialysis_parameters_verified:!1,heparin_double_checked:!1,antisepsis_performed:!1,vascular_access_monitored:!1,vital_signs_monitored_during:!1,patient_comfort_assessed:!1,fluid_balance_monitored:!1,alarms_responded:!1,session_completed_safely:!1,vascular_access_secured:!1,patient_vital_signs_stable:!1,complications_assessed:!1,equipment_cleaned:!1}),K=f({}),W=f({}),Je=["pre_dialysis","during_session","post_dialysis"];let le;const Ke=ve(()=>y.value&&m.value.machine_id&&m.value.shift),G=ve(()=>i.value?z().every(t=>{const u=X(t.key);if(u===null)return!1;if(u==="C"||u==="NA")return!0;if(u==="NC"){const D=ue(t.key);return D&&D.trim().length>0}return!1}):!1),We=ve(()=>i.value?i.value.current_phase==="post_dialysis":!1),ke=o=>({pre_dialysis:"Pr√©-Di√°lise",during_session:"Durante a Sess√£o",post_dialysis:"P√≥s-Di√°lise",completed:"Conclu√≠do",interrupted:"Interrompido"})[o]||o,Ge=o=>({pre_dialysis:"Pr√©",during_session:"Durante",post_dialysis:"P√≥s"})[o]||o,Qe=o=>({pre_dialysis:"Verifica√ß√µes de seguran√ßa antes de iniciar a sess√£o de di√°lise",during_session:"Monitoramento cont√≠nuo durante o procedimento",post_dialysis:"Finaliza√ß√£o segura da sess√£o e limpeza dos equipamentos"})[o]||"",Ce=o=>({pre_dialysis:"warning",during_session:"primary",post_dialysis:"secondary",completed:"success",interrupted:"danger"})[o]||"medium",we=o=>$,Xe=o=>({pre_dialysis:"Preparando",during_session:"Em Andamento",post_dialysis:"Finalizando",completed:"Conclu√≠do",interrupted:"Interrompido"})[o]||o,Ye=o=>({pre_dialysis:"1",during_session:"2",post_dialysis:"3"})[o]||"",Ie=o=>{if(!i.value)return!1;switch(o){case"pre_dialysis":return i.value.pre_dialysis_completed_at!==null;case"during_session":return i.value.during_session_completed_at!==null;case"post_dialysis":return i.value.post_dialysis_completed_at!==null;default:return!1}},z=()=>{var e;return{pre_dialysis:[{key:"machine_disinfected",label:"1. M√°quina Desinfetada",description:"Verificar se a m√°quina foi devidamente desinfetada"},{key:"capillary_lines_identified",label:"2. Linhas e Capilar Identificados (quando h√° reuso)",description:"Identificar e verificar corretamente as linhas capilares"},{key:"reagent_test_performed",label:"3. Teste de Reagente Realizado (pr√©/p√≥s) (quando h√° reuso)",description:"Realizar teste de reagente antes e ap√≥s o procedimento"},{key:"pressure_sensors_verified",label:"4. Sensores de Press√£o Verificados",description:"Verificar sensores: press√£o venosa, arterial e transmembrana"},{key:"air_bubble_detector_verified",label:"5. Detector de Bolhas Funcional e Alinhado",description:"Verificar detector de bolhas de ar e alinhamento √† c√¢mara venosa"},{key:"patient_identification_confirmed",label:"6. Identifica√ß√£o do Paciente Conferida",description:"Confirmar: crach√°, pulseira, cadeira e confirma√ß√£o verbal"},{key:"vascular_access_evaluated",label:"10. Acesso Vascular Verificado",description:"Verificar: curativo, sinais de infec√ß√£o, integridade, heparina no l√∫men"},{key:"av_fistula_arm_washed",label:"7. Lavagem do Bra√ßo da F√≠stula (quando aplic√°vel)",description:"Realizar lavagem do bra√ßo da f√≠stula arteriovenosa"},{key:"patient_weighed",label:"8. Pesagem do Paciente Realizada",description:"Pesar o paciente antes da sess√£o"},{key:"vital_signs_checked",label:"9. Sinais Vitais Conferidos",description:"Verificar sinais vitais conforme protocolo"},{key:"medications_reviewed",label:"11. Prescri√ß√£o M√©dica Conferida",description:"Conferir par√¢metros da m√°quina e medica√ß√µes"},{key:"dialyzer_membrane_checked",label:"Membrana do Dialisador Verificada",description:"Verificar integridade da membrana do dialisador"},{key:"equipment_functioning_verified",label:"Funcionamento dos Equipamentos",description:"Testar funcionamento de todos os equipamentos"}],during_session:[{key:"dialysis_parameters_verified",label:"Par√¢metros de Di√°lise Verificados",description:"Confirmar e ajustar par√¢metros de di√°lise"},{key:"heparin_double_checked",label:"1. Dupla Checagem de Heparina",description:"Realizar dupla checagem da heparina antes de administrar"},{key:"antisepsis_performed",label:"2. Antissepsia Realizada",description:"Antissepsia da pele ou cateter antes da pun√ß√£o/conex√£o"},{key:"vascular_access_monitored",label:"3. Acesso Vascular Monitorado",description:"Monitorar fluxo sangu√≠neo, fixa√ß√£o, conex√£o, sangramento"},{key:"vital_signs_monitored_during",label:"4. Sinais Vitais Durante Sess√£o",description:"Verificar sinais vitais conforme quadro cl√≠nico e protocolo"},{key:"patient_comfort_assessed",label:"Conforto do Paciente Avaliado",description:"Verificar conforto e bem-estar do paciente"},{key:"fluid_balance_monitored",label:"Balan√ßo H√≠drico Monitorado",description:"Acompanhar remo√ß√£o e balan√ßo de fluidos"},{key:"alarms_responded",label:"Resposta a Alarmes",description:"Verificar e responder adequadamente aos alarmes"}],post_dialysis:[{key:"session_completed_safely",label:"1. Desconex√£o Segura Realizada",description:"Desconex√£o sem perda de sangue e sem risco de embolia"},{key:"vascular_access_secured",label:"2. Hemostasia e Curativo do Acesso",description:"Realizar hemostasia e curativo conforme protocolo"},{key:"patient_vital_signs_stable",label:"3. Sinais Vitais Conferidos",description:"Verificar sinais vitais conforme protocolo ou prescri√ß√£o"},{key:"complications_assessed",label:"4. Paciente Avaliado para Complica√ß√µes",description:"Avaliar: sangramento, instabilidade hemodin√¢mica, risco de queda"},{key:"equipment_cleaned",label:"5. Materiais Descartados e M√°quina Programada",description:"Descartar materiais corretamente e programar desinfec√ß√£o"}]}[(e=i.value)==null?void 0:e.current_phase]||[]},Pe=()=>{const o=new Date;J.value=o.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),p.value=o.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},Ze=()=>{if(te&&clearTimeout(te),C.value.length<3){P.value=[];return}B.value=!0,te=setTimeout(async()=>{await ea()},500)},ea=async()=>{if(C.value.length<3){P.value=[],B.value=!1;return}try{const e=await I.getPatientRepository().quickSearch(C.value,10);P.value=e}catch(o){console.error("Erro ao buscar pacientes:",o),P.value=[]}finally{B.value=!1}},aa=o=>{y.value=o,C.value=o.full_name,P.value=[]},sa=()=>{y.value=null,C.value="",P.value=[]},ta=()=>{localStorage.setItem("patient_search_query",C.value),M.push("/patients/new")},oa=async()=>{var t,u,D;if(be.value){x.value="pre-dialysis";return}if(!(await ca()).canCreate)return;const e=await ae.create({message:"Iniciando checklist...",spinner:"crescent"});await e.present();try{const E=await fetch("/api/checklists",{method:"POST",headers:N.getAuthHeaders(),body:JSON.stringify({patient_id:(t=y.value)==null?void 0:t.id,machine_id:m.value.machine_id,shift:m.value.shift,observations:m.value.observations})}),O=await E.json();if(E.ok&&O.success){i.value=O.checklist,oe.value=ne.value.find(fa=>fa.id===m.value.machine_id)||null,Q();const T=O.resumed?"Checklist existente carregado!":"Novo checklist iniciado com sucesso!";await(await w.create({message:T,duration:2e3,color:"success",position:"top"})).present()}else{const T=O.message||((D=(u=O.errors)==null?void 0:u.machine_id)==null?void 0:D[0])||"Erro ao iniciar checklist";throw new Error(T)}}catch(E){await(await w.create({message:E.message||"Erro ao iniciar checklist",duration:3e3,color:"danger",position:"top"})).present()}finally{await e.dismiss()}},na=async()=>{if(!G.value)return;const o=await ae.create({message:"Avan√ßando para pr√≥xima fase...",spinner:"crescent"});await o.present();try{await re();const t=await(await fetch("/api/checklists/".concat(i.value.id,"/advance"),N.getFetchConfig({method:"POST"}))).json();if(t.success)i.value=t.checklist,Q(),q.value&&q.value.$el&&await q.value.$el.scrollToTop(400),await(await w.create({message:t.message,duration:2e3,color:"success",position:"top"})).present();else throw new Error(t.message||"Erro ao avan√ßar fase")}catch(e){await(await w.create({message:e.message||"Erro ao avan√ßar fase",duration:3e3,color:"danger",position:"top"})).present()}finally{await o.dismiss()}},re=async()=>{if(i.value)try{const o={},e={};z().forEach(E=>{const O=X(E.key),T=ue(E.key);let Y=!1;(O==="C"||O==="NA"||O==="NC"&&T&&T.trim().length>0)&&(Y=!0),o[E.key]=Y,T&&T.trim().length>0&&(e[E.key]=T)});const u=await fetch("/api/checklists/".concat(i.value.id,"/phase"),{method:"PATCH",...N.getFetchConfig({body:JSON.stringify({phase_data:o,observations:m.value.observations,item_observations:e})})});if(!u.ok)throw new Error("Erro ao salvar dados");const D=await u.json();D.success&&(R.value=D.phase_completion)}catch(o){console.error("Erro no updatePhaseData:",o)}},ia=async()=>{const o=await ae.create({message:"Interrompendo checklist...",spinner:"crescent"});await o.present();try{const t=await(await fetch("/api/checklists/".concat(i.value.id,"/interrupt"),N.getFetchConfig({method:"POST",body:JSON.stringify({reason:A.value})}))).json();if(t.success)i.value=t.checklist,v.value=!1,await(await w.create({message:"Checklist interrompido com sucesso.",duration:3e3,color:"warning",position:"top"})).present();else throw new Error(t.message||"Erro ao interromper checklist")}catch(e){await(await w.create({message:e.message||"Erro ao interromper checklist",duration:3e3,color:"danger",position:"top"})).present()}finally{await o.dismiss()}},Se=()=>{M.replace("/dashboard")},la=async()=>{if(!i.value)return;const o=await ae.create({message:"Pausando checklist..."});await o.present();try{const t=await(await fetch("/api/checklists/".concat(i.value.id,"/pause"),N.getFetchConfig({method:"POST",body:JSON.stringify({reason:"manual"})}))).json();if(t.success)await(await w.create({message:"Checklist pausado com sucesso. Voc√™ pode retom√°-lo a qualquer momento.",duration:3e3,color:"success",position:"top"})).present(),i.value.paused_at=t.checklist.paused_at,M.replace("/dashboard");else throw new Error(t.message||"Erro ao pausar checklist")}catch(e){console.error("Erro ao pausar checklist:",e),await(await w.create({message:"Erro ao pausar checklist. Tente novamente.",duration:3e3,color:"danger",position:"top"})).present()}finally{await o.dismiss()}},Q=()=>{const o=z(),e=o.filter(t=>X(t.key)!==null).length;R.value=o.length>0?e/o.length*100:0},ra=async()=>{try{ne.value=await F.getAvailable(),await De()}catch(o){console.error("Error loading machines:",o)}},De=async()=>{try{ye.value=!0;const o=await fetch("/api/machines/availability",N.getFetchConfig());if(o.ok){const e=await o.json();S.value=e.availability}}catch(o){console.error("Error fetching machine availability:",o)}finally{ye.value=!1}},ca=async()=>{if(await De(),!S.value)return{canCreate:!0};const{available:o,overall_status:e,message:t}=S.value;if(o===0)return await(await me.create({header:"M√°quinas Indispon√≠veis",message:t||"N√£o h√° m√°quinas dispon√≠veis no momento. Por favor, aguarde at√© que uma m√°quina fique livre.",buttons:["OK"]})).present(),{canCreate:!1};if(e==="warning"||e==="alert"){const u=await me.create({header:"Aten√ß√£o",message:"".concat(t,". Apenas ").concat(o," m√°quina(s) dispon√≠vel(is). Deseja continuar?"),buttons:[{text:"Cancelar",role:"cancel"},{text:"Continuar",role:"confirm"}]});await u.present();const{role:D}=await u.onDidDismiss();return{canCreate:D==="confirm"}}return{canCreate:!0}},ua=async()=>{const o=H.params.id;if(o&&o!=="new")try{const e=await fetch("/api/checklists/".concat(o),N.getFetchConfig());if(e.ok){const t=await e.json();switch(i.value=t,ie.value=t.id,be.value=!0,oe.value=t.machine,y.value=t.patient,t.current_phase){case"pre_dialysis":x.value="pre-dialysis";break;case"during_session":x.value="during-session";break;case"post_dialysis":x.value="post-dialysis";break;default:x.value="pre-dialysis"}t.paused_at&&!t.resumed_at&&await da(),pa(t),Q(),console.log("Checklist carregado:",t)}}catch(e){console.error("Erro ao carregar checklist:",e)}},da=async()=>{if(ie.value)try{(await fetch("/api/checklists/".concat(ie.value,"/resume"),N.getFetchConfig({method:"POST"}))).ok&&console.log("Checklist retomado com sucesso")}catch(o){console.error("Erro ao retomar checklist:",o)}},pa=o=>{Object.keys(m.value).forEach(t=>{o[t]!==void 0&&(m.value[t]=o[t])}),o.item_observations&&(W.value={...o.item_observations}),z().forEach(t=>{const u=o[t.key];u!==void 0&&(u===!0?K.value[t.key]="C":u===!1&&W.value[t.key]&&(K.value[t.key]="NC"))})},Oe=o=>new Date(o).toLocaleDateString("pt-BR"),ce=o=>new Date(o).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),X=o=>K.value[o]||null,va=(o,e)=>{K.value[o]=e,m.value[o]=e==="C",Q(),i.value&&re()},ue=o=>W.value[o]||"";let de=null;const ma=(o,e)=>{W.value[o]=e,de&&clearTimeout(de),de=setTimeout(()=>{i.value&&re()},1e3)},ha=async o=>{try{console.log("üîÑ Carregando paciente ID:",o);const t=await I.getPatientRepository().getById(o);t&&(console.log("‚úÖ Paciente carregado:",t),y.value=t,C.value=t.full_name,P.value=[],await(await w.create({message:"Paciente ".concat(t.full_name," selecionado!"),duration:2e3,color:"success",position:"top"})).present())}catch(e){console.error("‚ùå Erro ao carregar paciente:",e),await(await w.create({message:"Erro ao carregar paciente cadastrado",duration:3e3,color:"danger",position:"top"})).present()}},pe=()=>{const o=localStorage.getItem("return_to_checklist"),e=localStorage.getItem("new_patient_id");console.log("üîç Verificando retorno - return_to_checklist:",o,"new_patient_id:",e),o==="true"&&e&&(console.log("üéØ Detectado retorno de cadastro, carregando paciente..."),ha(parseInt(e)),localStorage.removeItem("return_to_checklist"),localStorage.removeItem("new_patient_id"),localStorage.removeItem("patient_search_query"))};wa(()=>{console.log("üöÄ onIonViewWillEnter - P√°gina sendo exibida"),pe()}),_a(()=>H.path,o=>{console.log("üîÑ Rota mudou para:",o),o==="/checklist/new"&&(console.log("üìç Detectado retorno para /checklist/new via watch"),setTimeout(pe,100))}),ga(()=>{console.log("üèÅ onMounted - P√°gina montada"),ra(),ua(),Pe(),le=setInterval(Pe,1e3),pe()}),ba(async(o,e)=>{if(!i.value||i.value.paused_at||i.value.current_phase==="completed"||i.value.is_interrupted)return!0;const t=await me.create({header:"Pausar Checklist?",message:"Voc√™ est√° saindo do checklist ativo. Deseja paus√°-lo para continuar depois?",buttons:[{text:"Cancelar",role:"cancel",handler:()=>!1},{text:"Sair sem Pausar",role:"destructive",handler:async()=>!0},{text:"Pausar e Sair",handler:async()=>(await Ae(),!0)}]});await t.present();const{role:u}=await t.onDidDismiss();return u==="cancel"||!u?!1:(u==="handler"&&await Ae(),!0)});const Ae=async()=>{if(i.value)try{(await(await fetch("/api/checklists/".concat(i.value.id,"/pause"),N.getFetchConfig({method:"POST",body:JSON.stringify({reason:"auto"})}))).json()).success&&await(await w.create({message:"Checklist pausado automaticamente.",duration:2e3,color:"warning",position:"top"})).present()}catch(o){console.error("Erro ao pausar checklist automaticamente:",o)}};return ya(()=>{le&&clearInterval(le)}),(o,e)=>(r(),k(a(Ia),null,{default:c(()=>[n(a(qe),{translucent:!0},{default:c(()=>[n(a(Ne),{color:"primary"},{default:c(()=>[n(a($e),{slot:"start"},{default:c(()=>[n(a(Pa),{"default-href":"/dashboard"})]),_:1}),n(a(Ve),null,{default:c(()=>[...e[11]||(e[11]=[_("Checklist de Seguran√ßa",-1)])]),_:1})]),_:1})]),_:1}),n(a(Fe),{ref_key:"contentRef",ref:q,fullscreen:!0},{default:c(()=>[s("div",ns,[n(a(L),{class:"time-header-card"},{default:c(()=>[n(a(j),null,{default:c(()=>[s("div",is,[s("div",ls,[n(a(l),{icon:a(Ta),class:"date-icon"},null,8,["icon"]),_(" "+d(p.value),1)]),s("div",rs,[n(a(l),{icon:a(Be),class:"time-icon"},null,8,["icon"]),_(" "+d(J.value),1)])])]),_:1})]),_:1}),i.value?g("",!0):(r(),h("div",cs,[s("h2",us,[n(a(l),{icon:a(he)},null,8,["icon"]),e[12]||(e[12]=_(" Etapa 1: Buscar Paciente ",-1))]),s("div",ds,[s("div",ps,[n(a(l),{icon:a(Na),class:"search-icon"},null,8,["icon"]),Ee(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>C.value=t),type:"text",placeholder:"Digite o nome do paciente...",class:"search-input",onInput:Ze},null,544),[[Te,C.value]])]),y.value?(r(),h("div",vs,[s("div",ms,[s("div",hs,[n(a(l),{icon:a($)},null,8,["icon"])]),s("div",fs,[s("span",_s,d(y.value.full_name),1),s("span",gs,d(Oe(y.value.birth_date))+" ‚Ä¢ "+d(y.value.age)+" anos ",1)]),n(a(V),{fill:"clear",onClick:sa},{default:c(()=>[n(a(l),{icon:a(fe),slot:"icon-only"},null,8,["icon"])]),_:1})])])):P.value.length>0&&C.value.length>0?(r(),h("div",bs,[(r(!0),h(Z,null,ee(P.value,t=>(r(),h("div",{key:t.id,class:"action-btn",onClick:u=>aa(t)},[s("div",ks,[n(a(l),{icon:a(he)},null,8,["icon"])]),s("div",Cs,[s("span",ws,d(t.full_name),1),s("span",Is,d(Oe(t.birth_date))+" ‚Ä¢ "+d(t.age)+" anos ",1)]),n(a(l),{icon:a(ja),class:"chevron"},null,8,["icon"])],8,ys))),128))])):C.value.length>2&&P.value.length===0&&!B.value?(r(),h("div",Ps,[n(a(l),{icon:a(se),class:"no-results-icon"},null,8,["icon"]),e[14]||(e[14]=s("h3",null,"Paciente n√£o encontrado",-1)),e[15]||(e[15]=s("p",null,"N√£o encontramos nenhum paciente com esse nome.",-1)),n(a(V),{expand:"block",onClick:ta,class:"register-btn"},{default:c(()=>[n(a(l),{icon:a(he),slot:"start"},null,8,["icon"]),e[13]||(e[13]=_(" Cadastrar Novo Paciente ",-1))]),_:1})])):g("",!0),B.value?(r(),h("div",Ss,[n(a(Sa),{name:"crescent"}),e[16]||(e[16]=s("p",null,"Buscando...",-1))])):g("",!0)])])),y.value&&!i.value?(r(),h("div",Ds,[s("h2",Os,[n(a(l),{icon:a(ze)},null,8,["icon"]),e[17]||(e[17]=_(" Etapa 2: M√°quina e Turno ",-1))]),s("div",As,[S.value?(r(),h("div",{key:0,class:b(["availability-badge",S.value.overall_status])},[s("div",Es,[S.value.overall_status==="good"?(r(),k(a(l),{key:0,icon:a($)},null,8,["icon"])):S.value.overall_status==="critical"?(r(),k(a(l),{key:1,icon:a(_e)},null,8,["icon"])):(r(),k(a(l),{key:2,icon:a(se)},null,8,["icon"]))]),s("div",Ts,[s("span",Ns,d(S.value.message),1),s("span",$s,d(S.value.available)+" de "+d(S.value.total)+" dispon√≠veis",1)])],2)):g("",!0),s("div",Vs,[s("label",qs,[n(a(l),{icon:a($a)},null,8,["icon"]),e[18]||(e[18]=_(" Selecione a M√°quina ",-1))]),s("div",Rs,[(r(!0),h(Z,null,ee(ne.value,t=>(r(),h("button",{key:t.id,type:"button",class:b(["machine-card",{selected:m.value.machine_id===t.id}]),onClick:u=>m.value.machine_id=t.id},[s("div",Fs,[n(a(l),{icon:a(ze)},null,8,["icon"])]),s("div",xs,[s("span",Bs,d(t.name),1),e[19]||(e[19]=s("span",{class:"machine-status"},"Dispon√≠vel",-1))]),m.value.machine_id===t.id?(r(),h("div",zs,[n(a(l),{icon:a($)},null,8,["icon"])])):g("",!0)],10,Ms))),128))])]),s("div",Ls,[s("label",js,[n(a(l),{icon:a(Be)},null,8,["icon"]),e[20]||(e[20]=_(" Selecione o Turno ",-1))]),s("div",Us,[s("button",{type:"button",class:b(["shift-btn",{active:m.value.shift==="matutino"}]),onClick:e[1]||(e[1]=t=>m.value.shift="matutino")},[n(a(l),{icon:a(Va)},null,8,["icon"]),e[21]||(e[21]=s("span",null,"Matutino",-1)),e[22]||(e[22]=s("span",{class:"shift-time"},"06:00 - 12:00",-1))],2),s("button",{type:"button",class:b(["shift-btn",{active:m.value.shift==="vespertino"}]),onClick:e[2]||(e[2]=t=>m.value.shift="vespertino")},[n(a(l),{icon:a(qa)},null,8,["icon"]),e[23]||(e[23]=s("span",null,"Vespertino",-1)),e[24]||(e[24]=s("span",{class:"shift-time"},"12:00 - 18:00",-1))],2),s("button",{type:"button",class:b(["shift-btn",{active:m.value.shift==="noturno"}]),onClick:e[3]||(e[3]=t=>m.value.shift="noturno")},[n(a(l),{icon:a(Ra)},null,8,["icon"]),e[25]||(e[25]=s("span",null,"Noturno",-1)),e[26]||(e[26]=s("span",{class:"shift-time"},"18:00 - 00:00",-1))],2),s("button",{type:"button",class:b(["shift-btn",{active:m.value.shift==="madrugada"}]),onClick:e[4]||(e[4]=t=>m.value.shift="madrugada")},[n(a(l),{icon:a(Ma)},null,8,["icon"]),e[27]||(e[27]=s("span",null,"Madrugada",-1)),e[28]||(e[28]=s("span",{class:"shift-time"},"00:00 - 06:00",-1))],2)])])]),s("div",Hs,[s("button",{class:"primary-btn",onClick:oa,disabled:!Ke.value},[n(a(l),{icon:a(Fa)},null,8,["icon"]),e[29]||(e[29]=s("div",{class:"btn-text"},[s("span",{class:"btn-title"},"Iniciar Checklist"),s("span",{class:"btn-subtitle"},"Come√ßar verifica√ß√£o de seguran√ßa")],-1)),n(a(l),{icon:a(Le)},null,8,["icon"])],8,Js)])])):g("",!0),i.value?(r(),h("div",Ks,[i.value.current_phase!=="completed"?(r(),k(a(L),{key:0,class:"phase-progress-card"},{default:c(()=>[n(a(j),null,{default:c(()=>[s("div",Ws,[s("h3",null,d(ke(i.value.current_phase)),1),s("div",Gs,[n(a(Re),{color:Ce(i.value.current_phase)},{default:c(()=>[n(a(l),{icon:we(i.value.current_phase)},null,8,["icon"]),n(a(Me),null,{default:c(()=>[_(d(Xe(i.value.current_phase)),1)]),_:1})]),_:1},8,["color"])])]),s("div",Qs,[s("div",Xs,[(r(),h(Z,null,ee(Je,t=>s("div",{class:b(["step",{active:t===i.value.current_phase,completed:Ie(t),interrupted:i.value.is_interrupted}]),key:t},[s("div",Ys,[Ie(t)?(r(),k(a(l),{key:0,icon:a(U)},null,8,["icon"])):i.value.is_interrupted?(r(),k(a(l),{key:1,icon:a(fe)},null,8,["icon"])):(r(),h("span",Zs,d(Ye(t)),1))]),s("span",et,d(Ge(t)),1)],2)),64))])]),s("div",at,[n(a(Da),{value:R.value/100,color:R.value===100?"success":"primary"},null,8,["value","color"]),s("p",null,d(Math.round(R.value))+"% conclu√≠do",1)])]),_:1})]),_:1})):g("",!0),i.value.current_phase!=="completed"?(r(),k(a(L),{key:1,class:"patient-summary-card"},{default:c(()=>[n(a(j),null,{default:c(()=>{var t;return[s("div",st,[s("div",tt,[s("h4",null,d(y.value.full_name),1),s("p",null,d((t=oe.value)==null?void 0:t.name)+" ‚Ä¢ Turno "+d(i.value.shift),1)]),s("div",ot,[s("p",null,"Iniciado √†s "+d(ce(i.value.pre_dialysis_started_at)),1)])])]}),_:1})]),_:1})):g("",!0),!i.value.is_interrupted&&i.value.current_phase!=="completed"?(r(),h("div",nt,[s("div",it,[s("div",lt,[n(a(l),{icon:we(i.value.current_phase)},null,8,["icon"])]),s("div",rt,[s("h3",null,d(ke(i.value.current_phase)),1),s("p",null,d(Qe(i.value.current_phase)),1)]),s("div",ct,[n(a(Re),{color:Ce(i.value.current_phase)},{default:c(()=>[_(d(Math.round(R.value))+"% ",1)]),_:1},8,["color"])])]),s("div",ut,[(r(!0),h(Z,null,ee(z(),t=>(r(),k(os,{key:t.key,title:t.label,description:t.description,value:X(t.key),observation:ue(t.key),"onUpdate:value":u=>va(t.key,u),"onUpdate:observation":u=>ma(t.key,u)},null,8,["title","description","value","observation","onUpdate:value","onUpdate:observation"]))),128))]),s("div",dt,[s("label",pt,[n(a(l),{icon:a(xa)},null,8,["icon"]),e[30]||(e[30]=_(" Observa√ß√µes Adicionais ",-1))]),Ee(s("textarea",{"onUpdate:modelValue":e[5]||(e[5]=t=>m.value.observations=t),class:"observations-input",rows:"4",placeholder:"Digite observa√ß√µes sobre esta fase do checklist..."},null,512),[[Te,m.value.observations]])]),s("button",{class:b(["primary-continue-btn",{disabled:!G.value}]),disabled:!G.value,onClick:na},[n(a(l),{icon:a($)},null,8,["icon"]),s("div",mt,[s("span",ht,d(We.value?"Concluir Checklist":"Avan√ßar para Pr√≥xima Fase"),1),s("span",ft,d(G.value?"Todos os itens verificados":"Complete todos os itens obrigat√≥rios"),1)]),n(a(l),{icon:a(Le)},null,8,["icon"])],10,vt),s("div",_t,[s("button",{class:"action-card warning",onClick:la},[s("div",gt,[n(a(l),{icon:a(Ba)},null,8,["icon"])]),e[31]||(e[31]=s("div",{class:"action-card-content"},[s("span",{class:"action-card-title"},"Pausar"),s("span",{class:"action-card-subtitle"},"Voltar depois")],-1))]),s("button",{class:"action-card danger",onClick:e[6]||(e[6]=t=>v.value=!0)},[s("div",bt,[n(a(l),{icon:a(je)},null,8,["icon"])]),e[32]||(e[32]=s("div",{class:"action-card-content"},[s("span",{class:"action-card-title"},"Interromper"),s("span",{class:"action-card-subtitle"},"Cancelar processo")],-1))])])])):i.value.is_interrupted?(r(),h("div",yt,[n(a(L),{class:"interrupted-card"},{default:c(()=>[n(a(j),null,{default:c(()=>[s("div",kt,[n(a(l),{icon:a(se),class:"interrupted-icon"},null,8,["icon"]),e[35]||(e[35]=s("h3",null,"Checklist Interrompido",-1)),s("p",null,"O checklist foi interrompido em "+d(ce(i.value.interrupted_at)),1),s("p",Ct,[e[33]||(e[33]=s("strong",null,"Motivo:",-1)),_(" "+d(i.value.interruption_reason),1)]),n(a(V),{expand:"block",color:"primary",onClick:Se,class:"return-button"},{default:c(()=>[n(a(l),{icon:a(za),slot:"start"},null,8,["icon"]),e[34]||(e[34]=_(" Retornar ao Dashboard ",-1))]),_:1})])]),_:1})]),_:1})])):g("",!0),i.value.current_phase==="completed"?(r(),h("div",wt,[n(a(L),{class:"completed-card"},{default:c(()=>[n(a(j),null,{default:c(()=>[s("div",It,[n(a(l),{icon:a($),class:"completed-icon"},null,8,["icon"]),e[37]||(e[37]=s("h3",null,"Checklist Conclu√≠do com Sucesso!",-1)),s("p",null,"Todas as fases foram completadas em "+d(ce(i.value.post_dialysis_completed_at)),1),n(a(V),{expand:"block",color:"success",onClick:Se,class:"return-button"},{default:c(()=>[n(a(l),{icon:a(U),slot:"start"},null,8,["icon"]),e[36]||(e[36]=_(" Finalizar e Retornar ",-1))]),_:1})])]),_:1})]),_:1})])):g("",!0)])):g("",!0)]),n(a(Oa),{"is-open":v.value,onWillDismiss:e[10]||(e[10]=t=>v.value=!1)},{default:c(()=>[n(a(qe),null,{default:c(()=>[n(a(Ne),null,{default:c(()=>[n(a(Ve),null,{default:c(()=>[...e[38]||(e[38]=[_("Interromper Checklist",-1)])]),_:1}),n(a($e),{slot:"end"},{default:c(()=>[n(a(V),{onClick:e[7]||(e[7]=t=>v.value=!1)},{default:c(()=>[n(a(l),{icon:a(fe)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),n(a(Fe),null,{default:c(()=>[s("div",Pt,[s("div",St,[n(a(l),{icon:a(La),class:"warning-icon"},null,8,["icon"]),e[39]||(e[39]=s("h3",null,"Aten√ß√£o!",-1)),e[40]||(e[40]=s("p",null,"Voc√™ est√° prestes a interromper o checklist de seguran√ßa. Esta a√ß√£o deve ser usada apenas em casos de emerg√™ncia ou intercorr√™ncias m√©dicas.",-1))]),s("div",Dt,[n(a(Aa),{fill:"outline",class:"patient-input"},{default:c(()=>[n(a(Me),{position:"floating"},{default:c(()=>[...e[41]||(e[41]=[_("Motivo da Interrup√ß√£o",-1)])]),_:1}),n(a(Ea),{modelValue:A.value,"onUpdate:modelValue":e[8]||(e[8]=t=>A.value=t),rows:4,placeholder:"Descreva o motivo da interrup√ß√£o (obrigat√≥rio)",required:""},null,8,["modelValue"])]),_:1})]),s("div",Ot,[n(a(V),{expand:"block",fill:"outline",color:"medium",onClick:e[9]||(e[9]=t=>v.value=!1)},{default:c(()=>[...e[42]||(e[42]=[_(" Cancelar ",-1)])]),_:1}),n(a(V),{expand:"block",color:"danger",disabled:!A.value.trim(),onClick:ia},{default:c(()=>[n(a(l),{icon:a(je),slot:"start"},null,8,["icon"]),e[43]||(e[43]=_(" Confirmar Interrup√ß√£o ",-1))]),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["is-open"])]),_:1},512)]),_:1}))}}),Vt=He(At,[["__scopeId","data-v-8b9563ce"]]);export{Vt as default};
