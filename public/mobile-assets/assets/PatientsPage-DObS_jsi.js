import{d as tt,r as h,c as x,o as st,A as T,q as u,x as n,y as s,v as a,H as d,t as e,G as v,n as m,J as b,L as et,F as at,K as y,C as ot}from"./vendor-BlPZouPF.js";import{e as nt,w as E,t as C,m as $,o as B,x as lt,n as F,k as O,g as l,p as R,H as it,j as q,E as dt,i as H,J as L,K as rt,L as c}from"./ionic-C-hOnMqp.js";import{z as M,v as A,y as U,G as ut,I as j,p as z,F as G,R as J,i as ct,M as pt,_ as vt}from"./_plugin-vue_export-helper-B7Fc93E3.js";import{C as mt}from"./main-DR8MU-et.js";const ft={class:"search-container-dash"},_t={class:"search-card"},gt={class:"stats-grid"},ht={class:"stat-card primary"},yt={class:"stat-icon"},bt={class:"stat-info"},Ct={class:"stat-value"},wt={class:"stat-card success"},It={class:"stat-icon"},kt={class:"stat-info"},Pt={class:"stat-value"},Bt={class:"patients-container-dash"},Ot={class:"section-header"},At={class:"patients-grid"},Nt=["onClick"],Vt={class:"patient-avatar"},Dt={class:"patient-content"},St={class:"patient-header-dash"},xt={class:"patient-meta"},Tt={class:"meta-item"},Et={class:"meta-item"},$t={key:0,class:"patient-details-dash"},Ft={key:0,class:"detail-chip"},Rt={class:"patient-arrow"},qt={key:0,class:"empty-state-dash"},Ht={class:"empty-icon"},Lt={key:0},Mt={key:1},Ut={class:"modal-title-dash"},jt={class:"progress-dash"},zt={class:"input-cards-dash"},Gt={class:"input-card-dash"},Jt={class:"card-icon-dash primary"},Kt={class:"card-content-dash"},Qt={class:"input-card-dash"},Wt={class:"card-icon-dash secondary"},Xt={class:"card-content-dash"},Yt={class:"input-card-dash"},Zt={class:"card-icon-dash tertiary"},ts={class:"card-content-dash"},ss={class:"buttons-dash"},es=["disabled"],as=tt({__name:"PatientsPage",setup(os){const N=mt.getInstance(),K=N.getCreatePatientUseCase(),V=N.get("PatientRepository"),f=h([]),g=h(""),p=h(!1),D=h(!1);let w=null;const i=h({full_name:"",birth_date:"",blood_type:"",allergies:"",observations:""}),I=x(()=>f.value),Q=x(()=>i.value.full_name.length>0&&i.value.birth_date.length>0),S=async(r="")=>{const t=await E.create({message:r?"Buscando pacientes...":"Carregando pacientes...",spinner:"crescent"});await t.present();try{f.value=await V.getAll(r,100)}catch(o){console.error("Error loading patients:",o),await(await C.create({message:"Erro ao carregar pacientes",duration:3e3,color:"danger",position:"top"})).present()}finally{await t.dismiss()}},W=r=>{var o,_;const t=((o=r.target)==null?void 0:o.value)||((_=r.detail)==null?void 0:_.value)||"";if(g.value=t,w&&clearTimeout(w),!t||t.length===0){S();return}w=setTimeout(async()=>{if(t.length>=2){D.value=!0;try{f.value=await V.quickSearch(t,50)}catch(k){console.error("Error searching patients:",k),await(await C.create({message:"Erro ao buscar pacientes",duration:2e3,color:"warning",position:"top"})).present()}finally{D.value=!1}}},500)},X=r=>{console.log("Selected patient:",r)},Y=async()=>{const r=await E.create({message:"Cadastrando paciente...",spinner:"crescent"});await r.present();try{const t=await K.execute(i.value);f.value.unshift(t),i.value={full_name:"",birth_date:"",blood_type:"",allergies:"",observations:""},p.value=!1,await(await C.create({message:"Paciente cadastrado com sucesso!",duration:2e3,color:"success",position:"top"})).present()}catch(t){await(await C.create({message:t.message||"Erro ao cadastrar paciente",duration:3e3,color:"danger",position:"top"})).present()}finally{await r.dismiss()}},Z=r=>{if(!r)return"Data não informada";const t=r.split("-");if(t.length===3){const o=parseInt(t[0]),_=parseInt(t[1])-1,k=parseInt(t[2]),P=new Date(o,_,k);if(!isNaN(P.getTime()))return P.toLocaleDateString("pt-BR")}return"Data inválida"};return st(()=>{S()}),(r,t)=>(u(),T(s(nt),null,{default:n(()=>[a(s(R),{translucent:!0},{default:n(()=>[a(s($),{color:"primary"},{default:n(()=>[a(s(B),{slot:"start"},{default:n(()=>[a(s(lt),{"default-href":"/dashboard"})]),_:1}),a(s(F),null,{default:n(()=>[...t[10]||(t[10]=[d("Pacientes",-1)])]),_:1}),a(s(B),{slot:"end"},{default:n(()=>[a(s(O),{onClick:t[0]||(t[0]=o=>p.value=!0),class:"add-button"},{default:n(()=>[a(s(l),{icon:s(M),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(s(H),{fullscreen:!0,class:"dashboard-content"},{default:n(()=>[e("div",ft,[e("div",_t,[a(s(l),{icon:s(A),class:"search-icon"},null,8,["icon"]),a(s(it),{value:g.value,placeholder:"Buscar pacientes...",onIonInput:t[1]||(t[1]=o=>W(o)),onIonClear:t[2]||(t[2]=o=>g.value=""),"show-clear-button":"focus",class:"search-bar-dash",debounce:"300"},null,8,["value"])])]),e("div",gt,[e("div",ht,[e("div",yt,[a(s(l),{icon:s(A)},null,8,["icon"])]),e("div",bt,[e("span",Ct,v(f.value.length),1),t[11]||(t[11]=e("span",{class:"stat-label"},"Total",-1))])]),e("div",wt,[e("div",It,[a(s(l),{icon:s(U)},null,8,["icon"])]),e("div",kt,[e("span",Pt,v(f.value.length),1),t[12]||(t[12]=e("span",{class:"stat-label"},"Ativos",-1))])])]),e("div",Bt,[e("div",Ot,[t[13]||(t[13]=e("h2",null,"Lista de Pacientes",-1)),a(s(q),{color:"primary"},{default:n(()=>[d(v(I.value.length),1)]),_:1})]),e("div",At,[(u(!0),m(at,null,et(I.value,o=>(u(),m("div",{key:o.id,class:"patient-card-dash",onClick:_=>X(o)},[e("div",Vt,[a(s(l),{icon:s(z)},null,8,["icon"])]),e("div",Dt,[e("div",St,[e("h3",null,v(o.full_name),1),a(s(q),{color:"success",class:"status-badge"},{default:n(()=>[...t[14]||(t[14]=[d("Ativo",-1)])]),_:1})]),e("div",xt,[e("div",Tt,[a(s(l),{icon:s(G)},null,8,["icon"]),e("span",null,v(Z(o.birth_date)),1)]),e("div",Et,[a(s(l),{icon:s(ct)},null,8,["icon"]),e("span",null,v(o.age)+" anos",1)])]),o.blood_type?(u(),m("div",$t,[o.blood_type?(u(),m("div",Ft,[a(s(l),{icon:s(J)},null,8,["icon"]),e("span",null,v(o.blood_type),1)])):b("",!0)])):b("",!0)]),e("div",Rt,[a(s(l),{icon:s(pt)},null,8,["icon"])])],8,Nt))),128))]),I.value.length===0?(u(),m("div",qt,[e("div",Ht,[a(s(l),{icon:s(A)},null,8,["icon"])]),t[16]||(t[16]=e("h3",null,"Nenhum paciente encontrado",-1)),g.value?(u(),m("p",Lt,"Tente ajustar os termos de busca")):(u(),m("p",Mt,"Cadastre o primeiro paciente clicando no botão +")),g.value?b("",!0):(u(),T(s(O),{key:2,onClick:t[3]||(t[3]=o=>p.value=!0),class:"empty-action"},{default:n(()=>[a(s(l),{icon:s(M),slot:"start"},null,8,["icon"]),t[15]||(t[15]=d(" Novo Paciente ",-1))]),_:1}))])):b("",!0)]),a(s(dt),{"is-open":p.value,onWillDismiss:t[9]||(t[9]=o=>p.value=!1)},{default:n(()=>[a(s(R),null,{default:n(()=>[a(s($),{color:"primary"},{default:n(()=>[a(s(F),null,{default:n(()=>[e("div",Ut,[a(s(l),{icon:s(ut)},null,8,["icon"]),t[17]||(t[17]=e("span",null,"Novo Paciente",-1))])]),_:1}),a(s(B),{slot:"end"},{default:n(()=>[a(s(O),{onClick:t[4]||(t[4]=o=>p.value=!1)},{default:n(()=>[a(s(l),{icon:s(j),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(s(H),{class:"modal-content-dash"},{default:n(()=>[e("form",{onSubmit:ot(Y,["prevent"]),class:"form-dash"},[t[34]||(t[34]=e("div",{class:"welcome-card-dash"},[e("h2",null,"Cadastrar Novo Paciente"),e("p",null,"Preencha as informações básicas")],-1)),e("div",jt,[e("div",{class:y(["progress-item",{done:i.value.full_name}])},[...t[18]||(t[18]=[e("div",{class:"progress-dot"},null,-1),e("span",null,"Nome",-1)])],2),e("div",{class:y(["progress-line",{active:i.value.birth_date}])},null,2),e("div",{class:y(["progress-item",{done:i.value.birth_date}])},[...t[19]||(t[19]=[e("div",{class:"progress-dot"},null,-1),e("span",null,"Data",-1)])],2),e("div",{class:y(["progress-line",{active:i.value.blood_type}])},null,2),e("div",{class:y(["progress-item",{done:i.value.blood_type}])},[...t[20]||(t[20]=[e("div",{class:"progress-dot"},null,-1),e("span",null,"Fator RH",-1)])],2)]),e("div",zt,[e("div",Gt,[e("div",Jt,[a(s(l),{icon:s(z)},null,8,["icon"])]),e("div",Kt,[t[21]||(t[21]=e("label",null,"Nome Completo",-1)),a(s(L),{modelValue:i.value.full_name,"onUpdate:modelValue":t[5]||(t[5]=o=>i.value.full_name=o),type:"text",required:"",placeholder:"Digite o nome completo",class:"input-dash"},null,8,["modelValue"])])]),e("div",Qt,[e("div",Wt,[a(s(l),{icon:s(G)},null,8,["icon"])]),e("div",Xt,[t[22]||(t[22]=e("label",null,"Data de Nascimento",-1)),a(s(L),{modelValue:i.value.birth_date,"onUpdate:modelValue":t[6]||(t[6]=o=>i.value.birth_date=o),type:"date",required:"",class:"input-dash"},null,8,["modelValue"])])]),e("div",Yt,[e("div",Zt,[a(s(l),{icon:s(J)},null,8,["icon"])]),e("div",ts,[t[31]||(t[31]=e("label",null,[d("Fator RH "),e("span",{class:"optional"},"(opcional)")],-1)),a(s(rt),{modelValue:i.value.blood_type,"onUpdate:modelValue":t[7]||(t[7]=o=>i.value.blood_type=o),placeholder:"Selecione o tipo sanguíneo",interface:"action-sheet",class:"select-dash"},{default:n(()=>[a(s(c),{value:"A+"},{default:n(()=>[...t[23]||(t[23]=[d("A+",-1)])]),_:1}),a(s(c),{value:"A-"},{default:n(()=>[...t[24]||(t[24]=[d("A-",-1)])]),_:1}),a(s(c),{value:"B+"},{default:n(()=>[...t[25]||(t[25]=[d("B+",-1)])]),_:1}),a(s(c),{value:"B-"},{default:n(()=>[...t[26]||(t[26]=[d("B-",-1)])]),_:1}),a(s(c),{value:"AB+"},{default:n(()=>[...t[27]||(t[27]=[d("AB+",-1)])]),_:1}),a(s(c),{value:"AB-"},{default:n(()=>[...t[28]||(t[28]=[d("AB-",-1)])]),_:1}),a(s(c),{value:"O+"},{default:n(()=>[...t[29]||(t[29]=[d("O+",-1)])]),_:1}),a(s(c),{value:"O-"},{default:n(()=>[...t[30]||(t[30]=[d("O-",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),e("div",ss,[e("button",{type:"button",class:"btn-cancel-dash",onClick:t[8]||(t[8]=o=>p.value=!1)},[a(s(l),{icon:s(j)},null,8,["icon"]),t[32]||(t[32]=d(" Cancelar ",-1))]),e("button",{type:"submit",class:"btn-submit-dash",disabled:!Q.value},[a(s(l),{icon:s(U)},null,8,["icon"]),t[33]||(t[33]=d(" Cadastrar ",-1))],8,es)])],32)]),_:1})]),_:1},8,["is-open"])]),_:1})]),_:1}))}}),rs=vt(as,[["__scopeId","data-v-73f9f08f"]]);export{rs as default};
