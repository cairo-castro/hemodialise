import{d as E,r as d,c as I,o as O,B as S,q as m,x as h,y as o,z as U,v as t,n as w,t as s,C as A,w as _,D as L,E as B}from"./vendor-BOCCj2ty.js";import{e as D,f as M,g as i,h as T,i as V,t as P}from"./ionic-DvfosJhB.js";import{m as R,a as q,l as $,e as N,b as Q,c as z,s as F,_ as G}from"./_plugin-vue_export-helper-BgNw2jzN.js";import{C as H}from"./main-BugRCitN.js";const K={key:0,class:"loading-container"},j={class:"loading-card"},J={key:1,class:"login-container"},W={class:"login-card"},X={class:"login-header"},Y={class:"logo-wrapper"},Z={class:"logo-circle"},ee={class:"input-group"},se={class:"input-label"},oe={class:"input-wrapper"},te=["disabled"],ae={class:"input-group"},le={class:"input-label"},ne={class:"input-wrapper"},ie=["type","disabled"],re=["disabled"],de={class:"card-footer"},ue={class:"footer-badge"},ce=E({__name:"LoginPage",setup(pe){const v=U(),c=H.getInstance(),y=c.getLoginUseCase(),b=c.getCurrentUserUseCase(),f=c.getAuthRepository(),l=d({email:"",password:""}),n=d(!1),u=d(!1),p=d(!1),g=d({header:"",message:""}),x=I(()=>l.value.email.length>0&&l.value.password.length>0),C=async()=>{console.log("Starting login process..."),n.value=!0;try{console.log("Executing login use case..."),await y.execute(l.value),console.log("Login use case completed successfully"),console.log("Getting current user...");const a=await b.execute();console.log("Current user:",a),console.log("User role validation passed - checking permissions"),await(await P.create({message:"Bem-vindo, ".concat(a.name,"!"),duration:1500,color:"success",position:"top"})).present(),console.log("Toast presented"),console.log("About to navigate to dashboard..."),setTimeout(()=>{console.log("Executing router.replace to /dashboard"),v.replace("/dashboard"),console.log("Router.replace called")},100)}catch(a){console.error("Login error:",a),g.value={header:"Erro no Login",message:a.message||"Erro interno. Tente novamente."},p.value=!0}finally{n.value=!1}},k=async()=>{try{if(f.isAuthenticated()){const a=await b.execute();v.replace("/dashboard")}}catch(a){f.removeToken()}};return O(()=>{k()}),(a,e)=>(m(),S(o(D),null,{default:h(()=>[t(o(V),{fullscreen:!0,class:"login-content"},{default:h(()=>[n.value?(m(),w("div",K,[s("div",j,[t(o(M),{name:"crescent",class:"loading-spinner"}),e[4]||(e[4]=s("p",{class:"loading-text"},"Autenticando...",-1))])])):(m(),w("div",J,[e[11]||(e[11]=s("div",{class:"bg-shape shape-1"},null,-1)),e[12]||(e[12]=s("div",{class:"bg-shape shape-2"},null,-1)),e[13]||(e[13]=s("div",{class:"bg-shape shape-3"},null,-1)),s("div",W,[s("div",X,[s("div",Y,[s("div",Z,[t(o(i),{icon:o(R),class:"logo-icon"},null,8,["icon"])])]),e[5]||(e[5]=s("h1",{class:"app-title"},"Hemodiálise",-1)),e[6]||(e[6]=s("p",{class:"app-subtitle"},"Sistema de Segurança e Qualidade",-1))]),s("form",{onSubmit:A(C,["prevent"]),class:"login-form"},[s("div",ee,[s("label",se,[t(o(i),{icon:o(q),class:"label-icon"},null,8,["icon"]),e[7]||(e[7]=s("span",null,"Email",-1))]),s("div",oe,[_(s("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>l.value.email=r),type:"email",required:"",disabled:n.value,placeholder:"seu.email@exemplo.com",class:"input-field",autocomplete:"email"},null,8,te),[[L,l.value.email]])])]),s("div",ae,[s("label",le,[t(o(i),{icon:o($),class:"label-icon"},null,8,["icon"]),e[8]||(e[8]=s("span",null,"Senha",-1))]),s("div",ne,[_(s("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>l.value.password=r),type:u.value?"text":"password",required:"",disabled:n.value,placeholder:"••••••••",class:"input-field",autocomplete:"current-password"},null,8,ie),[[B,l.value.password]]),s("button",{type:"button",class:"password-toggle",onClick:e[2]||(e[2]=r=>u.value=!u.value),tabindex:"-1"},[t(o(i),{icon:u.value?o(N):o(Q)},null,8,["icon"])])])]),s("button",{type:"submit",class:"login-button",disabled:n.value||!x.value},[t(o(i),{icon:o(z),class:"button-icon"},null,8,["icon"]),e[9]||(e[9]=s("span",null,"Entrar no Sistema",-1))],8,re)],32),s("div",de,[s("div",ue,[t(o(i),{icon:o(F),class:"badge-icon"},null,8,["icon"]),e[10]||(e[10]=s("span",null,"Acesso Seguro",-1))])])]),e[14]||(e[14]=s("div",{class:"bottom-info"},[s("p",{class:"info-text"},"Sistema de Controle de Qualidade"),s("p",{class:"info-subtext"},"Estado do Maranhão · 2025")],-1)),t(o(T),{"is-open":p.value,header:g.value.header,message:g.value.message,buttons:["OK"],onDidDismiss:e[3]||(e[3]=r=>p.value=!1)},null,8,["is-open","header","message"])]))]),_:1})]),_:1}))}}),fe=G(ce,[["__scopeId","data-v-cd872b11"]]);export{fe as default};
