import{d as tt,r as h,c as x,o as st,A as T,q as u,x as n,y as s,v as a,t as e,G as v,n as m,J as b,H as r,L as et,F as at,K as y,C as ot}from"./vendor-BlPZouPF.js";import{e as nt,w as E,t as C,m as $,o as O,x as lt,n as F,g as l,k as A,p as R,H as it,j as q,E as dt,i as H,J as L,K as rt,L as c}from"./ionic-C-hOnMqp.js";import{v as w,z as M,y as U,G as ut,I as j,p as z,F as G,R as J,i as ct,M as pt,_ as vt}from"./_plugin-vue_export-helper-B7Fc93E3.js";import{C as mt}from"./main-DpZpFifR.js";const _t={class:"header-title"},ft={class:"search-container-dash"},gt={class:"search-card"},ht={class:"stats-grid"},yt={class:"stat-card primary"},bt={class:"stat-icon"},Ct={class:"stat-info"},wt={class:"stat-value"},It={class:"stat-card success"},kt={class:"stat-icon"},Pt={class:"stat-info"},Bt={class:"stat-value"},Ot={class:"patients-container-dash"},At={class:"section-header"},Nt={class:"patients-grid"},Vt=["onClick"],Dt={class:"patient-avatar"},St={class:"patient-content"},xt={class:"patient-header-dash"},Tt={class:"patient-meta"},Et={class:"meta-item"},$t={class:"meta-item"},Ft={key:0,class:"patient-details-dash"},Rt={key:0,class:"detail-chip"},qt={class:"patient-arrow"},Ht={key:0,class:"empty-state-dash"},Lt={class:"empty-icon"},Mt={key:0},Ut={key:1},jt={class:"modal-title-dash"},zt={class:"progress-dash"},Gt={class:"input-cards-dash"},Jt={class:"input-card-dash"},Kt={class:"card-icon-dash primary"},Qt={class:"card-content-dash"},Wt={class:"input-card-dash"},Xt={class:"card-icon-dash secondary"},Yt={class:"card-content-dash"},Zt={class:"input-card-dash"},ts={class:"card-icon-dash tertiary"},ss={class:"card-content-dash"},es={class:"buttons-dash"},as=["disabled"],os=tt({__name:"PatientsPage",setup(ns){const N=mt.getInstance(),K=N.getCreatePatientUseCase(),V=N.get("PatientRepository"),_=h([]),g=h(""),p=h(!1),D=h(!1);let I=null;const i=h({full_name:"",birth_date:"",blood_type:"",allergies:"",observations:""}),k=x(()=>_.value),Q=x(()=>i.value.full_name.length>0&&i.value.birth_date.length>0),S=async(d="")=>{const t=await E.create({message:d?"Buscando pacientes...":"Carregando pacientes...",spinner:"crescent"});await t.present();try{_.value=await V.getAll(d,100)}catch(o){console.error("Error loading patients:",o),await(await C.create({message:"Erro ao carregar pacientes",duration:3e3,color:"danger",position:"top"})).present()}finally{await t.dismiss()}},W=d=>{var o,f;const t=((o=d.target)==null?void 0:o.value)||((f=d.detail)==null?void 0:f.value)||"";if(g.value=t,I&&clearTimeout(I),!t||t.length===0){S();return}I=setTimeout(async()=>{if(t.length>=2){D.value=!0;try{_.value=await V.quickSearch(t,50)}catch(P){console.error("Error searching patients:",P),await(await C.create({message:"Erro ao buscar pacientes",duration:2e3,color:"warning",position:"top"})).present()}finally{D.value=!1}}},500)},X=d=>{console.log("Selected patient:",d)},Y=async()=>{const d=await E.create({message:"Cadastrando paciente...",spinner:"crescent"});await d.present();try{const t=await K.execute(i.value);_.value.unshift(t),i.value={full_name:"",birth_date:"",blood_type:"",allergies:"",observations:""},p.value=!1,await(await C.create({message:"Paciente cadastrado com sucesso!",duration:2e3,color:"success",position:"top"})).present()}catch(t){await(await C.create({message:t.message||"Erro ao cadastrar paciente",duration:3e3,color:"danger",position:"top"})).present()}finally{await d.dismiss()}},Z=d=>{if(!d)return"Data não informada";const t=d.split("-");if(t.length===3){const o=parseInt(t[0]),f=parseInt(t[1])-1,P=parseInt(t[2]),B=new Date(o,f,P);if(!isNaN(B.getTime()))return B.toLocaleDateString("pt-BR")}return"Data inválida"};return st(()=>{S()}),(d,t)=>(u(),T(s(nt),null,{default:n(()=>[a(s(R),{translucent:!0},{default:n(()=>[a(s($),{color:"primary"},{default:n(()=>[a(s(O),{slot:"start"},{default:n(()=>[a(s(lt),{"default-href":"/dashboard"})]),_:1}),a(s(F),null,{default:n(()=>[e("div",_t,[a(s(l),{icon:s(w)},null,8,["icon"]),t[10]||(t[10]=e("span",null,"Pacientes",-1))])]),_:1}),a(s(O),{slot:"end"},{default:n(()=>[a(s(A),{onClick:t[0]||(t[0]=o=>p.value=!0),class:"add-button"},{default:n(()=>[a(s(l),{icon:s(M),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(s(H),{fullscreen:!0,class:"dashboard-content"},{default:n(()=>[e("div",ft,[e("div",gt,[a(s(l),{icon:s(w),class:"search-icon"},null,8,["icon"]),a(s(it),{value:g.value,placeholder:"Buscar pacientes...",onIonInput:t[1]||(t[1]=o=>W(o)),onIonClear:t[2]||(t[2]=o=>g.value=""),"show-clear-button":"focus",class:"search-bar-dash",debounce:"300"},null,8,["value"])])]),e("div",ht,[e("div",yt,[e("div",bt,[a(s(l),{icon:s(w)},null,8,["icon"])]),e("div",Ct,[e("span",wt,v(_.value.length),1),t[11]||(t[11]=e("span",{class:"stat-label"},"Total",-1))])]),e("div",It,[e("div",kt,[a(s(l),{icon:s(U)},null,8,["icon"])]),e("div",Pt,[e("span",Bt,v(_.value.length),1),t[12]||(t[12]=e("span",{class:"stat-label"},"Ativos",-1))])])]),e("div",Ot,[e("div",At,[t[13]||(t[13]=e("h2",null,"Lista de Pacientes",-1)),a(s(q),{color:"primary"},{default:n(()=>[r(v(k.value.length),1)]),_:1})]),e("div",Nt,[(u(!0),m(at,null,et(k.value,o=>(u(),m("div",{key:o.id,class:"patient-card-dash",onClick:f=>X(o)},[e("div",Dt,[a(s(l),{icon:s(z)},null,8,["icon"])]),e("div",St,[e("div",xt,[e("h3",null,v(o.full_name),1),a(s(q),{color:"success",class:"status-badge"},{default:n(()=>[...t[14]||(t[14]=[r("Ativo",-1)])]),_:1})]),e("div",Tt,[e("div",Et,[a(s(l),{icon:s(G)},null,8,["icon"]),e("span",null,v(Z(o.birth_date)),1)]),e("div",$t,[a(s(l),{icon:s(ct)},null,8,["icon"]),e("span",null,v(o.age)+" anos",1)])]),o.blood_type?(u(),m("div",Ft,[o.blood_type?(u(),m("div",Rt,[a(s(l),{icon:s(J)},null,8,["icon"]),e("span",null,v(o.blood_type),1)])):b("",!0)])):b("",!0)]),e("div",qt,[a(s(l),{icon:s(pt)},null,8,["icon"])])],8,Vt))),128))]),k.value.length===0?(u(),m("div",Ht,[e("div",Lt,[a(s(l),{icon:s(w)},null,8,["icon"])]),t[16]||(t[16]=e("h3",null,"Nenhum paciente encontrado",-1)),g.value?(u(),m("p",Mt,"Tente ajustar os termos de busca")):(u(),m("p",Ut,"Cadastre o primeiro paciente clicando no botão +")),g.value?b("",!0):(u(),T(s(A),{key:2,onClick:t[3]||(t[3]=o=>p.value=!0),class:"empty-action"},{default:n(()=>[a(s(l),{icon:s(M),slot:"start"},null,8,["icon"]),t[15]||(t[15]=r(" Novo Paciente ",-1))]),_:1}))])):b("",!0)]),a(s(dt),{"is-open":p.value,onWillDismiss:t[9]||(t[9]=o=>p.value=!1)},{default:n(()=>[a(s(R),null,{default:n(()=>[a(s($),{color:"primary"},{default:n(()=>[a(s(F),null,{default:n(()=>[e("div",jt,[a(s(l),{icon:s(ut)},null,8,["icon"]),t[17]||(t[17]=e("span",null,"Novo Paciente",-1))])]),_:1}),a(s(O),{slot:"end"},{default:n(()=>[a(s(A),{onClick:t[4]||(t[4]=o=>p.value=!1)},{default:n(()=>[a(s(l),{icon:s(j),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(s(H),{class:"modal-content-dash"},{default:n(()=>[e("form",{onSubmit:ot(Y,["prevent"]),class:"form-dash"},[t[34]||(t[34]=e("div",{class:"welcome-card-dash"},[e("h2",null,"Cadastrar Novo Paciente"),e("p",null,"Preencha as informações básicas")],-1)),e("div",zt,[e("div",{class:y(["progress-item",{done:i.value.full_name}])},[...t[18]||(t[18]=[e("div",{class:"progress-dot"},null,-1),e("span",null,"Nome",-1)])],2),e("div",{class:y(["progress-line",{active:i.value.birth_date}])},null,2),e("div",{class:y(["progress-item",{done:i.value.birth_date}])},[...t[19]||(t[19]=[e("div",{class:"progress-dot"},null,-1),e("span",null,"Data",-1)])],2),e("div",{class:y(["progress-line",{active:i.value.blood_type}])},null,2),e("div",{class:y(["progress-item",{done:i.value.blood_type}])},[...t[20]||(t[20]=[e("div",{class:"progress-dot"},null,-1),e("span",null,"Fator RH",-1)])],2)]),e("div",Gt,[e("div",Jt,[e("div",Kt,[a(s(l),{icon:s(z)},null,8,["icon"])]),e("div",Qt,[t[21]||(t[21]=e("label",null,"Nome Completo",-1)),a(s(L),{modelValue:i.value.full_name,"onUpdate:modelValue":t[5]||(t[5]=o=>i.value.full_name=o),type:"text",required:"",placeholder:"Digite o nome completo",class:"input-dash"},null,8,["modelValue"])])]),e("div",Wt,[e("div",Xt,[a(s(l),{icon:s(G)},null,8,["icon"])]),e("div",Yt,[t[22]||(t[22]=e("label",null,"Data de Nascimento",-1)),a(s(L),{modelValue:i.value.birth_date,"onUpdate:modelValue":t[6]||(t[6]=o=>i.value.birth_date=o),type:"date",required:"",class:"input-dash"},null,8,["modelValue"])])]),e("div",Zt,[e("div",ts,[a(s(l),{icon:s(J)},null,8,["icon"])]),e("div",ss,[t[31]||(t[31]=e("label",null,[r("Fator RH "),e("span",{class:"optional"},"(opcional)")],-1)),a(s(rt),{modelValue:i.value.blood_type,"onUpdate:modelValue":t[7]||(t[7]=o=>i.value.blood_type=o),placeholder:"Selecione o tipo sanguíneo",interface:"action-sheet",class:"select-dash"},{default:n(()=>[a(s(c),{value:"A+"},{default:n(()=>[...t[23]||(t[23]=[r("A+",-1)])]),_:1}),a(s(c),{value:"A-"},{default:n(()=>[...t[24]||(t[24]=[r("A-",-1)])]),_:1}),a(s(c),{value:"B+"},{default:n(()=>[...t[25]||(t[25]=[r("B+",-1)])]),_:1}),a(s(c),{value:"B-"},{default:n(()=>[...t[26]||(t[26]=[r("B-",-1)])]),_:1}),a(s(c),{value:"AB+"},{default:n(()=>[...t[27]||(t[27]=[r("AB+",-1)])]),_:1}),a(s(c),{value:"AB-"},{default:n(()=>[...t[28]||(t[28]=[r("AB-",-1)])]),_:1}),a(s(c),{value:"O+"},{default:n(()=>[...t[29]||(t[29]=[r("O+",-1)])]),_:1}),a(s(c),{value:"O-"},{default:n(()=>[...t[30]||(t[30]=[r("O-",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),e("div",es,[e("button",{type:"button",class:"btn-cancel-dash",onClick:t[8]||(t[8]=o=>p.value=!1)},[a(s(l),{icon:s(j)},null,8,["icon"]),t[32]||(t[32]=r(" Cancelar ",-1))]),e("button",{type:"submit",class:"btn-submit-dash",disabled:!Q.value},[a(s(l),{icon:s(U)},null,8,["icon"]),t[33]||(t[33]=r(" Cadastrar ",-1))],8,as)])],32)]),_:1})]),_:1},8,["is-open"])]),_:1})]),_:1}))}}),us=vt(os,[["__scopeId","data-v-01f9ee76"]]);export{us as default};
