System.register(["./ionic-legacy-DR1m-lCA.js","./vendor-legacy-KI3bjCrV.js","./_plugin-vue_export-helper-legacy-GvfV0fjJ.js","./main-legacy-Hz1Y65cR.js","./useStatsAutoRefresh-legacy-VL_TK65D.js"],function(a,e){"use strict";var t,i,n,o,c,r,l,s,d,u,p,v,m,g,f,b,x,h,y,w,k,_,C,z,q,E,M,D,j,I,S,R,A,N,L,V,$,P,U,B,T,H,G,X,Y,F,J,W,K,O,Q,Z,aa,ea,ta,ia,na,oa,ca,ra,la;return{setters:[a=>{t=a.e,i=a.t,n=a.o,o=a.q,c=a.x,r=a.p,l=a.k,s=a.g,d=a.r,u=a.s,p=a.u,v=a.B,m=a.C,g=a.f,f=a.E,b=a.i,x=a.w,h=a.J,y=a.G,w=a.l,k=a.j,_=a._},a=>{C=a.d,z=a.r,q=a.c,E=a.o,M=a.B,D=a.q,j=a.x,I=a.y,S=a.v,R=a.H,A=a.t,N=a.n,L=a.G,V=a.K,$=a.J,P=a.F,U=a.L,B=a.C,T=a.z},a=>{H=a.A,G=a.B,X=a.H,Y=a.t,F=a.L,J=a.r,W=a.X,K=a.Y,O=a.Z,Q=a.P,Z=a.q,aa=a.W,ea=a.$,ta=a.p,ia=a.b,na=a.w,oa=a.a0,ca=a._},a=>{ra=a.C},a=>{la=a.u}],execute:function(){var sa=document.createElement("style");sa.textContent=".machines-content[data-v-65c44c83]{--background: var(--ion-background-color)}.machines-container[data-v-65c44c83]{padding-bottom:24px}.time-header-card[data-v-65c44c83]{margin:16px;border-radius:16px;box-shadow:0 2px 12px rgba(0,0,0,.08);background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-primary-shade) 100%)}.time-header-card ion-card-content[data-v-65c44c83]{padding:16px 20px}.time-display[data-v-65c44c83]{display:flex;justify-content:space-between;align-items:center;color:#fff}.current-date[data-v-65c44c83],.current-time[data-v-65c44c83]{display:flex;align-items:center;gap:8px;font-weight:600}.current-date[data-v-65c44c83]{font-size:.9rem;text-transform:capitalize}.current-time[data-v-65c44c83]{font-size:1.3rem}.date-icon[data-v-65c44c83],.time-icon[data-v-65c44c83]{font-size:1.2rem}.filter-pills[data-v-65c44c83]{display:flex;gap:8px;padding:0 16px 16px;overflow-x:auto;-webkit-overflow-scrolling:touch}.filter-pills[data-v-65c44c83]::-webkit-scrollbar{display:none}.filter-pill[data-v-65c44c83]{display:flex;align-items:center;gap:6px;padding:10px 16px;background:var(--ion-card-background);border:2px solid var(--ion-color-step-150);border-radius:24px;font-size:.85rem;font-weight:600;color:var(--ion-color-step-600);cursor:pointer;transition:all .2s ease;white-space:nowrap;flex-shrink:0}.filter-pill ion-icon[data-v-65c44c83]{font-size:1.2rem}.pill-count[data-v-65c44c83]{display:inline-flex;align-items:center;justify-content:center;min-width:22px;height:22px;padding:0 6px;background:var(--ion-color-step-100);border-radius:11px;font-size:.75rem;font-weight:700}.filter-pill.active[data-v-65c44c83]{border-color:var(--ion-color-primary);background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-primary-rgb),.05));color:var(--ion-color-primary)}.filter-pill.active ion-icon[data-v-65c44c83]{color:var(--ion-color-primary)}.filter-pill.active .pill-count[data-v-65c44c83]{background:var(--ion-color-primary);color:#fff}.filter-pill.available.active[data-v-65c44c83]{border-color:var(--color-available);background:linear-gradient(135deg,rgba(16,185,129,.1),rgba(16,185,129,.05));color:var(--color-available)}.filter-pill.available.active ion-icon[data-v-65c44c83]{color:var(--color-available)}.filter-pill.available.active .pill-count[data-v-65c44c83]{background:var(--color-available)}.filter-pill.occupied.active[data-v-65c44c83]{border-color:var(--color-occupied);background:linear-gradient(135deg,rgba(245,158,11,.1),rgba(245,158,11,.05));color:var(--color-occupied)}.filter-pill.occupied.active ion-icon[data-v-65c44c83]{color:var(--color-occupied)}.filter-pill.occupied.active .pill-count[data-v-65c44c83]{background:var(--color-occupied)}.filter-pill.maintenance.active[data-v-65c44c83]{border-color:var(--color-maintenance);background:linear-gradient(135deg,rgba(239,68,68,.1),rgba(239,68,68,.05));color:var(--color-maintenance)}.filter-pill.maintenance.active ion-icon[data-v-65c44c83]{color:var(--color-maintenance)}.filter-pill.maintenance.active .pill-count[data-v-65c44c83]{background:var(--color-maintenance)}.stats-summary[data-v-65c44c83]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;padding:0 16px 16px}.stat-card[data-v-65c44c83]{display:flex;flex-direction:column;align-items:center;gap:12px;background:var(--ion-card-background);padding:20px 16px;border-radius:16px;box-shadow:var(--shadow-card);transition:all .3s ease;border-top:4px solid transparent;text-align:center}.stat-card[data-v-65c44c83]:active{transform:translateY(-4px);box-shadow:0 8px 16px rgba(0,0,0,.15)}.stat-card ion-icon[data-v-65c44c83]{font-size:2.8rem;flex-shrink:0}.stat-card.available[data-v-65c44c83]{border-top-color:var(--color-available);background:linear-gradient(180deg,rgba(16,185,129,.05) 0%,var(--ion-card-background) 100%)}.stat-card.available ion-icon[data-v-65c44c83]{color:var(--color-available)}.stat-card.occupied[data-v-65c44c83]{border-top-color:var(--color-occupied);background:linear-gradient(180deg,rgba(245,158,11,.05) 0%,var(--ion-card-background) 100%)}.stat-card.occupied ion-icon[data-v-65c44c83]{color:var(--color-occupied)}.stat-card.maintenance[data-v-65c44c83]{border-top-color:var(--color-maintenance);background:linear-gradient(180deg,rgba(239,68,68,.05) 0%,var(--ion-card-background) 100%)}.stat-card.maintenance ion-icon[data-v-65c44c83]{color:var(--color-maintenance)}.stat-card.inactive[data-v-65c44c83]{border-top-color:var(--color-inactive);background:linear-gradient(180deg,rgba(107,114,128,.05) 0%,var(--ion-card-background) 100%)}.stat-card.inactive ion-icon[data-v-65c44c83]{color:var(--color-inactive)}.stat-info[data-v-65c44c83]{display:flex;flex-direction:column;gap:4px}.stat-card .stat-number[data-v-65c44c83]{font-size:2rem;font-weight:800;color:var(--ion-text-color);line-height:1}.stat-card .stat-label[data-v-65c44c83]{font-size:.8rem;color:var(--ion-color-step-600);font-weight:600;line-height:1.2}.stat-card.updating[data-v-65c44c83]{animation:pulse-65c44c83 1.5s ease-in-out infinite}@keyframes pulse-65c44c83{0%,to{opacity:1;transform:scale(1)}50%{opacity:.8;transform:scale(.98)}}.loading-container[data-v-65c44c83]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:var(--ion-color-step-500)}.loading-container ion-spinner[data-v-65c44c83]{margin-bottom:1rem}.machines-list[data-v-65c44c83]{display:flex;flex-direction:column;gap:12px;padding:0 16px 24px}.machine-card-modern[data-v-65c44c83]{position:relative;background:var(--ion-card-background);border-radius:16px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,.08);transition:all .3s ease;border-left:4px solid #e5e7eb;overflow:hidden}.machine-card-modern[data-v-65c44c83]:active{transform:translateY(-2px);box-shadow:0 8px 16px rgba(0,0,0,.12)}.machine-card-modern.available[data-v-65c44c83]{border-left-color:var(--color-available)}.machine-card-modern.occupied[data-v-65c44c83]{border-left-color:var(--color-occupied);cursor:pointer}.machine-card-modern.maintenance[data-v-65c44c83]{border-left-color:var(--color-maintenance)}.machine-card-modern.inactive[data-v-65c44c83]{border-left-color:var(--ion-color-step-600);opacity:.6}.machine-card-header[data-v-65c44c83]{display:flex;align-items:center;gap:16px;margin-bottom:12px}.machine-icon-large[data-v-65c44c83]{width:56px;height:56px;border-radius:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .3s ease}.machine-icon-large ion-icon[data-v-65c44c83]{font-size:2rem;color:#fff}.machine-icon-large.available[data-v-65c44c83]{background:linear-gradient(135deg,#10b981,#059669)}.machine-icon-large.occupied[data-v-65c44c83]{background:linear-gradient(135deg,#f59e0b,#d97706)}.machine-icon-large.maintenance[data-v-65c44c83]{background:linear-gradient(135deg,#ef4444,#dc2626)}.machine-icon-large.inactive[data-v-65c44c83]{background:linear-gradient(135deg,#6b7280,#4b5563)}.machine-primary-info[data-v-65c44c83]{flex:1}.machine-name[data-v-65c44c83]{margin:0 0 4px;font-size:1.15rem;font-weight:700;color:var(--ion-text-color)}.machine-identifier[data-v-65c44c83]{margin:0;font-size:.8rem;color:var(--ion-color-step-500);font-family:Courier New,monospace;font-weight:600}.machine-status-badge[data-v-65c44c83]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--ion-background-color);border-radius:20px}.status-dot[data-v-65c44c83]{width:8px;height:8px;border-radius:50%;flex-shrink:0}.status-dot.available[data-v-65c44c83]{background:var(--color-available);box-shadow:0 0 8px rgba(16,185,129,.6);animation:pulse-65c44c83 2s infinite}.status-dot.occupied[data-v-65c44c83]{background:var(--color-occupied);box-shadow:0 0 8px rgba(245,158,11,.6)}.status-dot.maintenance[data-v-65c44c83]{background:var(--color-maintenance);box-shadow:0 0 8px rgba(239,68,68,.6)}.status-dot.inactive[data-v-65c44c83]{background:var(--color-inactive)}@keyframes pulse-65c44c83{0%,to{opacity:1}50%{opacity:.5}}.status-text[data-v-65c44c83]{font-size:.75rem;font-weight:700;color:var(--ion-color-step-600);text-transform:uppercase;letter-spacing:.5px}.machine-description[data-v-65c44c83]{font-size:.85rem;color:var(--ion-color-step-600);line-height:1.4;margin-bottom:12px}.session-info-modern[data-v-65c44c83]{background:rgba(var(--ion-color-primary-rgb),.1);border:2px solid rgba(var(--ion-color-primary-rgb),.3);border-radius:12px;padding:16px;margin-top:12px}.session-tag[data-v-65c44c83]{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-weight:700;font-size:.9rem;color:var(--ion-color-primary-shade)}.session-tag ion-icon[data-v-65c44c83]{font-size:1.2rem;color:var(--ion-color-primary)}.session-details-grid[data-v-65c44c83]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:12px}.session-detail[data-v-65c44c83]{display:flex;flex-direction:column;gap:4px}.detail-label[data-v-65c44c83]{font-size:.7rem;color:var(--ion-color-step-600);font-weight:600;text-transform:uppercase;letter-spacing:.5px}.detail-value[data-v-65c44c83]{font-size:.9rem;color:var(--ion-text-color);font-weight:700}.session-action[data-v-65c44c83]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:var(--ion-card-background);border-radius:8px;font-size:.85rem;font-weight:600;color:var(--ion-color-primary)}.session-action ion-icon[data-v-65c44c83]:first-child{font-size:1.1rem}.session-action ion-icon[data-v-65c44c83]:last-child{font-size:1rem;color:var(--ion-color-step-500)}.machine-actions[data-v-65c44c83]{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px;padding-top:12px;border-top:1px solid #e5e7eb}.machine-actions ion-button[data-v-65c44c83]{--padding-start: 12px;--padding-end: 12px;height:36px;font-size:.85rem;font-weight:600;text-transform:none;letter-spacing:.3px}.machine-actions ion-button ion-icon[data-v-65c44c83]{font-size:1.1rem}.inactive-overlay[data-v-65c44c83]{position:absolute;top:12px;right:12px;display:flex;align-items:center;gap:6px;padding:6px 12px;background:rgba(107,114,128,.95);border-radius:20px;font-size:.75rem;font-weight:700;color:#fff;text-transform:uppercase;letter-spacing:.5px}.inactive-overlay ion-icon[data-v-65c44c83]{font-size:1rem}.empty-state-modern[data-v-65c44c83]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem;text-align:center}.empty-icon[data-v-65c44c83]{width:80px;height:80px;border-radius:50%;background:var(--ion-color-step-100);display:flex;align-items:center;justify-content:center;margin-bottom:1.5rem}.empty-icon ion-icon[data-v-65c44c83]{font-size:2.5rem;color:var(--ion-color-step-500)}.empty-state-modern h3[data-v-65c44c83]{margin:0 0 .75rem;font-size:1.25rem;font-weight:700;color:var(--ion-text-color)}.empty-state-modern p[data-v-65c44c83]{margin:0;font-size:.9rem;color:var(--ion-color-step-600);line-height:1.5}.machine-modal-content[data-v-65c44c83]{--background: var(--ion-background-color)}.machine-form[data-v-65c44c83]{padding:1.5rem;display:flex;flex-direction:column;gap:1.5rem}.form-section[data-v-65c44c83]{background:var(--ion-card-background);border-radius:16px;padding:1.5rem;box-shadow:0 2px 8px rgba(0,0,0,.06)}.section-title[data-v-65c44c83]{margin:0 0 1.25rem;font-size:1rem;font-weight:700;color:var(--ion-text-color);display:flex;align-items:center;gap:.5rem}.form-group[data-v-65c44c83]{margin-bottom:1.25rem}.form-group[data-v-65c44c83]:last-child{margin-bottom:0}.form-label[data-v-65c44c83]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;font-weight:600;color:var(--ion-text-color);margin-bottom:.5rem}.form-label ion-icon[data-v-65c44c83]{font-size:1.1rem;color:var(--ion-color-primary)}.custom-input[data-v-65c44c83],.custom-textarea[data-v-65c44c83],.custom-select[data-v-65c44c83]{--background: var(--ion-background-color);--border-color: #e5e7eb;--border-width: 2px;--border-style: solid;--border-radius: 12px;--padding-start: 1rem;--padding-end: 1rem;--padding-top: .875rem;--padding-bottom: .875rem;font-size:1rem;color:var(--ion-text-color)}.custom-input[data-v-65c44c83]:focus-within,.custom-textarea[data-v-65c44c83]:focus-within,.custom-select[data-v-65c44c83]:focus-within{--border-color: var(--ion-color-primary);--background: var(--ion-card-background)}.custom-textarea[data-v-65c44c83]{--padding-top: 1rem;--padding-bottom: 1rem}.form-actions[data-v-65c44c83]{display:flex;flex-direction:column;gap:.75rem}.submit-button[data-v-65c44c83]{--background: linear-gradient(135deg, var(--ion-color-primary) 0%, var(--ion-color-primary-shade) 100%);--box-shadow: 0 4px 14px rgba(59, 130, 246, .4);font-weight:700;text-transform:none;letter-spacing:.3px;height:48px;margin:0}.delete-button[data-v-65c44c83]{height:44px;font-weight:600;text-transform:none;letter-spacing:.3px;margin:0}.submit-button ion-icon[data-v-65c44c83],.delete-button ion-icon[data-v-65c44c83]{font-size:1.25rem}ion-fab-button[data-v-65c44c83]{--background: linear-gradient(135deg, var(--ion-color-primary) 0%, var(--ion-color-primary-shade) 100%);--box-shadow: 0 4px 16px rgba(59, 130, 246, .4)}ion-fab-button[data-v-65c44c83]::part(native){box-shadow:0 4px 16px rgba(59,130,246,.4)}ion-fab-button ion-icon[data-v-65c44c83]{font-size:1.75rem}\n/*$vite$:1*/",document.head.appendChild(sa);const da={class:"machines-container"},ua={class:"time-display"},pa={class:"current-date"},va={class:"current-time"},ma={class:"filter-pills"},ga={class:"pill-count"},fa={class:"pill-count"},ba={class:"pill-count"},xa={class:"pill-count"},ha={class:"stats-summary"},ya={class:"stat-info"},wa={class:"stat-number"},ka={class:"stat-info"},_a={class:"stat-number"},Ca={class:"stat-info"},za={class:"stat-number"},qa={class:"stat-info"},Ea={class:"stat-number"},Ma={key:0,class:"loading-container"},Da={key:1,class:"machines-list"},ja=["onClick"],Ia={class:"machine-card-header"},Sa={class:"machine-primary-info"},Ra={class:"machine-name"},Aa={key:0,class:"machine-identifier"},Na={class:"machine-status-badge"},La={class:"status-text"},Va={key:0,class:"machine-description"},$a={key:1,class:"session-info-modern"},Pa={class:"session-tag"},Ua={class:"session-details-grid"},Ba={class:"session-detail"},Ta={class:"detail-value"},Ha={class:"session-detail"},Ga={class:"detail-value"},Xa={class:"session-detail"},Ya={class:"detail-value"},Fa={class:"session-action"},Ja={key:3,class:"inactive-overlay"},Wa={key:0,class:"empty-state-modern"},Ka={class:"empty-icon"},Oa={class:"form-section"},Qa={class:"form-group"},Za={class:"form-group"},ae={class:"form-group"},ee={class:"form-actions"};a("default",ca(C({__name:"MachinesPage",setup(a){const C=T(),ca=ra.getInstance().getMachineRepository(),sa=z([]),te=z(!1),ie=z("all"),ne=z(""),oe=z(""),ce=z(!1),re=z(!1),le=z(!1),se=z({id:null,name:"",identifier:"",description:"",unit_id:null}),de=()=>{const a=new Date;ne.value=a.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),oe.value=a.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})};setInterval(de,1e3),de();const ue=q(()=>sa.value.filter(a=>"available"===a.status&&!1!==a.is_active).length),pe=q(()=>sa.value.filter(a=>"occupied"===a.status).length),ve=q(()=>sa.value.filter(a=>"maintenance"===a.status).length),me=q(()=>sa.value.filter(a=>!1===a.is_active).length),ge=q(()=>{switch(ie.value){case"available":return sa.value.filter(a=>"available"===a.status&&!1!==a.is_active);case"occupied":return sa.value.filter(a=>"occupied"===a.status);case"maintenance":return sa.value.filter(a=>"maintenance"===a.status);case"inactive":return sa.value.filter(a=>!1===a.is_active);default:return sa.value}}),fe=async()=>{te.value=!0;try{const a=await ca.getAll();sa.value=a}catch(a){console.error("Error loading machines:",a);const e=await i.create({message:"Erro ao carregar máquinas",duration:3e3,color:"danger",position:"top"});await e.present()}finally{te.value=!1}},be=async()=>{await fe()},{isRefreshing:xe,forceRefresh:he}=la(be,{loadOnMount:!1,interval:15e3,onStatsUpdated:()=>{console.log("[Machines] Stats atualizados automaticamente")}}),ye=async a=>{await he(),a.target.complete()},we=a=>a.is_active&&!1!==a.is_active?a.status:"inactive",ke=a=>{if(!a.is_active||!1===a.is_active)return"Desativada";switch(a.status){case"available":return"Disponível";case"occupied":return"Em Uso";case"reserved":return"Reservada";case"maintenance":return"Manutenção";default:return a.status}},_e=a=>a?new Date(a).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):"",Ce=async(a,e)=>{try{const t=await ca.updateStatus(a.id,{status:"maintenance",reason:e}),n=sa.value.findIndex(e=>e.id===a.id);-1!==n&&(sa.value[n]={...sa.value[n],...t});const o=await i.create({message:`${a.name} colocada em manutenção`,duration:3e3,color:"success",position:"top"});await o.present()}catch(t){console.error("Error putting machine in maintenance:",t);const a=await i.create({message:t.response?.data?.message||"Erro ao colocar máquina em manutenção",duration:4e3,color:"danger",position:"top"});await a.present()}},ze=async(a,e)=>{try{const t=await ca.toggleActive(a.id,{reason:e}),n=sa.value.findIndex(e=>e.id===a.id);-1!==n&&(sa.value[n]={...sa.value[n],...t});const o=await i.create({message:t.is_active?`${a.name} ativada com sucesso`:`${a.name} desativada com sucesso`,duration:3e3,color:"success",position:"top"});await o.present()}catch(t){console.error("Error toggling machine active:",t);const a=await i.create({message:t.response?.data?.message||"Erro ao alterar estado da máquina",duration:4e3,color:"danger",position:"top"});await a.present()}},qe=()=>{switch(ie.value){case"available":return"Nenhuma máquina disponível no momento";case"occupied":return"Nenhuma máquina em uso";case"maintenance":return"Nenhuma máquina em manutenção";case"inactive":return"Nenhuma máquina desativada";default:return"Nenhuma máquina cadastrada"}},Ee=q(()=>""!==se.value.name.trim()&&""!==se.value.identifier.trim()),Me=async()=>{re.value=!1,se.value={id:null,name:"",identifier:"",description:"",unit_id:null},await(async()=>{try{const a=await fetch("/api/user-units/current",{credentials:"include",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw console.error("Erro ao carregar unidade"),new Error("Não foi possível carregar a unidade");const e=await a.json();if(console.log("Resposta de /api/user-units/current:",e),e.success&&e.unit&&e.unit.id)se.value.unit_id=e.unit.id,console.log("Unit ID configurado:",se.value.unit_id);else{console.error("Nenhuma unidade selecionada");const a=await i.create({message:"Por favor, selecione uma unidade no Dashboard antes de continuar",duration:3e3,color:"warning",position:"top",buttons:[{text:"Ir para Dashboard",handler:()=>{C.push("/dashboard")}}]});await a.present(),De()}}catch(a){console.error("Erro ao carregar unidade:",a);const e=await i.create({message:"Erro ao carregar unidade. Por favor, tente novamente.",duration:2e3,color:"danger",position:"top"});await e.present()}})(),ce.value=!0},De=()=>{ce.value=!1,se.value={id:null,name:"",identifier:"",description:"",unit_id:null}},je=async()=>{if(Ee.value){le.value=!0;try{const a={name:se.value.name,identifier:se.value.identifier,description:se.value.description,unit_id:se.value.unit_id};let e;if(e=re.value?{success:!0,data:await ca.update(se.value.id,a)}:{success:!0,data:await ca.create(a)},!e.success)throw new Error(e.message||"Erro ao salvar máquina");{const a=await i.create({message:e.message||(re.value?"Máquina atualizada com sucesso!":"Máquina criada com sucesso!"),duration:3e3,color:"success",position:"top"});await a.present(),De(),await fe()}}catch(a){const e=await i.create({message:a.message||"Erro ao salvar máquina. Tente novamente.",duration:4e3,color:"danger",position:"top"});await e.present()}finally{le.value=!1}}},Ie=async()=>{const a=await w.create({header:"Confirmar Exclusão",message:`Tem certeza que deseja excluir a máquina <strong>${se.value.name}</strong>? Esta ação irá desativá-la.`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Excluir",role:"destructive",handler:async()=>{await Se()}}]});await a.present()},Se=async()=>{if(se.value.id){le.value=!0;try{await ca.delete(se.value.id);const a={success:!0};if(a.success){const e=await i.create({message:a.message||"Máquina removida com sucesso!",duration:3e3,color:"success",position:"top"});await e.present(),De(),await fe()}}catch(a){const e=await i.create({message:a.message||"Erro ao excluir máquina. Tente novamente.",duration:4e3,color:"danger",position:"top"});await e.present()}finally{le.value=!1}}};return E(()=>{fe()}),(a,w)=>(D(),M(I(t),null,{default:j(()=>[S(I(d),{translucent:!0},{default:j(()=>[S(I(n),{color:"primary"},{default:j(()=>[S(I(o),{slot:"start"},{default:j(()=>[S(I(c),{"default-href":"/dashboard"})]),_:1}),S(I(r),null,{default:j(()=>[...w[8]||(w[8]=[R("Gestão de Máquinas",-1)])]),_:1}),S(I(o),{slot:"end"},{default:j(()=>[S(I(l),{onClick:be,disabled:te.value},{default:j(()=>[S(I(s),{icon:I(H)},null,8,["icon"])]),_:1},8,["disabled"]),S(I(l),{onClick:Me},{default:j(()=>[S(I(s),{icon:I(G)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),S(I(b),{fullscreen:!0,class:"machines-content"},{default:j(()=>[A("div",da,[S(I(u),{slot:"fixed",onIonRefresh:ye},{default:j(()=>[S(I(p))]),_:1}),S(I(v),{class:"time-header-card"},{default:j(()=>[S(I(m),null,{default:j(()=>[A("div",ua,[A("div",pa,[S(I(s),{icon:I(X),class:"date-icon"},null,8,["icon"]),R(" "+L(ne.value),1)]),A("div",va,[S(I(s),{icon:I(Y),class:"time-icon"},null,8,["icon"]),R(" "+L(oe.value),1)])])]),_:1})]),_:1}),A("div",ma,[A("button",{class:V(["filter-pill",{active:"all"===ie.value}]),onClick:w[0]||(w[0]=a=>ie.value="all")},[S(I(s),{icon:I(F)},null,8,["icon"]),w[9]||(w[9]=A("span",null,"Todas",-1)),A("span",ga,L(sa.value.length),1)],2),A("button",{class:V(["filter-pill available",{active:"available"===ie.value}]),onClick:w[1]||(w[1]=a=>ie.value="available")},[S(I(s),{icon:I(J)},null,8,["icon"]),w[10]||(w[10]=A("span",null,"Disponíveis",-1)),A("span",fa,L(ue.value),1)],2),A("button",{class:V(["filter-pill occupied",{active:"occupied"===ie.value}]),onClick:w[2]||(w[2]=a=>ie.value="occupied")},[S(I(s),{icon:I(Y)},null,8,["icon"]),w[11]||(w[11]=A("span",null,"Em Uso",-1)),A("span",ba,L(pe.value),1)],2),A("button",{class:V(["filter-pill maintenance",{active:"maintenance"===ie.value}]),onClick:w[3]||(w[3]=a=>ie.value="maintenance")},[S(I(s),{icon:I(W)},null,8,["icon"]),w[12]||(w[12]=A("span",null,"Manutenção",-1)),A("span",xa,L(ve.value),1)],2)]),A("div",ha,[A("div",{class:V(["stat-card available",{updating:I(xe)}])},[S(I(s),{icon:I(J)},null,8,["icon"]),A("div",ya,[A("span",wa,L(ue.value),1),w[13]||(w[13]=A("span",{class:"stat-label"},"Disponíveis",-1))])],2),A("div",{class:V(["stat-card occupied",{updating:I(xe)}])},[S(I(s),{icon:I(Y)},null,8,["icon"]),A("div",ka,[A("span",_a,L(pe.value),1),w[14]||(w[14]=A("span",{class:"stat-label"},"Em Uso",-1))])],2),A("div",{class:V(["stat-card maintenance",{updating:I(xe)}])},[S(I(s),{icon:I(W)},null,8,["icon"]),A("div",Ca,[A("span",za,L(ve.value),1),w[15]||(w[15]=A("span",{class:"stat-label"},"Manutenção",-1))])],2),A("div",{class:V(["stat-card inactive",{updating:I(xe)}])},[S(I(s),{icon:I(K)},null,8,["icon"]),A("div",qa,[A("span",Ea,L(me.value),1),w[16]||(w[16]=A("span",{class:"stat-label"},"Desativadas",-1))])],2)]),te.value?(D(),N("div",Ma,[S(I(g),{name:"crescent"}),w[17]||(w[17]=A("p",null,"Carregando máquinas...",-1))])):(D(),N("div",Da,[(D(!0),N(P,null,U(ge.value,a=>{return D(),N("div",{key:a.id,class:V(["machine-card-modern",we(a)]),onClick:e=>{return a.current_checklist&&(t=a.current_checklist.id,void C.push(`/checklist/${t}`));var t}},[A("div",Ia,[A("div",{class:V(["machine-icon-large",we(a)])},[S(I(s),{icon:I(F)},null,8,["icon"])],2),A("div",Sa,[A("h3",Ra,L(a.name),1),a.identifier?(D(),N("p",Aa,L(a.identifier),1)):$("",!0)]),A("div",Na,[A("div",{class:V(["status-dot",we(a)])},null,2),A("span",La,L(ke(a)),1)])]),a.description?(D(),N("div",Va,L(a.description),1)):$("",!0),a.current_checklist?(D(),N("div",$a,[A("div",Pa,[S(I(s),{icon:I(ta)},null,8,["icon"]),w[19]||(w[19]=A("span",null,"Sessão Ativa",-1)),a.current_checklist.is_paused?(D(),M(I(k),{key:0,color:"warning"},{default:j(()=>[...w[18]||(w[18]=[R("Pausado",-1)])]),_:1})):$("",!0)]),A("div",Ua,[A("div",Ba,[w[20]||(w[20]=A("span",{class:"detail-label"},"Paciente",-1)),A("span",Ta,L(a.current_checklist.patient_name),1)]),A("div",Ha,[w[21]||(w[21]=A("span",{class:"detail-label"},"Fase",-1)),A("span",Ga,L((t=a.current_checklist.current_phase,{pre_dialysis:"Pré-Diálise",during_session:"Durante Sessão",post_dialysis:"Pós-Diálise",completed:"Concluído",interrupted:"Interrompido"}[t]||t)),1)]),A("div",Xa,[w[22]||(w[22]=A("span",{class:"detail-label"},"Início",-1)),A("span",Ya,L(_e(a.current_checklist.started_at)),1)])]),A("div",Fa,[S(I(s),{icon:I(ia)},null,8,["icon"]),w[23]||(w[23]=A("span",null,"Clique para ver checklist",-1)),S(I(s),{icon:I(na)},null,8,["icon"])])])):$("",!0),a.current_checklist?$("",!0):(D(),N("div",{key:2,class:"machine-actions",onClick:w[4]||(w[4]=B(()=>{},["stop"]))},[S(I(l),{fill:"clear",size:"small",color:"medium",onClick:e=>(async a=>{re.value=!0,se.value={id:a.id,name:a.name,identifier:a.identifier,description:a.description||"",unit_id:a.unit_id},ce.value=!0})(a)},{default:j(()=>[S(I(s),{slot:"start",icon:I(oa)},null,8,["icon"]),w[24]||(w[24]=R(" Editar ",-1))]),_:1},8,["onClick"]),a.is_active&&"available"===a.status?(D(),M(I(l),{key:0,fill:"outline",size:"small",color:"warning",onClick:t=>(async a=>{const{alertController:t}=await _(async()=>{const{alertController:a}=await e.import("./ionic-legacy-DR1m-lCA.js").then(a=>a.a8);return{alertController:a}},void 0),i=await t.create({header:"Colocar em Manutenção",subHeader:a.name,message:"Descreva brevemente o motivo da manutenção:",inputs:[{name:"reason",type:"textarea",placeholder:"Ex: Troca de filtros, ajuste de pressão, etc."}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:e=>{Ce(a,e.reason||"")}}]});await i.present()})(a)},{default:j(()=>[S(I(s),{slot:"start",icon:I(W)},null,8,["icon"]),w[25]||(w[25]=R(" Manutenção ",-1))]),_:1},8,["onClick"])):$("",!0),a.is_active&&"maintenance"===a.status?(D(),M(I(l),{key:1,fill:"solid",size:"small",color:"success",onClick:t=>(async a=>{const{alertController:t}=await _(async()=>{const{alertController:a}=await e.import("./ionic-legacy-DR1m-lCA.js").then(a=>a.a8);return{alertController:a}},void 0),n=await t.create({header:"Liberar Máquina",subHeader:a.name,message:"Tem certeza que deseja liberar esta máquina? Ela ficará disponível para uso.",buttons:[{text:"Cancelar",role:"cancel"},{text:"Liberar",handler:async()=>{try{const e=await ca.updateStatus(a.id,{status:"available"}),t=sa.value.findIndex(e=>e.id===a.id);-1!==t&&(sa.value[t]={...sa.value[t],...e});const n=await i.create({message:`${a.name} liberada com sucesso`,duration:3e3,color:"success",position:"top"});await n.present()}catch(e){console.error("Error releasing machine:",e);const a=await i.create({message:e.response?.data?.message||"Erro ao liberar máquina",duration:4e3,color:"danger",position:"top"});await a.present()}}}]});await n.present()})(a)},{default:j(()=>[S(I(s),{slot:"start",icon:I(J)},null,8,["icon"]),w[26]||(w[26]=R(" Liberar Máquina ",-1))]),_:1},8,["onClick"])):$("",!0),"occupied"!==a.status?(D(),M(I(l),{key:2,fill:"outline",size:"small",color:a.is_active?"danger":"success",onClick:t=>(async a=>{const{alertController:t}=await _(async()=>{const{alertController:a}=await e.import("./ionic-legacy-DR1m-lCA.js").then(a=>a.a8);return{alertController:a}},void 0),i=!a.is_active,n=await t.create({header:i?"Ativar Máquina":"Desativar Máquina",subHeader:a.name,message:i?"A máquina será ativada e ficará disponível para uso.":"Descreva brevemente o motivo da desativação:",inputs:i?[]:[{name:"reason",type:"textarea",placeholder:"Ex: Equipamento danificado, aguardando reparo, etc."}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:e=>{ze(a,e?.reason||"")}}]});await n.present()})(a)},{default:j(()=>[S(I(s),{slot:"start",icon:a.is_active?I(K):I(J)},null,8,["icon"]),R(" "+L(a.is_active?"Desativar":"Ativar"),1)]),_:2},1032,["color","onClick"])):$("",!0)])),a.is_active?$("",!0):(D(),N("div",Ja,[S(I(s),{icon:I(K)},null,8,["icon"]),w[27]||(w[27]=A("span",null,"Desativada",-1))]))],10,ja);var t}),128)),0===ge.value.length?(D(),N("div",Wa,[A("div",Ka,[S(I(s),{icon:I(F)},null,8,["icon"])]),w[28]||(w[28]=A("h3",null,"Nenhuma máquina encontrada",-1)),A("p",null,L(qe()),1)])):$("",!0)]))]),S(I(f),{"is-open":ce.value,onDidDismiss:De},{default:j(()=>[S(I(d),null,{default:j(()=>[S(I(n),null,{default:j(()=>[S(I(r),null,{default:j(()=>[R(L(re.value?"Editar Máquina":"Nova Máquina"),1)]),_:1}),S(I(o),{slot:"end"},{default:j(()=>[S(I(l),{onClick:De},{default:j(()=>[...w[29]||(w[29]=[R("Cancelar",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),S(I(b),{class:"machine-modal-content"},{default:j(()=>[A("form",{onSubmit:B(je,["prevent"]),class:"machine-form"},[A("div",Oa,[w[33]||(w[33]=A("h3",{class:"section-title"},"Informações Básicas",-1)),A("div",Qa,[S(I(x),{position:"stacked",class:"form-label"},{default:j(()=>[S(I(s),{icon:I(F)},null,8,["icon"]),w[30]||(w[30]=R(" Nome da Máquina * ",-1))]),_:1}),S(I(h),{modelValue:se.value.name,"onUpdate:modelValue":w[5]||(w[5]=a=>se.value.name=a),type:"text",placeholder:"Ex: Máquina 01",required:"",disabled:le.value,class:"custom-input"},null,8,["modelValue","disabled"])]),A("div",Za,[S(I(x),{position:"stacked",class:"form-label"},{default:j(()=>[S(I(s),{icon:I(O)},null,8,["icon"]),w[31]||(w[31]=R(" Identificador/Código * ",-1))]),_:1}),S(I(h),{modelValue:se.value.identifier,"onUpdate:modelValue":w[6]||(w[6]=a=>se.value.identifier=a),type:"text",placeholder:"Ex: MAQ-001",required:"",disabled:le.value,class:"custom-input"},null,8,["modelValue","disabled"])]),A("div",ae,[S(I(x),{position:"stacked",class:"form-label"},{default:j(()=>[S(I(s),{icon:I(Q)},null,8,["icon"]),w[32]||(w[32]=R(" Descrição ",-1))]),_:1}),S(I(y),{modelValue:se.value.description,"onUpdate:modelValue":w[7]||(w[7]=a=>se.value.description=a),placeholder:"Informações adicionais sobre a máquina",rows:4,disabled:le.value,class:"custom-textarea"},null,8,["modelValue","disabled"])])]),A("div",ee,[S(I(l),{expand:"block",type:"submit",disabled:le.value||!Ee.value,class:"submit-button"},{default:j(()=>[S(I(s),{slot:"start",icon:le.value?I(Z):I(aa)},null,8,["icon"]),R(" "+L(le.value?"Salvando...":re.value?"Atualizar Máquina":"Criar Máquina"),1)]),_:1},8,["disabled"]),re.value?(D(),M(I(l),{key:0,expand:"block",fill:"outline",color:"danger",onClick:Ie,disabled:le.value,class:"delete-button"},{default:j(()=>[S(I(s),{slot:"start",icon:I(ea)},null,8,["icon"]),w[34]||(w[34]=R(" Excluir Máquina ",-1))]),_:1},8,["disabled"])):$("",!0)])],32)]),_:1})]),_:1},8,["is-open"])]),_:1})]),_:1}))}}),[["__scopeId","data-v-65c44c83"]]))}}});
