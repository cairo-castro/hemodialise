System.register(["./ionic-legacy-CGcOrMzG.js","./vendor-legacy-BtzkBSpK.js","./_plugin-vue_export-helper-legacy-Bx9R0B0b.js","./main-legacy-R7WQwtvQ.js","./useStatsAutoRefresh-legacy-CwdhoSfu.js"],function(a,e){"use strict";var t,i,n,o,r,l,s,c,d,u,p,v,m,f,g,b,h,x,y,w,k,_,C,q,z,E,M,j,D,I,S,R,A,N,$,T,V,L,P,U,B,H,X,G,O,J,Y,F,K,W,Q,Z,aa,ea,ta,ia,na,oa,ra,la,sa;return{setters:[a=>{t=a.e,i=a.t,n=a.o,o=a.q,r=a.x,l=a.p,s=a.k,c=a.g,d=a.r,u=a.s,p=a.u,v=a.B,m=a.C,f=a.f,g=a.E,b=a.i,h=a.w,x=a.J,y=a.G,w=a.l,k=a.j,_=a._},a=>{C=a.d,q=a.r,z=a.c,E=a.o,M=a.A,j=a.n,D=a.v,I=a.x,S=a.t,R=a.G,A=a.q,N=a.l,$=a.E,T=a.J,V=a.I,L=a.F,P=a.K,U=a.B,B=a.y},a=>{H=a.y,X=a.A,G=a.G,O=a.t,J=a.K,Y=a.z,F=a.X,K=a.Y,W=a.Z,Q=a.O,Z=a.$,aa=a.V,ea=a.a0,ta=a.p,ia=a.b,na=a.u,oa=a.a1,ra=a._},a=>{la=a.C},a=>{sa=a.u}],execute:function(){var ca=document.createElement("style");ca.textContent=".machines-content[data-v-0394af6e]{--background: var(--ion-background-color)}.machines-container[data-v-0394af6e]{padding-bottom:24px}.time-header-card[data-v-0394af6e]{margin:16px;border-radius:16px;box-shadow:0 2px 12px rgba(0,0,0,.08);background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-primary-shade) 100%)}.time-header-card ion-card-content[data-v-0394af6e]{padding:16px 20px}.time-display[data-v-0394af6e]{display:flex;justify-content:space-between;align-items:center;color:#fff}.current-date[data-v-0394af6e],.current-time[data-v-0394af6e]{display:flex;align-items:center;gap:8px;font-weight:600}.current-date[data-v-0394af6e]{font-size:.9rem;text-transform:capitalize}.current-time[data-v-0394af6e]{font-size:1.3rem}.date-icon[data-v-0394af6e],.time-icon[data-v-0394af6e]{font-size:1.2rem}.filter-pills[data-v-0394af6e]{display:flex;gap:8px;padding:0 16px 16px;overflow-x:auto;-webkit-overflow-scrolling:touch}.filter-pills[data-v-0394af6e]::-webkit-scrollbar{display:none}.filter-pill[data-v-0394af6e]{display:flex;align-items:center;gap:6px;padding:10px 16px;background:var(--ion-card-background);border:2px solid var(--ion-color-step-150);border-radius:24px;font-size:.85rem;font-weight:600;color:var(--ion-color-step-600);cursor:pointer;transition:all .2s ease;white-space:nowrap;flex-shrink:0}.filter-pill ion-icon[data-v-0394af6e]{font-size:1.2rem}.pill-count[data-v-0394af6e]{display:inline-flex;align-items:center;justify-content:center;min-width:22px;height:22px;padding:0 6px;background:var(--ion-color-step-100);border-radius:11px;font-size:.75rem;font-weight:700}.filter-pill.active[data-v-0394af6e]{border-color:var(--ion-color-primary);background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-primary-rgb),.05));color:var(--ion-color-primary)}.filter-pill.active ion-icon[data-v-0394af6e]{color:var(--ion-color-primary)}.filter-pill.active .pill-count[data-v-0394af6e]{background:var(--ion-color-primary);color:#fff}.filter-pill.available.active[data-v-0394af6e]{border-color:var(--color-available);background:linear-gradient(135deg,rgba(16,185,129,.1),rgba(16,185,129,.05));color:var(--color-available)}.filter-pill.available.active ion-icon[data-v-0394af6e]{color:var(--color-available)}.filter-pill.available.active .pill-count[data-v-0394af6e]{background:var(--color-available)}.filter-pill.occupied.active[data-v-0394af6e]{border-color:var(--color-occupied);background:linear-gradient(135deg,rgba(245,158,11,.1),rgba(245,158,11,.05));color:var(--color-occupied)}.filter-pill.occupied.active ion-icon[data-v-0394af6e]{color:var(--color-occupied)}.filter-pill.occupied.active .pill-count[data-v-0394af6e]{background:var(--color-occupied)}.filter-pill.maintenance.active[data-v-0394af6e]{border-color:var(--color-maintenance);background:linear-gradient(135deg,rgba(239,68,68,.1),rgba(239,68,68,.05));color:var(--color-maintenance)}.filter-pill.maintenance.active ion-icon[data-v-0394af6e]{color:var(--color-maintenance)}.filter-pill.maintenance.active .pill-count[data-v-0394af6e]{background:var(--color-maintenance)}.stats-summary[data-v-0394af6e]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;padding:0 16px 16px}.stat-card[data-v-0394af6e]{display:flex;flex-direction:column;align-items:center;gap:12px;background:var(--ion-card-background);padding:20px 16px;border-radius:16px;box-shadow:var(--shadow-card);transition:all .3s ease;border-top:4px solid transparent;text-align:center}.stat-card[data-v-0394af6e]:active{transform:translateY(-4px);box-shadow:0 8px 16px rgba(0,0,0,.15)}.stat-card ion-icon[data-v-0394af6e]{font-size:2.8rem;flex-shrink:0}.stat-card.available[data-v-0394af6e]{border-top-color:var(--color-available);background:linear-gradient(180deg,rgba(16,185,129,.05) 0%,var(--ion-card-background) 100%)}.stat-card.available ion-icon[data-v-0394af6e]{color:var(--color-available)}.stat-card.occupied[data-v-0394af6e]{border-top-color:var(--color-occupied);background:linear-gradient(180deg,rgba(245,158,11,.05) 0%,var(--ion-card-background) 100%)}.stat-card.occupied ion-icon[data-v-0394af6e]{color:var(--color-occupied)}.stat-card.maintenance[data-v-0394af6e]{border-top-color:var(--color-maintenance);background:linear-gradient(180deg,rgba(239,68,68,.05) 0%,var(--ion-card-background) 100%)}.stat-card.maintenance ion-icon[data-v-0394af6e]{color:var(--color-maintenance)}.stat-card.inactive[data-v-0394af6e]{border-top-color:var(--color-inactive);background:linear-gradient(180deg,rgba(107,114,128,.05) 0%,var(--ion-card-background) 100%)}.stat-card.inactive ion-icon[data-v-0394af6e]{color:var(--color-inactive)}.stat-info[data-v-0394af6e]{display:flex;flex-direction:column;gap:4px}.stat-card .stat-number[data-v-0394af6e]{font-size:2rem;font-weight:800;color:var(--ion-text-color);line-height:1}.stat-card .stat-label[data-v-0394af6e]{font-size:.8rem;color:var(--ion-color-step-600);font-weight:600;line-height:1.2}.stat-card.updating[data-v-0394af6e]{animation:pulse-0394af6e 1.5s ease-in-out infinite}@keyframes pulse-0394af6e{0%,to{opacity:1;transform:scale(1)}50%{opacity:.8;transform:scale(.98)}}.loading-container[data-v-0394af6e]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:var(--ion-color-step-500)}.loading-container ion-spinner[data-v-0394af6e]{margin-bottom:1rem}.machines-list[data-v-0394af6e]{display:flex;flex-direction:column;gap:12px;padding:0 16px 24px}.machine-card-modern[data-v-0394af6e]{position:relative;background:var(--ion-card-background);border-radius:16px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,.08);transition:all .3s ease;border-left:4px solid #e5e7eb;overflow:hidden}.machine-card-modern[data-v-0394af6e]:active{transform:translateY(-2px);box-shadow:0 8px 16px rgba(0,0,0,.12)}.machine-card-modern.available[data-v-0394af6e]{border-left-color:var(--color-available)}.machine-card-modern.occupied[data-v-0394af6e]{border-left-color:var(--color-occupied);cursor:pointer}.machine-card-modern.maintenance[data-v-0394af6e]{border-left-color:var(--color-maintenance)}.machine-card-modern.inactive[data-v-0394af6e]{border-left-color:var(--ion-color-step-600);opacity:.6}.machine-card-header[data-v-0394af6e]{display:flex;align-items:center;gap:16px;margin-bottom:12px}.machine-icon-large[data-v-0394af6e]{width:56px;height:56px;border-radius:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .3s ease}.machine-icon-large ion-icon[data-v-0394af6e]{font-size:2rem;color:#fff}.machine-icon-large.available[data-v-0394af6e]{background:linear-gradient(135deg,#10b981,#059669)}.machine-icon-large.occupied[data-v-0394af6e]{background:linear-gradient(135deg,#f59e0b,#d97706)}.machine-icon-large.maintenance[data-v-0394af6e]{background:linear-gradient(135deg,#ef4444,#dc2626)}.machine-icon-large.inactive[data-v-0394af6e]{background:linear-gradient(135deg,#6b7280,#4b5563)}.machine-primary-info[data-v-0394af6e]{flex:1}.machine-name[data-v-0394af6e]{margin:0 0 4px;font-size:1.15rem;font-weight:700;color:var(--ion-text-color)}.machine-identifier[data-v-0394af6e]{margin:0;font-size:.8rem;color:var(--ion-color-step-500);font-family:Courier New,monospace;font-weight:600}.machine-status-badge[data-v-0394af6e]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--ion-background-color);border-radius:20px}.status-dot[data-v-0394af6e]{width:8px;height:8px;border-radius:50%;flex-shrink:0}.status-dot.available[data-v-0394af6e]{background:var(--color-available);box-shadow:0 0 8px rgba(16,185,129,.6);animation:pulse-0394af6e 2s infinite}.status-dot.occupied[data-v-0394af6e]{background:var(--color-occupied);box-shadow:0 0 8px rgba(245,158,11,.6)}.status-dot.maintenance[data-v-0394af6e]{background:var(--color-maintenance);box-shadow:0 0 8px rgba(239,68,68,.6)}.status-dot.inactive[data-v-0394af6e]{background:var(--color-inactive)}@keyframes pulse-0394af6e{0%,to{opacity:1}50%{opacity:.5}}.status-text[data-v-0394af6e]{font-size:.75rem;font-weight:700;color:var(--ion-color-step-600);text-transform:uppercase;letter-spacing:.5px}.machine-description[data-v-0394af6e]{font-size:.85rem;color:var(--ion-color-step-600);line-height:1.4;margin-bottom:12px}.session-info-modern[data-v-0394af6e]{background:rgba(var(--ion-color-primary-rgb),.1);border:2px solid rgba(var(--ion-color-primary-rgb),.3);border-radius:12px;padding:16px;margin-top:12px}.session-tag[data-v-0394af6e]{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-weight:700;font-size:.9rem;color:var(--ion-color-primary-shade)}.session-tag ion-icon[data-v-0394af6e]{font-size:1.2rem;color:var(--ion-color-primary)}.session-details-grid[data-v-0394af6e]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:12px}.session-detail[data-v-0394af6e]{display:flex;flex-direction:column;gap:4px}.detail-label[data-v-0394af6e]{font-size:.7rem;color:var(--ion-color-step-600);font-weight:600;text-transform:uppercase;letter-spacing:.5px}.detail-value[data-v-0394af6e]{font-size:.9rem;color:var(--ion-text-color);font-weight:700}.session-action[data-v-0394af6e]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:var(--ion-card-background);border-radius:8px;font-size:.85rem;font-weight:600;color:var(--ion-color-primary)}.session-action ion-icon[data-v-0394af6e]:first-child{font-size:1.1rem}.session-action ion-icon[data-v-0394af6e]:last-child{font-size:1rem;color:var(--ion-color-step-500)}.machine-actions[data-v-0394af6e]{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px;padding-top:12px;border-top:1px solid #e5e7eb}.machine-actions ion-button[data-v-0394af6e]{--padding-start: 12px;--padding-end: 12px;height:36px;font-size:.85rem;font-weight:600;text-transform:none;letter-spacing:.3px}.machine-actions ion-button ion-icon[data-v-0394af6e]{font-size:1.1rem}.inactive-overlay[data-v-0394af6e]{position:absolute;top:12px;right:12px;display:flex;align-items:center;gap:6px;padding:6px 12px;background:rgba(107,114,128,.95);border-radius:20px;font-size:.75rem;font-weight:700;color:#fff;text-transform:uppercase;letter-spacing:.5px}.inactive-overlay ion-icon[data-v-0394af6e]{font-size:1rem}.empty-state-modern[data-v-0394af6e]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem;text-align:center}.empty-icon[data-v-0394af6e]{width:80px;height:80px;border-radius:50%;background:var(--ion-color-step-100);display:flex;align-items:center;justify-content:center;margin-bottom:1.5rem}.empty-icon ion-icon[data-v-0394af6e]{font-size:2.5rem;color:var(--ion-color-step-500)}.empty-state-modern h3[data-v-0394af6e]{margin:0 0 .75rem;font-size:1.25rem;font-weight:700;color:var(--ion-text-color)}.empty-state-modern p[data-v-0394af6e]{margin:0;font-size:.9rem;color:var(--ion-color-step-600);line-height:1.5}.machine-modal-content[data-v-0394af6e]{--background: var(--ion-background-color)}.machine-form[data-v-0394af6e]{padding:1.5rem;display:flex;flex-direction:column;gap:1.5rem}.form-section[data-v-0394af6e]{background:var(--ion-card-background);border-radius:16px;padding:1.5rem;box-shadow:0 2px 8px rgba(0,0,0,.06)}.section-title[data-v-0394af6e]{margin:0 0 1.25rem;font-size:1rem;font-weight:700;color:var(--ion-text-color);display:flex;align-items:center;gap:.5rem}.form-group[data-v-0394af6e]{margin-bottom:1.25rem}.form-group[data-v-0394af6e]:last-child{margin-bottom:0}.form-label[data-v-0394af6e]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;font-weight:600;color:var(--ion-text-color);margin-bottom:.5rem}.form-label ion-icon[data-v-0394af6e]{font-size:1.1rem;color:var(--ion-color-primary)}.custom-input[data-v-0394af6e],.custom-textarea[data-v-0394af6e],.custom-select[data-v-0394af6e]{--background: var(--ion-background-color);--border-color: #e5e7eb;--border-width: 2px;--border-style: solid;--border-radius: 12px;--padding-start: 1rem;--padding-end: 1rem;--padding-top: .875rem;--padding-bottom: .875rem;font-size:1rem;color:var(--ion-text-color)}.custom-input[data-v-0394af6e]:focus-within,.custom-textarea[data-v-0394af6e]:focus-within,.custom-select[data-v-0394af6e]:focus-within{--border-color: var(--ion-color-primary);--background: var(--ion-card-background)}.custom-textarea[data-v-0394af6e]{--padding-top: 1rem;--padding-bottom: 1rem}.form-actions[data-v-0394af6e]{display:flex;flex-direction:column;gap:.75rem}.submit-button[data-v-0394af6e]{--background: linear-gradient(135deg, var(--ion-color-primary) 0%, var(--ion-color-primary-shade) 100%);--box-shadow: 0 4px 14px rgba(59, 130, 246, .4);font-weight:700;text-transform:none;letter-spacing:.3px;height:48px;margin:0}.delete-button[data-v-0394af6e]{height:44px;font-weight:600;text-transform:none;letter-spacing:.3px;margin:0}.submit-button ion-icon[data-v-0394af6e],.delete-button ion-icon[data-v-0394af6e]{font-size:1.25rem}ion-fab-button[data-v-0394af6e]{--background: linear-gradient(135deg, var(--ion-color-primary) 0%, var(--ion-color-primary-shade) 100%);--box-shadow: 0 4px 16px rgba(59, 130, 246, .4)}ion-fab-button[data-v-0394af6e]::part(native){box-shadow:0 4px 16px rgba(59,130,246,.4)}ion-fab-button ion-icon[data-v-0394af6e]{font-size:1.75rem}\n/*$vite$:1*/",document.head.appendChild(ca);const da={class:"machines-container"},ua={class:"time-display"},pa={class:"current-date"},va={class:"current-time"},ma={class:"filter-pills"},fa={class:"pill-count"},ga={class:"pill-count"},ba={class:"pill-count"},ha={class:"pill-count"},xa={class:"stats-summary"},ya={class:"stat-info"},wa={class:"stat-number"},ka={class:"stat-info"},_a={class:"stat-number"},Ca={class:"stat-info"},qa={class:"stat-number"},za={class:"stat-info"},Ea={class:"stat-number"},Ma={key:0,class:"loading-container"},ja={key:1,class:"machines-list"},Da=["onClick"],Ia={class:"machine-card-header"},Sa={class:"machine-primary-info"},Ra={class:"machine-name"},Aa={key:0,class:"machine-identifier"},Na={class:"machine-status-badge"},$a={class:"status-text"},Ta={key:0,class:"machine-description"},Va={key:1,class:"session-info-modern"},La={class:"session-tag"},Pa={class:"session-details-grid"},Ua={class:"session-detail"},Ba={class:"detail-value"},Ha={class:"session-detail"},Xa={class:"detail-value"},Ga={class:"session-detail"},Oa={class:"detail-value"},Ja={class:"session-action"},Ya={key:3,class:"inactive-overlay"},Fa={key:0,class:"empty-state-modern"},Ka={class:"empty-icon"},Wa={class:"form-section"},Qa={class:"form-group"},Za={class:"form-group"},ae={class:"form-group"},ee={class:"form-actions"};a("default",ra(C({__name:"MachinesPage",setup(a){const C=B(),ra=la.getInstance().getMachineRepository(),ca=q([]),te=q(!1),ie=q("all"),ne=q(""),oe=q(""),re=q(!1),le=q(!1),se=q(!1),ce=q({id:null,name:"",identifier:"",description:"",unit_id:null}),de=()=>{const a=new Date;ne.value=a.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),oe.value=a.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})};setInterval(de,1e3),de();const ue=z(()=>ca.value.filter(a=>"available"===a.status&&!1!==a.is_active).length),pe=z(()=>ca.value.filter(a=>"occupied"===a.status).length),ve=z(()=>ca.value.filter(a=>"maintenance"===a.status).length),me=z(()=>ca.value.filter(a=>!1===a.is_active).length),fe=z(()=>{switch(ie.value){case"available":return ca.value.filter(a=>"available"===a.status&&!1!==a.is_active);case"occupied":return ca.value.filter(a=>"occupied"===a.status);case"maintenance":return ca.value.filter(a=>"maintenance"===a.status);case"inactive":return ca.value.filter(a=>!1===a.is_active);default:return ca.value}}),ge=async()=>{te.value=!0;try{const a=await ra.getAll();ca.value=a}catch(a){console.error("Error loading machines:",a);const e=await i.create({message:"Erro ao carregar máquinas",duration:3e3,color:"danger",position:"top"});await e.present()}finally{te.value=!1}},be=async()=>{await ge()},{isRefreshing:he,forceRefresh:xe}=sa(be,{loadOnMount:!1,interval:15e3,onStatsUpdated:()=>{console.log("[Machines] Stats atualizados automaticamente")}}),ye=async a=>{await xe(),a.target.complete()},we=a=>a.is_active&&!1!==a.is_active?a.status:"inactive",ke=a=>{if(!a.is_active||!1===a.is_active)return"Desativada";switch(a.status){case"available":return"Disponível";case"occupied":return"Em Uso";case"reserved":return"Reservada";case"maintenance":return"Manutenção";default:return a.status}},_e=a=>a?new Date(a).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):"",Ce=async(a,e)=>{try{const t=await ra.updateStatus(a.id,{status:"maintenance",reason:e}),n=ca.value.findIndex(e=>e.id===a.id);-1!==n&&(ca.value[n]={...ca.value[n],...t});const o=await i.create({message:`${a.name} colocada em manutenção`,duration:3e3,color:"success",position:"top"});await o.present()}catch(t){console.error("Error putting machine in maintenance:",t);const a=await i.create({message:t.response?.data?.message||"Erro ao colocar máquina em manutenção",duration:4e3,color:"danger",position:"top"});await a.present()}},qe=async(a,e)=>{try{const t=await ra.toggleActive(a.id,{reason:e}),n=ca.value.findIndex(e=>e.id===a.id);-1!==n&&(ca.value[n]={...ca.value[n],...t});const o=await i.create({message:t.is_active?`${a.name} ativada com sucesso`:`${a.name} desativada com sucesso`,duration:3e3,color:"success",position:"top"});await o.present()}catch(t){console.error("Error toggling machine active:",t);const a=await i.create({message:t.response?.data?.message||"Erro ao alterar estado da máquina",duration:4e3,color:"danger",position:"top"});await a.present()}},ze=()=>{switch(ie.value){case"available":return"Nenhuma máquina disponível no momento";case"occupied":return"Nenhuma máquina em uso";case"maintenance":return"Nenhuma máquina em manutenção";case"inactive":return"Nenhuma máquina desativada";default:return"Nenhuma máquina cadastrada"}},Ee=z(()=>""!==ce.value.name.trim()&&""!==ce.value.identifier.trim()),Me=async()=>{le.value=!1,ce.value={id:null,name:"",identifier:"",description:"",unit_id:null},await(async()=>{try{const a=await fetch("/api/user-units/current",{credentials:"include",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw console.error("Erro ao carregar unidade"),new Error("Não foi possível carregar a unidade");const e=await a.json();if(console.log("Resposta de /api/user-units/current:",e),e.success&&e.unit&&e.unit.id)ce.value.unit_id=e.unit.id,console.log("Unit ID configurado:",ce.value.unit_id);else{console.error("Nenhuma unidade selecionada");const a=await i.create({message:"Por favor, selecione uma unidade no Dashboard antes de continuar",duration:3e3,color:"warning",position:"top",buttons:[{text:"Ir para Dashboard",handler:()=>{C.push("/dashboard")}}]});await a.present(),je()}}catch(a){console.error("Erro ao carregar unidade:",a);const e=await i.create({message:"Erro ao carregar unidade. Por favor, tente novamente.",duration:2e3,color:"danger",position:"top"});await e.present()}})(),re.value=!0},je=()=>{re.value=!1,ce.value={id:null,name:"",identifier:"",description:"",unit_id:null}},De=async()=>{if(Ee.value){se.value=!0;try{const a=le.value?`/api/machines/${ce.value.id}`:"/api/machines",e=le.value?"PUT":"POST",t=await fetch(a,{method:e,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify({name:ce.value.name,identifier:ce.value.identifier,description:ce.value.description,unit_id:ce.value.unit_id})}),n=await t.json();if(!n.success)throw new Error(n.message||"Erro ao salvar máquina");{const a=await i.create({message:n.message||(le.value?"Máquina atualizada com sucesso!":"Máquina criada com sucesso!"),duration:3e3,color:"success",position:"top"});await a.present(),je(),await ge()}}catch(a){const e=await i.create({message:a.message||"Erro ao salvar máquina. Tente novamente.",duration:4e3,color:"danger",position:"top"});await e.present()}finally{se.value=!1}}},Ie=async()=>{const a=await w.create({header:"Confirmar Exclusão",message:`Tem certeza que deseja excluir a máquina <strong>${ce.value.name}</strong>? Esta ação irá desativá-la.`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Excluir",role:"destructive",handler:async()=>{await Se()}}]});await a.present()},Se=async()=>{if(ce.value.id){se.value=!0;try{const a=await fetch(`/api/machines/${ce.value.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),e=await a.json();if(!e.success)throw new Error(e.message||"Erro ao excluir máquina");{const a=await i.create({message:e.message||"Máquina removida com sucesso!",duration:3e3,color:"success",position:"top"});await a.present(),je(),await ge()}}catch(a){const e=await i.create({message:a.message||"Erro ao excluir máquina. Tente novamente.",duration:4e3,color:"danger",position:"top"});await e.present()}finally{se.value=!1}}};return E(()=>{ge()}),(a,w)=>(j(),M(I(t),null,{default:D(()=>[S(I(d),{translucent:!0},{default:D(()=>[S(I(n),{color:"primary"},{default:D(()=>[S(I(o),{slot:"start"},{default:D(()=>[S(I(r),{"default-href":"/dashboard"})]),_:1}),S(I(l),null,{default:D(()=>[...w[8]||(w[8]=[R("Gestão de Máquinas",-1)])]),_:1}),S(I(o),{slot:"end"},{default:D(()=>[S(I(s),{onClick:be,disabled:te.value},{default:D(()=>[S(I(c),{icon:I(H)},null,8,["icon"])]),_:1},8,["disabled"]),S(I(s),{onClick:Me},{default:D(()=>[S(I(c),{icon:I(X)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),S(I(b),{fullscreen:!0,class:"machines-content"},{default:D(()=>[A("div",da,[S(I(u),{slot:"fixed",onIonRefresh:ye},{default:D(()=>[S(I(p))]),_:1}),S(I(v),{class:"time-header-card"},{default:D(()=>[S(I(m),null,{default:D(()=>[A("div",ua,[A("div",pa,[S(I(c),{icon:I(G),class:"date-icon"},null,8,["icon"]),R(" "+$(ne.value),1)]),A("div",va,[S(I(c),{icon:I(O),class:"time-icon"},null,8,["icon"]),R(" "+$(oe.value),1)])])]),_:1})]),_:1}),A("div",ma,[A("button",{class:T(["filter-pill",{active:"all"===ie.value}]),onClick:w[0]||(w[0]=a=>ie.value="all")},[S(I(c),{icon:I(J)},null,8,["icon"]),w[9]||(w[9]=A("span",null,"Todas",-1)),A("span",fa,$(ca.value.length),1)],2),A("button",{class:T(["filter-pill available",{active:"available"===ie.value}]),onClick:w[1]||(w[1]=a=>ie.value="available")},[S(I(c),{icon:I(Y)},null,8,["icon"]),w[10]||(w[10]=A("span",null,"Disponíveis",-1)),A("span",ga,$(ue.value),1)],2),A("button",{class:T(["filter-pill occupied",{active:"occupied"===ie.value}]),onClick:w[2]||(w[2]=a=>ie.value="occupied")},[S(I(c),{icon:I(O)},null,8,["icon"]),w[11]||(w[11]=A("span",null,"Em Uso",-1)),A("span",ba,$(pe.value),1)],2),A("button",{class:T(["filter-pill maintenance",{active:"maintenance"===ie.value}]),onClick:w[3]||(w[3]=a=>ie.value="maintenance")},[S(I(c),{icon:I(F)},null,8,["icon"]),w[12]||(w[12]=A("span",null,"Manutenção",-1)),A("span",ha,$(ve.value),1)],2)]),A("div",xa,[A("div",{class:T(["stat-card available",{updating:I(he)}])},[S(I(c),{icon:I(Y)},null,8,["icon"]),A("div",ya,[A("span",wa,$(ue.value),1),w[13]||(w[13]=A("span",{class:"stat-label"},"Disponíveis",-1))])],2),A("div",{class:T(["stat-card occupied",{updating:I(he)}])},[S(I(c),{icon:I(O)},null,8,["icon"]),A("div",ka,[A("span",_a,$(pe.value),1),w[14]||(w[14]=A("span",{class:"stat-label"},"Em Uso",-1))])],2),A("div",{class:T(["stat-card maintenance",{updating:I(he)}])},[S(I(c),{icon:I(F)},null,8,["icon"]),A("div",Ca,[A("span",qa,$(ve.value),1),w[15]||(w[15]=A("span",{class:"stat-label"},"Manutenção",-1))])],2),A("div",{class:T(["stat-card inactive",{updating:I(he)}])},[S(I(c),{icon:I(K)},null,8,["icon"]),A("div",za,[A("span",Ea,$(me.value),1),w[16]||(w[16]=A("span",{class:"stat-label"},"Desativadas",-1))])],2)]),te.value?(j(),N("div",Ma,[S(I(f),{name:"crescent"}),w[17]||(w[17]=A("p",null,"Carregando máquinas...",-1))])):(j(),N("div",ja,[(j(!0),N(L,null,P(fe.value,a=>{return j(),N("div",{key:a.id,class:T(["machine-card-modern",we(a)]),onClick:e=>{return a.current_checklist&&(t=a.current_checklist.id,void C.push(`/checklist/${t}`));var t}},[A("div",Ia,[A("div",{class:T(["machine-icon-large",we(a)])},[S(I(c),{icon:I(J)},null,8,["icon"])],2),A("div",Sa,[A("h3",Ra,$(a.name),1),a.identifier?(j(),N("p",Aa,$(a.identifier),1)):V("",!0)]),A("div",Na,[A("div",{class:T(["status-dot",we(a)])},null,2),A("span",$a,$(ke(a)),1)])]),a.description?(j(),N("div",Ta,$(a.description),1)):V("",!0),a.current_checklist?(j(),N("div",Va,[A("div",La,[S(I(c),{icon:I(ta)},null,8,["icon"]),w[19]||(w[19]=A("span",null,"Sessão Ativa",-1)),a.current_checklist.is_paused?(j(),M(I(k),{key:0,color:"warning"},{default:D(()=>[...w[18]||(w[18]=[R("Pausado",-1)])]),_:1})):V("",!0)]),A("div",Pa,[A("div",Ua,[w[20]||(w[20]=A("span",{class:"detail-label"},"Paciente",-1)),A("span",Ba,$(a.current_checklist.patient_name),1)]),A("div",Ha,[w[21]||(w[21]=A("span",{class:"detail-label"},"Fase",-1)),A("span",Xa,$((t=a.current_checklist.current_phase,{pre_dialysis:"Pré-Diálise",during_session:"Durante Sessão",post_dialysis:"Pós-Diálise",completed:"Concluído",interrupted:"Interrompido"}[t]||t)),1)]),A("div",Ga,[w[22]||(w[22]=A("span",{class:"detail-label"},"Início",-1)),A("span",Oa,$(_e(a.current_checklist.started_at)),1)])]),A("div",Ja,[S(I(c),{icon:I(ia)},null,8,["icon"]),w[23]||(w[23]=A("span",null,"Clique para ver checklist",-1)),S(I(c),{icon:I(na)},null,8,["icon"])])])):V("",!0),a.current_checklist?V("",!0):(j(),N("div",{key:2,class:"machine-actions",onClick:w[4]||(w[4]=U(()=>{},["stop"]))},[S(I(s),{fill:"clear",size:"small",color:"medium",onClick:e=>(async a=>{le.value=!0,ce.value={id:a.id,name:a.name,identifier:a.identifier,description:a.description||"",unit_id:a.unit_id},re.value=!0})(a)},{default:D(()=>[S(I(c),{slot:"start",icon:I(oa)},null,8,["icon"]),w[24]||(w[24]=R(" Editar ",-1))]),_:1},8,["onClick"]),a.is_active&&"available"===a.status?(j(),M(I(s),{key:0,fill:"outline",size:"small",color:"warning",onClick:t=>(async a=>{const{alertController:t}=await _(async()=>{const{alertController:a}=await e.import("./ionic-legacy-CGcOrMzG.js").then(a=>a.a8);return{alertController:a}},void 0),i=await t.create({header:"Colocar em Manutenção",subHeader:a.name,message:"Descreva brevemente o motivo da manutenção:",inputs:[{name:"reason",type:"textarea",placeholder:"Ex: Troca de filtros, ajuste de pressão, etc."}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:e=>{Ce(a,e.reason||"")}}]});await i.present()})(a)},{default:D(()=>[S(I(c),{slot:"start",icon:I(F)},null,8,["icon"]),w[25]||(w[25]=R(" Manutenção ",-1))]),_:1},8,["onClick"])):V("",!0),a.is_active&&"maintenance"===a.status?(j(),M(I(s),{key:1,fill:"solid",size:"small",color:"success",onClick:t=>(async a=>{const{alertController:t}=await _(async()=>{const{alertController:a}=await e.import("./ionic-legacy-CGcOrMzG.js").then(a=>a.a8);return{alertController:a}},void 0),n=await t.create({header:"Liberar Máquina",subHeader:a.name,message:"Tem certeza que deseja liberar esta máquina? Ela ficará disponível para uso.",buttons:[{text:"Cancelar",role:"cancel"},{text:"Liberar",handler:async()=>{try{const e=await ra.updateStatus(a.id,{status:"available"}),t=ca.value.findIndex(e=>e.id===a.id);-1!==t&&(ca.value[t]={...ca.value[t],...e});const n=await i.create({message:`${a.name} liberada com sucesso`,duration:3e3,color:"success",position:"top"});await n.present()}catch(e){console.error("Error releasing machine:",e);const a=await i.create({message:e.response?.data?.message||"Erro ao liberar máquina",duration:4e3,color:"danger",position:"top"});await a.present()}}}]});await n.present()})(a)},{default:D(()=>[S(I(c),{slot:"start",icon:I(Y)},null,8,["icon"]),w[26]||(w[26]=R(" Liberar Máquina ",-1))]),_:1},8,["onClick"])):V("",!0),"occupied"!==a.status?(j(),M(I(s),{key:2,fill:"outline",size:"small",color:a.is_active?"danger":"success",onClick:t=>(async a=>{const{alertController:t}=await _(async()=>{const{alertController:a}=await e.import("./ionic-legacy-CGcOrMzG.js").then(a=>a.a8);return{alertController:a}},void 0),i=!a.is_active,n=await t.create({header:i?"Ativar Máquina":"Desativar Máquina",subHeader:a.name,message:i?"A máquina será ativada e ficará disponível para uso.":"Descreva brevemente o motivo da desativação:",inputs:i?[]:[{name:"reason",type:"textarea",placeholder:"Ex: Equipamento danificado, aguardando reparo, etc."}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:e=>{qe(a,e?.reason||"")}}]});await n.present()})(a)},{default:D(()=>[S(I(c),{slot:"start",icon:a.is_active?I(K):I(Y)},null,8,["icon"]),R(" "+$(a.is_active?"Desativar":"Ativar"),1)]),_:2},1032,["color","onClick"])):V("",!0)])),a.is_active?V("",!0):(j(),N("div",Ya,[S(I(c),{icon:I(K)},null,8,["icon"]),w[27]||(w[27]=A("span",null,"Desativada",-1))]))],10,Da);var t}),128)),0===fe.value.length?(j(),N("div",Fa,[A("div",Ka,[S(I(c),{icon:I(J)},null,8,["icon"])]),w[28]||(w[28]=A("h3",null,"Nenhuma máquina encontrada",-1)),A("p",null,$(ze()),1)])):V("",!0)]))]),S(I(g),{"is-open":re.value,onDidDismiss:je},{default:D(()=>[S(I(d),null,{default:D(()=>[S(I(n),null,{default:D(()=>[S(I(l),null,{default:D(()=>[R($(le.value?"Editar Máquina":"Nova Máquina"),1)]),_:1}),S(I(o),{slot:"end"},{default:D(()=>[S(I(s),{onClick:je},{default:D(()=>[...w[29]||(w[29]=[R("Cancelar",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),S(I(b),{class:"machine-modal-content"},{default:D(()=>[A("form",{onSubmit:U(De,["prevent"]),class:"machine-form"},[A("div",Wa,[w[33]||(w[33]=A("h3",{class:"section-title"},"Informações Básicas",-1)),A("div",Qa,[S(I(h),{position:"stacked",class:"form-label"},{default:D(()=>[S(I(c),{icon:I(J)},null,8,["icon"]),w[30]||(w[30]=R(" Nome da Máquina * ",-1))]),_:1}),S(I(x),{modelValue:ce.value.name,"onUpdate:modelValue":w[5]||(w[5]=a=>ce.value.name=a),type:"text",placeholder:"Ex: Máquina 01",required:"",disabled:se.value,class:"custom-input"},null,8,["modelValue","disabled"])]),A("div",Za,[S(I(h),{position:"stacked",class:"form-label"},{default:D(()=>[S(I(c),{icon:I(W)},null,8,["icon"]),w[31]||(w[31]=R(" Identificador/Código * ",-1))]),_:1}),S(I(x),{modelValue:ce.value.identifier,"onUpdate:modelValue":w[6]||(w[6]=a=>ce.value.identifier=a),type:"text",placeholder:"Ex: MAQ-001",required:"",disabled:se.value,class:"custom-input"},null,8,["modelValue","disabled"])]),A("div",ae,[S(I(h),{position:"stacked",class:"form-label"},{default:D(()=>[S(I(c),{icon:I(Q)},null,8,["icon"]),w[32]||(w[32]=R(" Descrição ",-1))]),_:1}),S(I(y),{modelValue:ce.value.description,"onUpdate:modelValue":w[7]||(w[7]=a=>ce.value.description=a),placeholder:"Informações adicionais sobre a máquina",rows:4,disabled:se.value,class:"custom-textarea"},null,8,["modelValue","disabled"])])]),A("div",ee,[S(I(s),{expand:"block",type:"submit",disabled:se.value||!Ee.value,class:"submit-button"},{default:D(()=>[S(I(c),{slot:"start",icon:se.value?I(Z):I(aa)},null,8,["icon"]),R(" "+$(se.value?"Salvando...":le.value?"Atualizar Máquina":"Criar Máquina"),1)]),_:1},8,["disabled"]),le.value?(j(),M(I(s),{key:0,expand:"block",fill:"outline",color:"danger",onClick:Ie,disabled:se.value,class:"delete-button"},{default:D(()=>[S(I(c),{slot:"start",icon:I(ea)},null,8,["icon"]),w[34]||(w[34]=R(" Excluir Máquina ",-1))]),_:1},8,["disabled"])):V("",!0)])],32)]),_:1})]),_:1},8,["is-open"])]),_:1})]),_:1}))}}),[["__scopeId","data-v-0394af6e"]]))}}});
