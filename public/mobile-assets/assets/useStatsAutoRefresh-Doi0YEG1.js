import{a as y}from"./main-BugRCitN.js";import{r,b as w,o as p}from"./vendor-BOCCj2ty.js";function D(g,S={}){const{loadOnMount:R=!0,interval:m=15e3,onStatsUpdated:i,debug:t=!1}=S,a=r(!1),o=r(null),n=r(0),s=async()=>{if(a.value){t&&console.log("[StatsAutoRefresh] Já está atualizando, ignorando...");return}try{a.value=!0,t&&console.log("[StatsAutoRefresh] Atualizando stats..."),await g(),o.value=new Date,n.value++,t&&console.log("[StatsAutoRefresh] Stats atualizados com sucesso",{time:o.value.toLocaleTimeString(),count:n.value}),i&&i()}catch(e){console.error("[StatsAutoRefresh] Erro ao atualizar stats:",e)}finally{a.value=!1}},{hasUpdates:l,latestData:v,checkNow:c,invalidateServerCache:f}=y({interval:m,onUpdate:e=>{var u,h,d;t&&console.log("[StatsAutoRefresh] Data sync detectou atualizações:",{safety_checklists:((u=e.safety_checklists)==null?void 0:u.length)||0,cleaning_controls:((h=e.cleaning_controls)==null?void 0:h.length)||0,chemical_disinfections:((d=e.chemical_disinfections)==null?void 0:d.length)||0}),s()}});w(l,e=>{e&&t&&console.log("[StatsAutoRefresh] Novas atualizações detectadas, recarregando stats...")});const A=async()=>{t&&console.log("[StatsAutoRefresh] Refresh forçado solicitado"),await f(),await c(),await s()};return p(async()=>{R&&(t&&console.log("[StatsAutoRefresh] Componente montado, carregando stats iniciais..."),await s())}),{isRefreshing:a,hasUpdates:l,latestData:v,lastRefreshTime:o,refreshCount:n,refreshStats:s,forceRefresh:A,checkNow:c,invalidateServerCache:f}}export{D as u};
