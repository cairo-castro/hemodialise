import{e as o,f as s,i as e,r as d,a as R,z as H,y as T,w as ee,j as S,J as m,H as te,p as u,F as z,E as F,B as E,x as re,q as n,A as q,G,l as ae}from"./vendor-BYzl544o.js";import{m as se}from"./vue3-apexcharts-DuPVan1R.js";import{_ as oe,r as P,a as O,b as Z,c as ne,d as V}from"./desktop-C1_hgPJA.js";import{r as ie}from"./BeakerIcon-B8PQRxuS.js";import{r as le}from"./SparklesIcon-BQL_fULu.js";function de(L,_){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function M(L,_={}){const{interval:C=3e4,immediate:A=!0,enabled:i=!0}=_,c=d(null),p=d(null),h=d(!1),v=d(!1);let g=null;const f=async()=>{if(!h.value){h.value=!0,p.value=null;try{const y=await L();c.value=y}catch(y){p.value=y,console.error("Polling error:",y)}finally{h.value=!1}}},l=()=>{v.value||!i||(v.value=!0,A&&f(),g=setInterval(()=>{f()},C))},x=()=>{g&&(clearInterval(g),g=null),v.value=!1},b=()=>{f()};R(()=>{i&&l()}),H(()=>{x()});const j=()=>{document.hidden?x():i&&l()};return R(()=>{document.addEventListener("visibilitychange",j)}),H(()=>{document.removeEventListener("visibilitychange",j)}),{data:c,error:p,loading:h,isPolling:v,startPolling:l,stopPolling:x,refresh:b}}const ce={class:"dashboard-view space-y-6"},ge={class:"flex items-center justify-between mb-4"},ue=["disabled"],pe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},xe={class:"flex items-start justify-between"},me={class:"flex-1"},he={class:"text-sm font-medium text-gray-600 dark:text-gray-400"},ve={class:"text-3xl font-bold text-gray-900 dark:text-white mt-2"},ye={class:"flex items-center mt-2"},fe={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},be={class:"w-12 h-12 bg-primary-100 dark:bg-primary-900/20 rounded-lg flex items-center justify-center mr-4 group-hover:bg-primary-200 dark:group-hover:bg-primary-900/30 transition-colors"},ke={class:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center mr-4 group-hover:bg-green-200 dark:group-hover:bg-green-900/30 transition-colors"},we={class:"w-12 h-12 bg-purple-100 dark:bg-purple-900/20 rounded-lg flex items-center justify-center mr-4 group-hover:bg-purple-200 dark:group-hover:bg-purple-900/30 transition-colors"},_e={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ce={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6"},Ae={key:0},je={key:1,class:"h-64 flex items-center justify-center"},Be={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6"},$e={class:"flex items-center justify-between mb-4"},Se={key:0,class:"space-y-2"},Ee=["onClick"],Pe={class:"flex-1 min-w-0"},Ve={class:"text-sm font-medium text-gray-900 dark:text-white"},Me={class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-1"},Le={class:"flex items-center mt-2 space-x-3"},Ne={class:"text-xs text-gray-400 dark:text-gray-500"},ze={key:1,class:"h-64 flex items-center justify-center"},Fe={key:2,class:"h-64 flex items-center justify-center"},Ie={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6 mt-6"},De={class:"flex items-center justify-between mb-4"},Re={class:"overflow-x-auto"},He={class:"w-full text-sm"},Te={class:"divide-y divide-gray-200 dark:divide-gray-700"},qe={class:"px-4 py-3 text-gray-900 dark:text-white font-medium"},Ge={class:"px-4 py-3 text-gray-600 dark:text-gray-400"},Oe={class:"px-4 py-3 text-gray-900 dark:text-white"},Ze={class:"px-4 py-3 text-gray-600 dark:text-gray-400"},Je={class:"px-4 py-3"},Ue={class:"px-4 py-3"},We={class:"px-4 py-3 text-right"},Ke=["onClick"],Qe={__name:"DashboardView",setup(L){const _=se,C=re(),A=d(!0),i=d([{label:"Checklists Hoje",value:"...",change:0,icon:P,bgColor:"bg-blue-500"},{label:"Máquinas Ativas",value:"...",change:0,icon:O,bgColor:"bg-green-500"},{label:"Pacientes",value:"...",change:0,icon:Z,bgColor:"bg-purple-500"},{label:"Conformidade",value:"...",change:0,icon:ne,bgColor:"bg-orange-500"}]),c=d(null),p=d([]),h=T(()=>c.value?c.value.datasets.map(a=>({name:a.label,data:a.data})):[]),v=T(()=>({chart:{type:"bar",stacked:!1,toolbar:{show:!1},animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{enabled:!0,delay:150},dynamicAnimation:{enabled:!0,speed:350}}},plotOptions:{bar:{horizontal:!1,columnWidth:"60%",borderRadius:4}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:c.value?.labels||[],labels:{style:{colors:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280",fontSize:"12px",fontFamily:"inherit"}}},yaxis:{title:{text:"Sessões",style:{color:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280",fontSize:"12px",fontFamily:"inherit"}},labels:{style:{colors:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280",fontSize:"12px",fontFamily:"inherit"}}},colors:["#3B82F6","#10B981","#A855F7"],legend:{position:"bottom",horizontalAlign:"center",labels:{colors:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280"},markers:{width:12,height:12,radius:2}},fill:{opacity:1},tooltip:{theme:document.documentElement.classList.contains("dark")?"dark":"light",y:{formatter:function(a){return a+" sessões"}}},grid:{borderColor:document.documentElement.classList.contains("dark")?"#374151":"#E5E7EB",strokeDashArray:3}})),g=d([]),f=M(W,{interval:2e4,immediate:!0}),l=M(y,{interval:1e4,immediate:!0}),x=M(J,{interval:3e4,immediate:!0}),b=M(U,{interval:15e3,immediate:!0});ee([l.data,x.data,b.data],()=>{l.data.value&&x.data.value&&b.data.value&&(A.value=!1)});const j=()=>{l.refresh(),x.refresh(),b.refresh(),f.refresh()};async function y(){const a=await V.get("/api/dashboard/stats");if(!a.ok)throw new Error(`Stats API error: ${a.status}`);const r=await a.json(),{data:t}=r;return i.value[0].value=t.checklists.value.toString(),i.value[0].change=t.checklists.change,i.value[1].value=`${t.machines.active}/${t.machines.total}`,i.value[1].change=t.machines.change,i.value[2].value=t.patients.value.toString(),i.value[2].change=t.patients.change,i.value[3].value=`${t.conformity.value}%`,i.value[3].change=t.conformity.change,t}async function J(){const a=await V.get("/api/dashboard/sessions-by-shift");if(!a.ok)throw new Error(`Sessions API error: ${a.status}`);const{data:r}=await a.json();return c.value=r,r}async function U(){const a=await V.get("/api/dashboard/recent-activity");if(!a.ok)throw new Error(`Activity API error: ${a.status}`);const{data:r}=await a.json();return p.value=r,r}async function W(){const a=await V.get("/api/checklists/recent?limit=5");if(!a.ok)throw new Error(`Table records API error: ${a.status}`);const{data:r}=await a.json();return g.value=(r||[]).map(t=>{const w=new Date(t.created_at),D=w.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),B=w.getHours();let N="Noturno";B>=6&&B<12?N="Matutino":B>=12&&B<18&&(N="Vespertino");let $="Pendente";return t.current_phase==="completed"?$="Concluído":t.current_phase==="interrupted"?$="Interrompido":t.current_phase&&($="Em Andamento"),{id:t.id,date:D,patient:t.patient?.full_name||"N/A",machine:t.machine?.name||t.machine?.identifier||"N/A",shift:N,status:$}}),g.value}function k(a){C.push(a)}function K(a){console.log("View record:",a),C.push(`/desktop/checklists/${a}`)}function Q(a){console.log("Activity clicked:",a)}function X(a){return{checklist:P,cleaning:le,disinfection:ie,warning:de}[a]||P}function I(a){return{Concluído:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",Interrompido:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400","Em Andamento":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",Pendente:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}[a]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}function Y(a){return{Matutino:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",Vespertino:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",Noturno:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400"}[a]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}return(a,r)=>(s(),o("div",ce,[e("div",ge,[r[7]||(r[7]=S('<div class="flex items-center space-x-2" data-v-7cf95ced><div class="relative" data-v-7cf95ced><div class="w-2 h-2 bg-green-500 rounded-full animate-pulse" data-v-7cf95ced></div><div class="absolute inset-0 w-2 h-2 bg-green-500 rounded-full animate-ping" data-v-7cf95ced></div></div><span class="text-sm font-medium text-gray-600 dark:text-gray-400" data-v-7cf95ced> Atualizações em tempo real ativas </span></div>',1)),e("button",{onClick:j,class:"px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",disabled:m(l).loading.value},[(s(),o("svg",{class:u(["w-4 h-4 inline-block mr-1",{"animate-spin":m(l).loading.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[5]||(r[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),r[6]||(r[6]=te(" Atualizar Agora ",-1))],8,ue)]),e("div",pe,[(s(!0),o(z,null,F(i.value,t=>(s(),o("div",{key:t.label,class:u(["metric-card bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6 hover:shadow-lg transition-all duration-200",{"ring-2 ring-blue-500 ring-opacity-50":m(l).loading.value}])},[e("div",xe,[e("div",me,[e("p",he,n(t.label),1),e("p",ve,n(t.value),1),e("div",ye,[e("span",{class:u(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",t.change>=0?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"])},n(t.change>=0?"+":"")+n(t.change)+"% ",3)])]),e("div",{class:u(["w-12 h-12 rounded-lg flex items-center justify-center",t.bgColor])},[(s(),q(G(t.icon),{class:"w-6 h-6 text-white"}))],2)])],2))),128))]),e("div",fe,[e("button",{onClick:r[0]||(r[0]=t=>k("/desktop/checklists")),class:"flex items-center p-4 bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 hover:border-primary-300 dark:hover:border-primary-700 hover:shadow-md transition-all group"},[e("div",be,[E(m(P),{class:"w-6 h-6 text-primary-600 dark:text-primary-400"})]),r[8]||(r[8]=S('<div class="flex-1 text-left" data-v-7cf95ced><p class="text-sm font-medium text-gray-900 dark:text-white" data-v-7cf95ced>Novo Checklist</p><p class="text-xs text-gray-500 dark:text-gray-400" data-v-7cf95ced>Criar checklist de segurança</p></div><svg class="w-5 h-5 text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-7cf95ced><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-7cf95ced></path></svg>',2))]),e("button",{onClick:r[1]||(r[1]=t=>k("/desktop/patients")),class:"flex items-center p-4 bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 hover:border-green-300 dark:hover:border-green-700 hover:shadow-md transition-all group"},[e("div",ke,[E(m(Z),{class:"w-6 h-6 text-green-600 dark:text-green-400"})]),r[9]||(r[9]=S('<div class="flex-1 text-left" data-v-7cf95ced><p class="text-sm font-medium text-gray-900 dark:text-white" data-v-7cf95ced>Novo Paciente</p><p class="text-xs text-gray-500 dark:text-gray-400" data-v-7cf95ced>Cadastrar novo paciente</p></div><svg class="w-5 h-5 text-gray-400 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-7cf95ced><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-7cf95ced></path></svg>',2))]),e("button",{onClick:r[2]||(r[2]=t=>k("/desktop/machines")),class:"flex items-center p-4 bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 hover:border-purple-300 dark:hover:border-purple-700 hover:shadow-md transition-all group"},[e("div",we,[E(m(O),{class:"w-6 h-6 text-purple-600 dark:text-purple-400"})]),r[10]||(r[10]=S('<div class="flex-1 text-left" data-v-7cf95ced><p class="text-sm font-medium text-gray-900 dark:text-white" data-v-7cf95ced>Ver Máquinas</p><p class="text-xs text-gray-500 dark:text-gray-400" data-v-7cf95ced>Gerenciar equipamentos</p></div><svg class="w-5 h-5 text-gray-400 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-7cf95ced><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-7cf95ced></path></svg>',2))])]),e("div",_e,[e("div",Ce,[r[12]||(r[12]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Sessões por Turno"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Últimos 7 dias")],-1)),c.value?(s(),o("div",Ae,[E(m(_),{type:"bar",height:"300",options:v.value,series:h.value},null,8,["options","series"])])):(s(),o("div",je,[...r[11]||(r[11]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"Carregando...",-1)])]))]),e("div",Be,[e("div",$e,[r[13]||(r[13]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Atividade Recente",-1)),e("button",{onClick:r[3]||(r[3]=t=>k("/desktop/checklists")),class:"text-xs font-medium text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors"}," Ver todas → ")]),p.value.length>0?(s(),o("div",Se,[(s(!0),o(z,null,F(p.value,(t,w)=>(s(),o("div",{key:w,class:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors cursor-pointer group",onClick:D=>Q(t)},[e("div",{class:u(["w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",t.bgColor])},[(s(),q(G(X(t.type)),{class:"w-5 h-5 text-white"}))],2),e("div",Pe,[e("p",Ve,n(t.title),1),e("p",Me,n(t.description),1),e("div",Le,[e("span",Ne,n(t.time),1),t.status?(s(),o("span",{key:0,class:u(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",I(t.status)])},n(t.status),3)):ae("",!0)])]),r[14]||(r[14]=e("svg",{class:"w-5 h-5 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,Ee))),128))])):A.value?(s(),o("div",ze,[...r[15]||(r[15]=[e("div",{class:"text-center"},[e("div",{class:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-3"}),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Carregando atividades...")],-1)])])):(s(),o("div",Fe,[...r[16]||(r[16]=[e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Nenhuma atividade recente")],-1)])]))])]),e("div",Ie,[e("div",De,[r[17]||(r[17]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Checklists Recentes"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Últimas verificações de segurança realizadas")],-1)),e("button",{onClick:r[4]||(r[4]=t=>k("/desktop/checklists")),class:"px-4 py-2 text-sm font-medium text-primary-600 dark:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/20 rounded-lg transition-colors"}," Ver todos ")]),e("div",Re,[e("table",He,[r[18]||(r[18]=e("thead",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase bg-gray-50 dark:bg-gray-800/50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left font-semibold"},"ID"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Data"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Paciente"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Máquina"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Turno"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Status"),e("th",{class:"px-4 py-3 text-right font-semibold"},"Ações")])],-1)),e("tbody",Te,[(s(!0),o(z,null,F(g.value,t=>(s(),o("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors"},[e("td",qe,"#"+n(t.id),1),e("td",Ge,n(t.date),1),e("td",Oe,n(t.patient),1),e("td",Ze,n(t.machine),1),e("td",Je,[e("span",{class:u(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",Y(t.shift)])},n(t.shift),3)]),e("td",Ue,[e("span",{class:u(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",I(t.status)])},n(t.status),3)]),e("td",We,[e("button",{onClick:w=>K(t.id),class:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium transition-colors"}," Ver detalhes ",8,Ke)])]))),128))])])])])]))}},at=oe(Qe,[["__scopeId","data-v-7cf95ced"]]);export{at as default};
