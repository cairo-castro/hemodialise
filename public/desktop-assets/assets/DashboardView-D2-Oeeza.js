import{r as d,a as G,z as W,y as O,w as ie,e as o,f as s,i as e,B as f,j as $,J as v,H as de,p as m,F as N,E as I,x as le,q as n,A as J,G as U,l as ce}from"./vendor-CiUp6LWl.js";import{m as ue}from"./vue3-apexcharts-I9Crkvqx.js";import{_ as ge,r as S,a as K,b as Q,c as pe,d as B}from"./desktop-D7czA7Q8.js";import{C as me}from"./ChecklistWizard-BPUvLOq4.js";import{P as xe,r as ve}from"./PatientFormModal-CK1Y4tzJ.js";import{r as he}from"./BeakerIcon-YntvKYXv.js";import{r as ye}from"./SparklesIcon-BRH_MWPO.js";import"./XMarkIcon-3s64TdeG.js";import"./CheckIcon-Cz9GaYQ_.js";import"./DocumentTextIcon-BS4TBxaJ.js";function E(L,V={}){const{interval:A=3e4,immediate:h=!0,enabled:c=!0}=V,k=d(null),i=d(null),l=d(!1),u=d(!1);let y=null;const w=async()=>{if(!l.value){l.value=!0,i.value=null;try{const p=await L();k.value=p}catch(p){i.value=p,console.error("Polling error:",p)}finally{l.value=!1}}},x=()=>{u.value||!c||(u.value=!0,h&&w(),y=setInterval(()=>{w()},A))},_=()=>{y&&(clearInterval(y),y=null),u.value=!1},g=()=>{w()};G(()=>{c&&x()}),W(()=>{_()});const b=()=>{document.hidden?_():c&&x()};return G(()=>{document.addEventListener("visibilitychange",b)}),W(()=>{document.removeEventListener("visibilitychange",b)}),{data:k,error:i,loading:l,isPolling:u,startPolling:x,stopPolling:_,refresh:g}}const be={class:"dashboard-view space-y-6"},fe={class:"flex items-center justify-between mb-4"},ke=["disabled"],we={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},_e={class:"flex items-start justify-between"},Ce={class:"flex-1"},Ae={class:"text-sm font-medium text-gray-600 dark:text-gray-400"},je={class:"text-3xl font-bold text-gray-900 dark:text-white mt-2"},Pe={class:"flex items-center mt-2"},$e={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Se={class:"w-12 h-12 bg-primary-100 dark:bg-primary-900/20 rounded-lg flex items-center justify-center mr-4 group-hover:bg-primary-200 dark:group-hover:bg-primary-900/30 transition-colors"},Be={class:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center mr-4 group-hover:bg-green-200 dark:group-hover:bg-green-900/30 transition-colors"},Ee={class:"w-12 h-12 bg-purple-100 dark:bg-purple-900/20 rounded-lg flex items-center justify-center mr-4 group-hover:bg-purple-200 dark:group-hover:bg-purple-900/30 transition-colors"},Ve={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Me={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6"},ze={key:0},Fe={key:1,class:"h-64 flex items-center justify-center"},Ne={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6"},Ie={class:"flex items-center justify-between mb-4"},Le={key:0,class:"space-y-2"},De=["onClick"],Re={class:"flex-1 min-w-0"},Te={class:"text-sm font-medium text-gray-900 dark:text-white"},He={class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-1"},qe={class:"flex items-center mt-2 space-x-3"},Ge={class:"text-xs text-gray-400 dark:text-gray-500"},We={key:1,class:"h-64 flex items-center justify-center"},Oe={key:2,class:"h-64 flex items-center justify-center"},Je={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6 mt-6"},Ue={class:"flex items-center justify-between mb-4"},Ke={class:"overflow-x-auto"},Qe={class:"w-full text-sm"},Xe={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ye={class:"px-4 py-3 text-gray-900 dark:text-white font-medium"},Ze={class:"px-4 py-3 text-gray-600 dark:text-gray-400"},et={class:"px-4 py-3 text-gray-900 dark:text-white"},tt={class:"px-4 py-3 text-gray-600 dark:text-gray-400"},rt={class:"px-4 py-3"},at={class:"px-4 py-3"},st={class:"px-4 py-3 text-right"},ot=["onClick"],nt={__name:"DashboardView",setup(L){const V=ue,A=le(),h=d(!1),c=d(!1),k=d(!0),i=d([{label:"Checklists Hoje",value:"...",change:0,icon:S,bgColor:"bg-blue-500"},{label:"Máquinas Ativas",value:"...",change:0,icon:K,bgColor:"bg-green-500"},{label:"Pacientes",value:"...",change:0,icon:Q,bgColor:"bg-purple-500"},{label:"Conformidade",value:"...",change:0,icon:pe,bgColor:"bg-orange-500"}]),l=d(null),u=d([]),y=O(()=>l.value?l.value.datasets.map(a=>({name:a.label,data:a.data})):[]),w=O(()=>{var a;return{chart:{type:"bar",stacked:!1,toolbar:{show:!1},animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{enabled:!0,delay:150},dynamicAnimation:{enabled:!0,speed:350}}},plotOptions:{bar:{horizontal:!1,columnWidth:"60%",borderRadius:4}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:((a=l.value)==null?void 0:a.labels)||[],labels:{style:{colors:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280",fontSize:"12px",fontFamily:"inherit"}}},yaxis:{title:{text:"Sessões",style:{color:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280",fontSize:"12px",fontFamily:"inherit"}},labels:{style:{colors:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280",fontSize:"12px",fontFamily:"inherit"}}},colors:["#3B82F6","#10B981","#A855F7"],legend:{position:"bottom",horizontalAlign:"center",labels:{colors:document.documentElement.classList.contains("dark")?"#9CA3AF":"#6B7280"},markers:{width:12,height:12,radius:2}},fill:{opacity:1},tooltip:{theme:document.documentElement.classList.contains("dark")?"dark":"light",y:{formatter:function(t){return t+" sessões"}}},grid:{borderColor:document.documentElement.classList.contains("dark")?"#374151":"#E5E7EB",strokeDashArray:3}}}),x=d([]),_=E(ee,{interval:2e4,immediate:!0}),g=E(X,{interval:1e4,immediate:!0}),b=E(Y,{interval:3e4,immediate:!0}),p=E(Z,{interval:15e3,immediate:!0});ie([g.data,b.data,p.data],()=>{g.data.value&&b.data.value&&p.data.value&&(k.value=!1)});const M=()=>{g.refresh(),b.refresh(),p.refresh(),_.refresh()};async function X(){const a=await B.get("/api/dashboard/stats");if(!a.ok)throw new Error(`Stats API error: ${a.status}`);const t=await a.json(),{data:r}=t;return i.value[0].value=r.checklists.value.toString(),i.value[0].change=r.checklists.change,i.value[1].value=`${r.machines.active}/${r.machines.total}`,i.value[1].change=r.machines.change,i.value[2].value=r.patients.value.toString(),i.value[2].change=r.patients.change,i.value[3].value=`${r.conformity.value}%`,i.value[3].change=r.conformity.change,r}async function Y(){const a=await B.get("/api/dashboard/sessions-by-shift");if(!a.ok)throw new Error(`Sessions API error: ${a.status}`);const{data:t}=await a.json();return l.value=t,t}async function Z(){const a=await B.get("/api/dashboard/recent-activity");if(!a.ok)throw new Error(`Activity API error: ${a.status}`);const{data:t}=await a.json();return u.value=t,t}async function ee(){const a=await B.get("/api/checklists/recent?limit=5");if(!a.ok)throw new Error(`Table records API error: ${a.status}`);const{data:t}=await a.json();return x.value=(t||[]).map(r=>{var T,H,q;const C=new Date(r.created_at),R=C.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),j=C.getHours();let F="Noturno";j>=6&&j<12?F="Matutino":j>=12&&j<18&&(F="Vespertino");let P="Pendente";return r.current_phase==="completed"?P="Concluído":r.current_phase==="interrupted"?P="Interrompido":r.current_phase&&(P="Em Andamento"),{id:r.id,date:R,patient:((T=r.patient)==null?void 0:T.full_name)||"N/A",machine:((H=r.machine)==null?void 0:H.name)||((q=r.machine)==null?void 0:q.identifier)||"N/A",shift:F,status:P}}),x.value}function z(a){A.push(a)}function te(a){console.log("View record:",a),A.push(`/desktop/checklists/${a}`)}function re(a){console.log("Activity clicked:",a)}function ae(a){return{checklist:S,cleaning:ye,disinfection:he,warning:ve}[a]||S}function D(a){return{Concluído:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",Interrompido:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400","Em Andamento":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",Pendente:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}[a]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}function se(a){return{Matutino:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",Vespertino:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",Noturno:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400"}[a]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}function oe(a){console.log("Checklist created:",a),h.value=!1,M()}function ne(a){console.log("Patient saved:",a),c.value=!1,M()}return(a,t)=>(s(),o("div",be,[e("div",fe,[t[9]||(t[9]=$('<div class="flex items-center space-x-2" data-v-d838c4dd><div class="relative" data-v-d838c4dd><div class="w-2 h-2 bg-green-500 rounded-full animate-pulse" data-v-d838c4dd></div><div class="absolute inset-0 w-2 h-2 bg-green-500 rounded-full animate-ping" data-v-d838c4dd></div></div><span class="text-sm font-medium text-gray-600 dark:text-gray-400" data-v-d838c4dd> Atualizações em tempo real ativas </span></div>',1)),e("button",{onClick:M,class:"px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",disabled:v(g).loading.value},[(s(),o("svg",{class:m(["w-4 h-4 inline-block mr-1",{"animate-spin":v(g).loading.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[7]||(t[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),t[8]||(t[8]=de(" Atualizar Agora ",-1))],8,ke)]),e("div",we,[(s(!0),o(N,null,I(i.value,r=>(s(),o("div",{key:r.label,class:m(["metric-card bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-6 hover:shadow-lg transition-all duration-200",{"ring-2 ring-blue-500 ring-opacity-50":v(g).loading.value}])},[e("div",_e,[e("div",Ce,[e("p",Ae,n(r.label),1),e("p",je,n(r.value),1),e("div",Pe,[e("span",{class:m(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",r.change>=0?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"])},n(r.change>=0?"+":"")+n(r.change)+"% ",3)])]),e("div",{class:m(["w-12 h-12 rounded-lg flex items-center justify-center",r.bgColor])},[(s(),J(U(r.icon),{class:"w-6 h-6 text-white"}))],2)])],2))),128))]),e("div",$e,[e("button",{onClick:t[0]||(t[0]=r=>h.value=!0),class:"flex items-center p-4 bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 hover:border-primary-300 dark:hover:border-primary-700 hover:shadow-md transition-all group"},[e("div",Se,[f(v(S),{class:"w-6 h-6 text-primary-600 dark:text-primary-400"})]),t[10]||(t[10]=$('<div class="flex-1 text-left" data-v-d838c4dd><p class="text-sm font-medium text-gray-900 dark:text-white" data-v-d838c4dd>Novo Checklist</p><p class="text-xs text-gray-500 dark:text-gray-400" data-v-d838c4dd>Criar checklist de segurança</p></div><svg class="w-5 h-5 text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-d838c4dd><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-d838c4dd></path></svg>',2))]),e("button",{onClick:t[1]||(t[1]=r=>c.value=!0),class:"flex items-center p-4 bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 hover:border-green-300 dark:hover:border-green-700 hover:shadow-md transition-all group"},[e("div",Be,[f(v(Q),{class:"w-6 h-6 text-green-600 dark:text-green-400"})]),t[11]||(t[11]=$('<div class="flex-1 text-left" data-v-d838c4dd><p class="text-sm font-medium text-gray-900 dark:text-white" data-v-d838c4dd>Novo Paciente</p><p class="text-xs text-gray-500 dark:text-gray-400" data-v-d838c4dd>Cadastrar novo paciente</p></div><svg class="w-5 h-5 text-gray-400 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-d838c4dd><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-d838c4dd></path></svg>',2))]),e("button",{onClick:t[2]||(t[2]=r=>z("/desktop/machines")),class:"flex items-center p-4 bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 hover:border-purple-300 dark:hover:border-purple-700 hover:shadow-md transition-all group"},[e("div",Ee,[f(v(K),{class:"w-6 h-6 text-purple-600 dark:text-purple-400"})]),t[12]||(t[12]=$('<div class="flex-1 text-left" data-v-d838c4dd><p class="text-sm font-medium text-gray-900 dark:text-white" data-v-d838c4dd>Ver Máquinas</p><p class="text-xs text-gray-500 dark:text-gray-400" data-v-d838c4dd>Gerenciar equipamentos</p></div><svg class="w-5 h-5 text-gray-400 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-d838c4dd><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-d838c4dd></path></svg>',2))])]),e("div",Ve,[e("div",Me,[t[14]||(t[14]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Sessões por Turno"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Últimos 7 dias")],-1)),l.value?(s(),o("div",ze,[f(v(V),{type:"bar",height:"300",options:w.value,series:y.value},null,8,["options","series"])])):(s(),o("div",Fe,[...t[13]||(t[13]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"Carregando...",-1)])]))]),e("div",Ne,[e("div",Ie,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Atividade Recente",-1)),e("button",{onClick:t[3]||(t[3]=r=>z("/desktop/checklists")),class:"text-xs font-medium text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors"}," Ver todas → ")]),u.value.length>0?(s(),o("div",Le,[(s(!0),o(N,null,I(u.value,(r,C)=>(s(),o("div",{key:C,class:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors cursor-pointer group",onClick:R=>re(r)},[e("div",{class:m(["w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",r.bgColor])},[(s(),J(U(ae(r.type)),{class:"w-5 h-5 text-white"}))],2),e("div",Re,[e("p",Te,n(r.title),1),e("p",He,n(r.description),1),e("div",qe,[e("span",Ge,n(r.time),1),r.status?(s(),o("span",{key:0,class:m(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",D(r.status)])},n(r.status),3)):ce("",!0)])]),t[16]||(t[16]=e("svg",{class:"w-5 h-5 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,De))),128))])):k.value?(s(),o("div",We,[...t[17]||(t[17]=[e("div",{class:"text-center"},[e("div",{class:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-3"}),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Carregando atividades...")],-1)])])):(s(),o("div",Oe,[...t[18]||(t[18]=[e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Nenhuma atividade recente")],-1)])]))])]),e("div",Je,[e("div",Ue,[t[19]||(t[19]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Checklists Recentes"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Últimas verificações de segurança realizadas")],-1)),e("button",{onClick:t[4]||(t[4]=r=>z("/desktop/checklists")),class:"px-4 py-2 text-sm font-medium text-primary-600 dark:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/20 rounded-lg transition-colors"}," Ver todos ")]),e("div",Ke,[e("table",Qe,[t[20]||(t[20]=e("thead",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase bg-gray-50 dark:bg-gray-800/50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left font-semibold"},"ID"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Data"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Paciente"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Máquina"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Turno"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Status"),e("th",{class:"px-4 py-3 text-right font-semibold"},"Ações")])],-1)),e("tbody",Xe,[(s(!0),o(N,null,I(x.value,r=>(s(),o("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors"},[e("td",Ye,"#"+n(r.id),1),e("td",Ze,n(r.date),1),e("td",et,n(r.patient),1),e("td",tt,n(r.machine),1),e("td",rt,[e("span",{class:m(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",se(r.shift)])},n(r.shift),3)]),e("td",at,[e("span",{class:m(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",D(r.status)])},n(r.status),3)]),e("td",st,[e("button",{onClick:C=>te(r.id),class:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium transition-colors"}," Ver detalhes ",8,ot)])]))),128))])])])]),f(me,{"is-open":h.value,onClose:t[5]||(t[5]=r=>h.value=!1),onChecklistCreated:oe},null,8,["is-open"]),f(xe,{"is-open":c.value,onClose:t[6]||(t[6]=r=>c.value=!1),onSaved:ne},null,8,["is-open"])]))}},ht=ge(nt,[["__scopeId","data-v-d838c4dd"]]);export{ht as default};
