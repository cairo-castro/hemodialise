import{r as l,y as D,a as ee,z as te,e as s,f as n,i as t,B as O,H as m,q as i,l as w,p as h,k as d,m as B,v as H,R as U,j as q,F as oe,E as re}from"./vendor-CiUp6LWl.js";import{P as ae}from"./PatientFormModal-DtmSNrnp.js";import{C as se}from"./ConfirmDeleteModal-N0vyC_FT.js";import{_ as ne,d as I}from"./desktop-IYA6hYSe.js";import"./XMarkIcon-3s64TdeG.js";import"./CheckIcon-Cz9GaYQ_.js";import"./BeakerIcon-YntvKYXv.js";import"./DocumentTextIcon-BS4TBxaJ.js";const le={class:"patients-view space-y-6"},ie={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},de={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-4"},ue={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},pe={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-4"},ge={class:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1"},ve={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-4"},ce={class:"text-2xl font-bold text-blue-600 dark:text-blue-400 mt-1"},xe={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 p-4"},me={class:"text-2xl font-bold text-orange-600 dark:text-orange-400 mt-1"},ye={class:"bg-white dark:bg-gray-950 rounded-xl border border-gray-200 dark:border-gray-800 overflow-hidden"},fe={key:0,class:"text-center py-12"},be={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},ke={class:"text-gray-500 dark:text-gray-400 mb-4"},we={key:1,class:"w-full"},he={class:"bg-gray-50 dark:bg-gray-800/50"},Ce={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},Me={class:"flex items-center gap-2"},_e={class:"relative"},Te={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},Be={class:"flex items-center gap-2"},Ae={class:"relative"},Ee={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},Ve={class:"flex items-center gap-2"},De={class:"relative"},Le={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},Pe={class:"flex items-center gap-2"},je={class:"relative"},ze={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},Fe={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ne={class:"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white"},Se={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400"},$e={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400"},Oe={class:"px-6 py-4"},He={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"},Ue={key:1,class:"text-sm text-gray-400 dark:text-gray-500"},qe={class:"px-6 py-4"},Ie={class:"px-6 py-4 text-right space-x-2"},Re=["onClick"],Ye=["onClick"],Ge={__name:"PatientsView",setup(Je){const C=l(!1),y=l(null),f=l(!1),b=l(null),M=l(null),p=l(""),g=l(""),v=l(""),c=l(""),u=l(null),k=l([]),L=l(!1);async function A(){L.value=!0;try{const o=await I.get("/api/patients?per_page=100&include_inactive=true");if(!o.ok)throw new Error("Erro ao carregar pacientes");const e=await o.json();e.success?k.value=e.patients||[]:(console.error("Erro ao carregar pacientes:",e.message),V(e.message||"Erro ao carregar pacientes"))}catch(o){console.error("Erro ao carregar pacientes:",o),V("Erro ao carregar pacientes. Verifique sua conexão.")}finally{L.value=!1}}const R=D(()=>k.value.length),P=D(()=>{let o=k.value;if(p.value){const e=p.value.toLowerCase();o=o.filter(a=>a.full_name.toLowerCase().includes(e))}return g.value&&(o=o.filter(e=>N(e.birth_date).toString().includes(g.value))),v.value&&(o=o.filter(e=>e.blood_type===v.value)),c.value&&(o=o.filter(e=>(e.status||"ativo")===c.value)),o}),_=D(()=>!!(p.value||g.value||v.value||c.value));function j(o){u.value=null}ee(()=>{document.addEventListener("click",j),A()}),te(()=>{document.removeEventListener("click",j)});function T(o){u.value===o?u.value=null:u.value=o}function z(){p.value="",g.value="",v.value="",c.value="",u.value=null}function F(o,e){return k.value.filter(a=>a.blood_group===o&&a.rh_factor===e).length}function Y(o){return{ativo:"Ativo",inativo:"Inativo",transferido:"Transferido",alta:"Alta Médica",obito:"Óbito"}[o]||o}function G(o){return{ativo:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",inativo:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",transferido:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",alta:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400",obito:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"}[o]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}function J(o){return o?new Date(o+"T00:00:00").toLocaleDateString("pt-BR"):"N/A"}function N(o){if(!o)return 0;const e=new Date(o+"T00:00:00"),a=new Date;let r=a.getFullYear()-e.getFullYear();const x=a.getMonth()-e.getMonth();return(x<0||x===0&&a.getDate()<e.getDate())&&r--,r}function S(){y.value=null,C.value=!0}function K(o){y.value=o,C.value=!0}function $(){C.value=!1,y.value=null}async function Q(o){y.value?E("Paciente atualizado com sucesso!"):E("Paciente cadastrado com sucesso!"),$(),await A()}function W(o){b.value=o,f.value=!0}async function X(){var o,e,a;if(!b.value){(o=M.value)==null||o.resetDeletingState(),f.value=!1;return}try{const r=await I.delete(`/api/patients/${b.value.id}`);if(!r.ok){const Z=await r.json();throw new Error(Z.message||"Erro ao excluir paciente")}const x=await r.json();if(!x.success)throw new Error(x.message||"Erro ao excluir paciente");(e=M.value)==null||e.resetDeletingState(),f.value=!1,E("Paciente excluído com sucesso!"),await A(),b.value=null}catch(r){console.error("Erro ao excluir paciente:",r),(a=M.value)==null||a.resetDeletingState(),V(r.message||"Erro ao excluir paciente. Tente novamente.")}}function E(o){const e=document.createElement("div");e.className="fixed top-4 right-4 z-[100] px-6 py-4 bg-green-600 text-white rounded-lg shadow-lg flex items-center gap-3 animate-slide-in-right",e.innerHTML=`
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
    </svg>
    <span class="font-medium">${o}</span>
  `,document.body.appendChild(e),setTimeout(()=>{e.style.animation="slide-out-right 0.3s ease-out forwards",setTimeout(()=>e.remove(),300)},3e3)}function V(o){const e=document.createElement("div");e.className="fixed top-4 right-4 z-[100] px-6 py-4 bg-red-600 text-white rounded-lg shadow-lg flex items-center gap-3 animate-slide-in-right",e.innerHTML=`
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
    </svg>
    <span class="font-medium">${o}</span>
  `,document.body.appendChild(e),setTimeout(()=>{e.style.animation="slide-out-right 0.3s ease-out forwards",setTimeout(()=>e.remove(),300)},3e3)}return(o,e)=>{var a;return n(),s("div",le,[t("div",{class:"flex items-center justify-between"},[e[18]||(e[18]=t("div",null,[t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Pacientes"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Gerenciamento de pacientes em tratamento")],-1)),t("button",{onClick:S,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium flex items-center"},[...e[17]||(e[17]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" Novo Paciente ",-1)])])]),t("div",ie,[t("div",de,[e[19]||(e[19]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Total de Pacientes",-1)),t("p",ue,i(k.value.length),1)]),t("div",pe,[e[20]||(e[20]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Em Tratamento",-1)),t("p",ge,i(R.value),1)]),t("div",ve,[e[21]||(e[21]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Tipo A+",-1)),t("p",ce,i(F("A","+")),1)]),t("div",xe,[e[22]||(e[22]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Tipo O+",-1)),t("p",me,i(F("O","+")),1)])]),t("div",ye,[P.value.length===0?(n(),s("div",fe,[e[24]||(e[24]=t("svg",{class:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),t("h3",be,i(_.value?"Nenhum paciente encontrado":"Nenhum paciente cadastrado"),1),t("p",ke,i(_.value?"Tente ajustar os filtros de busca":"Comece cadastrando o primeiro paciente"),1),_.value?(n(),s("button",{key:0,onClick:z,class:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium"},[...e[23]||(e[23]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),m(" Limpar Filtros ",-1)])])):(n(),s("button",{key:1,onClick:S,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium"}," Cadastrar Primeiro Paciente "))])):(n(),s("table",we,[t("thead",he,[t("tr",null,[t("th",Ce,[t("div",Me,[e[26]||(e[26]=m(" Nome Completo ",-1)),t("div",_e,[t("button",{onClick:e[0]||(e[0]=d(r=>T("name"),["stop"])),class:h(["p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",{"text-primary-600 dark:text-primary-400":p.value}])},[...e[25]||(e[25]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)])],2),u.value==="name"?(n(),s("div",{key:0,onClick:e[3]||(e[3]=d(()=>{},["stop"])),class:"absolute top-full left-0 mt-1 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg p-3 z-10 min-w-[200px]"},[B(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>p.value=r),type:"text",placeholder:"Filtrar nome...",class:"w-full px-2 py-1.5 text-sm bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 dark:text-white",onClick:e[2]||(e[2]=d(()=>{},["stop"]))},null,512),[[H,p.value]])])):w("",!0)])])]),e[36]||(e[36]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Data de Nascimento",-1)),t("th",Te,[t("div",Be,[e[28]||(e[28]=m(" Idade ",-1)),t("div",Ae,[t("button",{onClick:e[4]||(e[4]=d(r=>T("age"),["stop"])),class:h(["p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",{"text-primary-600 dark:text-primary-400":g.value}])},[...e[27]||(e[27]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)])],2),u.value==="age"?(n(),s("div",{key:0,onClick:e[7]||(e[7]=d(()=>{},["stop"])),class:"absolute top-full left-0 mt-1 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg p-3 z-10 min-w-[150px]"},[B(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>g.value=r),type:"text",placeholder:"Filtrar idade...",class:"w-full px-2 py-1.5 text-sm bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 dark:text-white",onClick:e[6]||(e[6]=d(()=>{},["stop"]))},null,512),[[H,g.value]])])):w("",!0)])])]),t("th",Ee,[t("div",Ve,[e[31]||(e[31]=m(" Tipo Sanguíneo ",-1)),t("div",De,[t("button",{onClick:e[8]||(e[8]=d(r=>T("bloodType"),["stop"])),class:h(["p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",{"text-primary-600 dark:text-primary-400":v.value}])},[...e[29]||(e[29]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)])],2),u.value==="bloodType"?(n(),s("div",{key:0,onClick:e[11]||(e[11]=d(()=>{},["stop"])),class:"absolute top-full left-0 mt-1 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg p-3 z-10 min-w-[150px]"},[B(t("select",{"onUpdate:modelValue":e[9]||(e[9]=r=>v.value=r),class:"w-full px-2 py-1.5 text-sm bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 dark:text-white",onClick:e[10]||(e[10]=d(()=>{},["stop"]))},[...e[30]||(e[30]=[q('<option value="" data-v-9fb3d250>Todos</option><option value="A+" data-v-9fb3d250>A+</option><option value="A-" data-v-9fb3d250>A-</option><option value="B+" data-v-9fb3d250>B+</option><option value="B-" data-v-9fb3d250>B-</option><option value="AB+" data-v-9fb3d250>AB+</option><option value="AB-" data-v-9fb3d250>AB-</option><option value="O+" data-v-9fb3d250>O+</option><option value="O-" data-v-9fb3d250>O-</option>',9)])],512),[[U,v.value]])])):w("",!0)])])]),t("th",Le,[t("div",Pe,[e[34]||(e[34]=m(" Status ",-1)),t("div",je,[t("button",{onClick:e[12]||(e[12]=d(r=>T("status"),["stop"])),class:h(["p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",{"text-primary-600 dark:text-primary-400":c.value}])},[...e[32]||(e[32]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)])],2),u.value==="status"?(n(),s("div",{key:0,onClick:e[15]||(e[15]=d(()=>{},["stop"])),class:"absolute top-full left-0 mt-1 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg p-3 z-10 min-w-[150px]"},[B(t("select",{"onUpdate:modelValue":e[13]||(e[13]=r=>c.value=r),class:"w-full px-2 py-1.5 text-sm bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 dark:text-white",onClick:e[14]||(e[14]=d(()=>{},["stop"]))},[...e[33]||(e[33]=[q('<option value="" data-v-9fb3d250>Todos</option><option value="ativo" data-v-9fb3d250>Ativo</option><option value="inativo" data-v-9fb3d250>Inativo</option><option value="transferido" data-v-9fb3d250>Transferido</option><option value="alta" data-v-9fb3d250>Alta Médica</option><option value="obito" data-v-9fb3d250>Óbito</option>',6)])],512),[[U,c.value]])])):w("",!0)])])]),t("th",ze,[_.value?(n(),s("button",{key:0,onClick:z,class:"inline-flex items-center gap-1 px-2 py-1 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Limpar todos os filtros"},[...e[35]||(e[35]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):w("",!0)])])]),t("tbody",Fe,[(n(!0),s(oe,null,re(P.value,r=>(n(),s("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800/50"},[t("td",Ne,i(r.full_name),1),t("td",Se,i(J(r.birth_date)),1),t("td",$e,i(N(r.birth_date))+" anos ",1),t("td",Oe,[r.blood_group&&r.rh_factor?(n(),s("span",He,i(r.blood_group)+i(r.rh_factor),1)):(n(),s("span",Ue,"N/A"))]),t("td",qe,[t("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",G(r.status||"ativo")])},i(Y(r.status||"ativo")),3)]),t("td",Ie,[t("button",{onClick:x=>K(r),class:"text-primary-600 dark:text-primary-400 hover:underline text-sm font-medium"}," Editar ",8,Re),t("button",{onClick:x=>W(r),class:"text-red-600 dark:text-red-400 hover:underline text-sm font-medium"}," Excluir ",8,Ye)])]))),128))])]))]),O(ae,{"is-open":C.value,patient:y.value,onClose:$,onSaved:Q},null,8,["is-open","patient"]),O(se,{"is-open":f.value,title:"Confirmar Exclusão do Paciente",message:"Tem certeza que deseja excluir este paciente? Todos os registros associados serão mantidos.","item-name":(a=b.value)==null?void 0:a.full_name,onClose:e[16]||(e[16]=r=>f.value=!1),onConfirm:X,ref_key:"deleteModalRef",ref:M},null,8,["is-open","item-name"])])}}},rt=ne(Ge,[["__scopeId","data-v-9fb3d250"]]);export{rt as default};
