import{d as F,r as u,o as H,z as x,n as _,v as o,x as e,A as j,t as s,B,l as m,D,q as t,E as i,F as G,G as J,H as R}from"./vendor-C2XN_qWx.js";import{e as K,n as Q,o as W,p as X,q as Y,k as Z,g as l,r as $,s as tt,u as et,v as C,w,m as st,x as nt,y as at}from"./ionic-BY6d-3MW.js";import{a as ot,p as it,c as lt,t as rt,h as ct,b as dt,d as L,e as ut,w as ht,_ as _t}from"./_plugin-vue_export-helper-DpvRZPJi.js";import{C as vt}from"./index-BMQczj65.js";const gt={key:0,class:"welcome-header"},ft={class:"user-info"},pt={class:"user-avatar"},mt={class:"stats-grid"},Ct={class:"stat-card"},wt={class:"stat-icon success"},yt={class:"stat-content"},kt={class:"stat-card"},It={class:"stat-icon warning"},bt={class:"stat-content"},Ot={class:"stat-card"},xt={class:"stat-icon primary"},Bt={class:"stat-content"},Dt={class:"quick-actions"},Rt={class:"action-content"},Lt={class:"action-icon"},Pt={class:"action-arrow"},St={class:"action-content"},Tt={class:"action-icon"},Ut={class:"action-arrow"},qt={key:1,class:"recent-section"},Et={class:"checklist-header"},Mt={class:"checklist-date"},Nt={class:"checklist-patient"},At={class:"status-bar"},Vt=F({__name:"DashboardPage",setup(zt){const h=j(),v=vt.getInstance(),P=v.getCurrentUserUseCase(),S=v.getLogoutUseCase(),f=v.get("ChecklistRepository"),T=v.getMachineRepository(),c=u(null),y=u([]),k=u([]),p=u([]),I=u([]),d=u(navigator.onLine),U=async()=>{try{c.value=await P.execute()}catch(a){console.error("Error loading user:",a),h.replace("/login")}},b=async()=>{const a=await Q.create({message:"Carregando dados...",spinner:"crescent"});await a.present();try{const[n,g,r]=await Promise.all([f.getTodaysChecklists(),f.getPendingChecklists(),T.getAvailable()]);y.value=n,k.value=g,I.value=r,c.value&&(p.value=await f.getByUser(c.value.id,5))}catch(n){console.error("Error loading dashboard data:",n)}finally{await a.dismiss()}},q=async a=>{try{await b()}finally{a.target.complete()}},E=async()=>{await(await nt.create({header:"Sair do Sistema",message:"Tem certeza que deseja sair?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Sair",role:"confirm",handler:async()=>{try{await S.execute(),h.replace("/login")}catch(n){console.error("Logout error:",n),h.replace("/login")}}}]})).present()},M=()=>{h.push("/checklist")},N=()=>{h.push("/patients")},A=a=>{switch(a){case"matutino":return"success";case"vespertino":return"warning";case"noturno":return"secondary";default:return"medium"}},V=a=>{switch(a){case"matutino":return"Manhã";case"vespertino":return"Tarde";case"noturno":return"Noite";default:return a}},z=a=>new Date(a).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),O=()=>{d.value=navigator.onLine};return H(async()=>{await U(),await b(),window.addEventListener("online",O),window.addEventListener("offline",O)}),(a,n)=>(_(),x(e(K),null,{default:o(()=>[s(e($),{translucent:!0},{default:o(()=>[s(e(W),null,{default:o(()=>[s(e(X),null,{default:o(()=>[...n[0]||(n[0]=[B("Dashboard",-1)])]),_:1}),s(e(Y),{slot:"end"},{default:o(()=>[s(e(Z),{onClick:E},{default:o(()=>[s(e(l),{icon:e(ot),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),s(e(st),{fullscreen:!0},{default:o(()=>{var g;return[s(e(tt),{slot:"fixed",onIonRefresh:q},{default:o(()=>[s(e(et))]),_:1}),c.value?(_(),m("div",gt,[t("div",ft,[t("h2",null,"Olá, "+i(c.value.name)+"!",1),t("p",null,i(((g=c.value.unit)==null?void 0:g.name)||"Sem unidade definida"),1)]),t("div",pt,[s(e(l),{icon:e(it)},null,8,["icon"])])])):D("",!0),t("div",mt,[t("div",Ct,[t("div",wt,[s(e(l),{icon:e(lt)},null,8,["icon"])]),t("div",yt,[t("h3",null,i(y.value.length),1),n[1]||(n[1]=t("p",null,"Checklists Hoje",-1))])]),t("div",kt,[t("div",It,[s(e(l),{icon:e(rt)},null,8,["icon"])]),t("div",bt,[t("h3",null,i(k.value.length),1),n[2]||(n[2]=t("p",null,"Pendentes",-1))])]),t("div",Ot,[t("div",xt,[s(e(l),{icon:e(ct)},null,8,["icon"])]),t("div",Bt,[t("h3",null,i(I.value.length),1),n[3]||(n[3]=t("p",null,"Máquinas Ativas",-1))])])]),t("div",Dt,[n[6]||(n[6]=t("h3",null,"Ações Rápidas",-1)),s(e(C),{class:"action-card",button:"",onClick:M},{default:o(()=>[s(e(w),null,{default:o(()=>[t("div",Rt,[t("div",Lt,[s(e(l),{icon:e(dt)},null,8,["icon"])]),n[4]||(n[4]=t("div",{class:"action-text"},[t("h4",null,"Novo Checklist"),t("p",null,"Iniciar verificação de segurança")],-1)),t("div",Pt,[s(e(l),{icon:e(L)},null,8,["icon"])])])]),_:1})]),_:1}),s(e(C),{class:"action-card",button:"",onClick:N},{default:o(()=>[s(e(w),null,{default:o(()=>[t("div",St,[t("div",Tt,[s(e(l),{icon:e(ut)},null,8,["icon"])]),n[5]||(n[5]=t("div",{class:"action-text"},[t("h4",null,"Pacientes"),t("p",null,"Buscar e gerenciar pacientes")],-1)),t("div",Ut,[s(e(l),{icon:e(L)},null,8,["icon"])])])]),_:1})]),_:1})]),p.value.length>0?(_(),m("div",qt,[n[7]||(n[7]=t("h3",null,"Últimos Checklists",-1)),(_(!0),m(G,null,J(p.value,r=>(_(),x(e(C),{key:r.id,class:"checklist-card"},{default:o(()=>[s(e(w),null,{default:o(()=>[t("div",Et,[t("h4",null,"Máquina "+i(r.machine_id),1),s(e(at),{color:A(r.shift)},{default:o(()=>[B(i(V(r.shift)),1)]),_:2},1032,["color"])]),t("p",Mt,i(z(r.created_at)),1),t("p",Nt,"Paciente ID: "+i(r.patient_id),1)]),_:2},1024)]),_:2},1024))),128))])):D("",!0),t("div",At,[s(e(l),{icon:e(ht),class:R({"status-online":d.value,"status-offline":!d.value})},null,8,["icon","class"]),t("span",{class:R({"status-online":d.value,"status-offline":!d.value})},i(d.value?"Online":"Offline"),3)])]}),_:1})]),_:1}))}}),Jt=_t(Vt,[["__scopeId","data-v-10b87563"]]);export{Jt as default};
