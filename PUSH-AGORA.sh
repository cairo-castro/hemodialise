#!/bin/bash

echo "=========================================="
echo "üö® PUSH URGENTE NECESS√ÅRIO"
echo "=========================================="
echo ""
echo "Voc√™ tem 3 commits que N√ÉO est√£o no GitHub:"
echo ""
git log origin/main..HEAD --oneline
echo ""
echo "=========================================="
echo "O Dokploy est√° usando c√≥digo ANTIGO!"
echo "Por isso est√° tentando copiar .env.docker"
echo "=========================================="
echo ""
echo "SOLU√á√ÉO:"
echo ""
echo "1Ô∏è‚É£  PUSH PARA GITHUB:"
echo "   git push origin main"
echo ""
echo "   Se pedir senha/usu√°rio:"
echo "   - Usu√°rio: seu-usuario-github"
echo "   - Senha: seu-personal-access-token"
echo ""
echo "2Ô∏è‚É£  REDEPLOY NO DOKPLOY:"
echo "   http://212.85.1.175:3000"
echo "   - Ir no servi√ßo qualidadehd"
echo "   - Clicar em Redeploy"
echo ""
echo "=========================================="
echo "IMPORTANTE: SEM O PUSH, NADA FUNCIONA!"
echo "=========================================="
echo ""

read -p "Pressione ENTER para tentar fazer o push agora..."

git push origin main

if [ $? -eq 0 ]; then
    echo ""
    echo "‚úÖ PUSH CONCLU√çDO COM SUCESSO!"
    echo ""
    echo "Pr√≥ximo passo:"
    echo "1. Acesse: http://212.85.1.175:3000"
    echo "2. Configure as vari√°veis de ambiente (veja SETUP-FINAL.md)"
    echo "3. Fa√ßa o REDEPLOY"
else
    echo ""
    echo "‚ùå PUSH FALHOU!"
    echo ""
    echo "Voc√™ precisa configurar autentica√ß√£o:"
    echo ""
    echo "Op√ß√£o A - Personal Access Token (Recomendado):"
    echo "  1. Acesse: https://github.com/settings/tokens"
    echo "  2. Gere um novo token com permiss√£o 'repo'"
    echo "  3. Execute:"
    echo "     git push https://SEU_TOKEN@github.com/cairo-castro/hemodialise.git main"
    echo ""
    echo "Op√ß√£o B - SSH:"
    echo "  1. Configure chave SSH no GitHub"
    echo "  2. Execute:"
    echo "     git remote set-url origin git@github.com:cairo-castro/hemodialise.git"
    echo "     git push origin main"
fi
